import{a as De}from"./chunk-6RXJAO3W.js";import{a as Re,c as ve,e as Le,f as Fe,g as ze}from"./chunk-NE2FJIGN.js";import{a as d}from"./chunk-B2HAIUJV.js";import{e as be,g as Me,h as Ie,k as Oe}from"./chunk-DHOS3PR4.js";import{a as oe,b as ie,e as re,g as ne}from"./chunk-LR6GUTIR.js";import{a as _e,b as ue,e as Se,f as fe,g as Te,h as Ee,p as Ae,q as ge}from"./chunk-XHVW2357.js";import{c as ye,d as he}from"./chunk-RNDCCMR3.js";import{b as B,g as ce}from"./chunk-Y5OMJY5V.js";import{a as pe,b as de}from"./chunk-ALHR4HEP.js";import{c as Ce}from"./chunk-TG74CNA3.js";import{a as ae,b as se,h as le,i as me}from"./chunk-E4SPABR5.js";import{b as G,d as N,e as j,f as M,g as k,k as X,l as W,m as K,p as U,q as J,t as I}from"./chunk-LVJI6PBQ.js";import{aa as Q,da as Z,ha as ee,ia as te}from"./chunk-5MDONEI4.js";import{Cb as T,Eb as v,Fb as L,Gb as F,Hb as l,Ib as a,Jb as _,Nb as z,O as $,Tb as D,Vb as S,Xb as u,a as P,b as x,ea as V,fc as A,gc as y,hc as q,ib as n,ic as Y,jb as p,jc as g,mb as H,mc as b,pa as w,qa as h,qb as C,tb as E,va as O,wa as R,xb as m}from"./chunk-OHUDUA2T.js";function xe(o,r){if(o&1){let s=z();l(0,"mat-chip-row",7),S("removed",function(){let t=O(s).$implicit,c=u(2);return R(c.removeSelection(t));}),y(1),l(2,"button",8)(3,"mat-icon"),y(4,"cancel"),a()()();}if(o&2){let s=r.$implicit,e=u(2);n(),Y(" ",e.getSelectionFormat(s)," ");}}function $e(o,r){if(o&1){let s=z();l(0,"mat-chip-grid",null,4),L(2,xe,5,1,"mat-chip-row",null,v),a(),l(4,"input",5,6),S("matChipInputTokenEnd",function(){O(s);let i=u();return R(i.addSelection());}),a();}if(o&2){let s=A(1),e=u(),i=A(7);n(2),F(e.selections),n(2),m("matAutocomplete",i)("formControl",e.control)("matChipInputFor",s)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes);}}function Ve(o,r){if(o&1&&_(0,"input",9,6),o&2){let s=u(),e=A(7);m("matAutocomplete",e)("formControl",s.control);}}function we(o,r){if(o&1&&(l(0,"mat-option",10),y(1),a()),o&2){let s=r.$implicit,e=u();m("value",e.getOptionValue(s)),n(),Y(" ",e.getOptionContent(s)," ");}}function He(o,r){o&1&&(l(0,"mat-error"),D(1,11),a());}function qe(o,r){o&1&&(l(0,"mat-error"),D(1,12),a());}function Ge(o,r){o&1&&_(0,"mat-progress-bar",3);}var Ye=(()=>{let r=class r extends Ee{get laboratoryId(){return this._laboratoryId;}set laboratoryId(e){e!==this._laboratoryId&&(this._laboratoryId=e,this.reset());}constructor(e,i){super(e),this.ngControl=e,this.mlatService=i,this.query=null,this.label=Ce.testType,this._laboratoryId="",this.filters=V([]),this.szOptionContentFn=t=>t.testType.name,this.szOptionValueFn=t=>t,this.szOptionFormatFn=t=>t?t.testType.name:"",H(()=>this.refresh(),{allowSignalWrites:!0});}ngOnInit(){this.control=this.ngControl.control,this.listenChanges();}ngOnDestroy(){this.subscriptions.unsubscribe();}listenChanges(){this.subscriptions.add(this.control.valueChanges.pipe(he(400)).subscribe(e=>{e!==null&&this.handleValueChanged(e);}));}handleValueChanged(e){if(this.reset(),typeof e=="string")this.query=e;else if(typeof e=="object"&&e)return;this.fetch();}reset(){this.query=null,this.totalPages=-1,this.options=[];}fetch(){this.mlatService.laboratories.testTypes.get(this._laboratoryId,x(P({query:this.query},ce.minimal()),{orderBy:["-isFavorite","testType.name"],filters:this.filters()})).pipe(ye(this.indicator),$(1)).subscribe(e=>{this.options.push(...e.items),this.totalPages=e.totalPages,this.afterSourceUpdated();});}};r.ɵfac=function(i){return new(i||r)(p(j,10),p(d));},r.ɵcmp=h({type:r,selectors:[["sz-medisy-laboratory-laboratory-test-type-search"]],inputs:{query:"query",laboratoryId:"laboratoryId",filters:[w.SignalBased,"filters"]},standalone:!0,features:[g([d]),C,b],decls:13,vars:7,consts:()=>{let e;e="\u0647\u0630\u0627 \u0627\u0644\u062D\u0642\u0644 \u0645\u0637\u0644\u0648\u0628";let i;return i="\u0647\u0630\u0627 \u0627\u0644\u062D\u0642\u0644 \u063A\u064A\u0631 \u0635\u062D\u064A\u062D",[[1,"container"],[3,"displayWith","szScrollIgnored","optionSelected","szScrolled"],["auto","matAutocomplete"],["mode","indeterminate"],["chipGrid",""],["matInput","",3,"matAutocomplete","formControl","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["input",""],[3,"removed"],["matChipRemove",""],["matInput","",3,"matAutocomplete","formControl"],[3,"value"],e,i];},template:function(i,t){i&1&&(l(0,"div",0)(1,"mat-form-field")(2,"mat-label"),y(3),a(),E(4,$e,6,4)(5,Ve,2,2),l(6,"mat-autocomplete",1,2),S("optionSelected",function(f){return t.optionSelected(f);})("szScrolled",function(){return t.scroll();}),L(8,we,2,2,"mat-option",10,v),a(),E(10,He,2,0,"mat-error")(11,qe,2,0,"mat-error"),a(),E(12,Ge,1,0,"mat-progress-bar",3),a()),i&2&&(n(3),q(t.label),n(),T(4,t.multiple?4:5),n(2),m("displayWith",t.szOptionFormatFn)("szScrollIgnored",t.indicator()),n(2),F(t.options),n(2),T(10,t.control.hasError("required")?10:-1),n(),T(11,t.control.hasError("invalid")?11:-1),n(),T(12,t.indicator()?12:-1));},dependencies:[I,G,M,W,me,le,ae,se,Te,Se,Q,fe,de,pe,ue,_e,Z,ze,Le,Fe,Re,ve,te,ee,Ae],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]{position:relative}mat-progress-bar[_ngcontent-%COMP%]{position:absolute;bottom:20px}"]});let o=r;return o;})();var Nt=(()=>{let r=class r extends be{constructor(e,i,t,c){super(i),this.fb=e,this.dialog=i,this.mlabService=t,this.data=c,this.laboratories=this.mlabService.laboratories.getAll({orderBy:["name"]}),this.laboratoryOptionValueFn=f=>f,this.testTypesFilters=[],this.laboratoryId=this.data,this.laboratorySelected(c),this.form=e.group({laboratory:[this.laboratoryId,[N.required]],testType:e.control(null,[N.required,De()])});}laboratorySelected(e){this.data===e?this.testTypesFilters=[{field:"locallyEnabled",op:B.Equal,value:this.data===e}]:this.testTypesFilters=[{field:"forwardEnabled",op:B.Equal,value:this.data!==e}],this.laboratoryId=e;}submit(){this.IsValid()&&this.dialog.close({laboratoryTestType:this.form.value.testType});}};r.ɵfac=function(i){return new(i||r)(p(J),p(oe),p(d),p(ie));},r.ɵcmp=h({type:r,selectors:[["sz-medisy-laboratory-analysis-test-type-add"]],standalone:!0,features:[g([d]),C,b],decls:6,vars:6,consts:()=>{let e;return e="\u0627\u0644\u0645\u062E\u0628\u0631",[[3,"header"],[1,"sz-form",3,"formGroup"],["formControlName","laboratory","label",e,3,"source","szOptionSelected"],["formControlName","testType",3,"laboratoryId","filters"],[3,"actions"]];},template:function(i,t){i&1&&(_(0,"sz-ui-dialog-header",0),l(1,"mat-dialog-content")(2,"form",1)(3,"sz-ui-form-field-select",2),S("szOptionSelected",function(f){return t.laboratorySelected(f);}),a(),_(4,"sz-medisy-laboratory-laboratory-test-type-search",3),a()(),_(5,"sz-ui-dialog-actions",4)),i&2&&(m("header",t.header),n(2),m("formGroup",t.form),n(),m("source",t.laboratories),n(),m("laboratoryId",t.laboratoryId)("filters",t.testTypesFilters),n(),m("actions",t.actions));},dependencies:[I,X,M,k,K,U,ne,re,Oe,Me,Ie,Ye,ge],encapsulation:2});let o=r;return o;})();export{Nt as a};/**i18n:0f14478d9f76834c336477492adead1f84c567d512dc7742568a2120e6a13b69*/