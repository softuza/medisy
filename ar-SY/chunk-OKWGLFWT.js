import{a as De}from"./chunk-RZK5BQ6B.js";import{a as Oe,c as Re,e as ve,f as Le,g as ze}from"./chunk-OASRBHML.js";import{a as d}from"./chunk-JQJBUEG5.js";import{e as ge,g as be,h as Me,k as Ie}from"./chunk-HXMV2OLW.js";import{a as te,b as oe,e as ie,g as re}from"./chunk-YWX36TB2.js";import{a as de,b as _e,e as ue,f as fe,g as Se,h as Ce,p as Ee,q as Ae}from"./chunk-VPIJS6YO.js";import{c as Te,d as ye}from"./chunk-AIREYCF6.js";import{g as ce}from"./chunk-TLW5FHGJ.js";import{a as me,b as pe}from"./chunk-T6BCLI2C.js";import{c as he}from"./chunk-EK4ER5ZO.js";import{a as ne,b as ae,h as se,i as le}from"./chunk-UO2UFEHS.js";import{b as w,d as G,e as q,f as M,g as j,k,l as X,m as W,p as K,q as U,t as I}from"./chunk-YALI5IZX.js";import{aa as J,da as Q,ha as Z,ia as ee}from"./chunk-GAHCHFY3.js";import{Cb as _,Eb as v,Fb as L,Gb as z,Hb as l,Ib as s,Jb as u,Nb as D,O as P,Tb as F,Vb as T,Xb as p,a as N,b as B,ea as x,fc as A,gc as h,hc as H,ib as n,ic as Y,jb as c,jc as g,mb as V,mc as b,pa as $,qa as C,qb as E,tb as S,va as O,wa as R,xb as m}from"./chunk-SOOFBSF3.js";function Pe(o,i){if(o&1){let a=D();l(0,"mat-chip-row",7),T("removed",function(){let t=O(a).$implicit,f=p(2);return R(f.removeSelection(t));}),h(1),l(2,"button",8)(3,"mat-icon"),h(4,"cancel"),s()()();}if(o&2){let a=i.$implicit,e=p(2);n(),Y(" ",e.getSelectionFormat(a)," ");}}function xe(o,i){if(o&1){let a=D();l(0,"mat-chip-grid",null,4),L(2,Pe,5,1,"mat-chip-row",null,v),s(),l(4,"input",5,6),T("matChipInputTokenEnd",function(){O(a);let r=p();return R(r.addSelection());}),s();}if(o&2){let a=A(1),e=p(),r=A(7);n(2),z(e.selections),n(2),m("matAutocomplete",r)("formControl",e.control)("matChipInputFor",a)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes);}}function $e(o,i){if(o&1&&u(0,"input",9,6),o&2){let a=p(),e=A(7);m("matAutocomplete",e)("formControl",a.control);}}function Ve(o,i){if(o&1&&(l(0,"mat-option",10),h(1),s()),o&2){let a=i.$implicit,e=p();m("value",e.getOptionValue(a)),n(),Y(" ",e.getOptionContent(a)," ");}}function He(o,i){o&1&&(l(0,"mat-error"),F(1,11),s());}function we(o,i){o&1&&(l(0,"mat-error"),F(1,12),s());}function Ge(o,i){o&1&&u(0,"mat-progress-bar",3);}var Fe=(()=>{let i=class i extends Ce{get laboratoryId(){return this._laboratoryId;}set laboratoryId(e){e!==this._laboratoryId&&(this._laboratoryId=e,this.reset());}constructor(e,r){super(e),this.ngControl=e,this.mlatService=r,this.query=null,this.label=he.testType,this._laboratoryId="",this.filters=x([]),this.szOptionContentFn=t=>t.testType.name,this.szOptionValueFn=t=>t,this.szOptionFormatFn=t=>t?t.testType.name:"",V(()=>this.refresh(),{allowSignalWrites:!0});}ngOnInit(){this.control=this.ngControl.control,this.listenChanges();}ngOnDestroy(){this.subscriptions.unsubscribe();}listenChanges(){this.subscriptions.add(this.control.valueChanges.pipe(ye(400)).subscribe(e=>{e!==null&&this.handleValueChanged(e);}));}handleValueChanged(e){if(this.reset(),typeof e=="string")this.query=e;else if(typeof e=="object"&&e)return;this.fetch();}reset(){this.query=null,this.totalPages=-1,this.options=[];}fetch(){this.mlatService.laboratories.testTypes.get(this._laboratoryId,B(N({query:this.query},ce.minimal()),{orderBy:["-isFavorite","testType.name"],filters:this.filters()})).pipe(Te(this.indicator),P(1)).subscribe(e=>{this.options.push(...e.items),this.totalPages=e.totalPages,this.afterSourceUpdated();});}};i.ɵfac=function(r){return new(r||i)(c(q,10),c(d));},i.ɵcmp=C({type:i,selectors:[["sz-medisy-laboratory-laboratory-test-type-search"]],inputs:{query:"query",laboratoryId:"laboratoryId",filters:[$.SignalBased,"filters"]},standalone:!0,features:[g([d]),E,b],decls:13,vars:7,consts:()=>{let e;e="\u0647\u0630\u0627 \u0627\u0644\u062D\u0642\u0644 \u0645\u0637\u0644\u0648\u0628";let r;return r="\u0647\u0630\u0627 \u0627\u0644\u062D\u0642\u0644 \u063A\u064A\u0631 \u0635\u062D\u064A\u062D",[[1,"container"],[3,"displayWith","szScrollIgnored","optionSelected","szScrolled"],["auto","matAutocomplete"],["mode","indeterminate"],["chipGrid",""],["matInput","",3,"matAutocomplete","formControl","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["input",""],[3,"removed"],["matChipRemove",""],["matInput","",3,"matAutocomplete","formControl"],[3,"value"],e,r];},template:function(r,t){r&1&&(l(0,"div",0)(1,"mat-form-field")(2,"mat-label"),h(3),s(),S(4,xe,6,4)(5,$e,2,2),l(6,"mat-autocomplete",1,2),T("optionSelected",function(y){return t.optionSelected(y);})("szScrolled",function(){return t.scroll();}),L(8,Ve,2,2,"mat-option",10,v),s(),S(10,He,2,0,"mat-error")(11,we,2,0,"mat-error"),s(),S(12,Ge,1,0,"mat-progress-bar",3),s()),r&2&&(n(3),H(t.label),n(),_(4,t.multiple?4:5),n(2),m("displayWith",t.szOptionFormatFn)("szScrollIgnored",t.indicator()),n(2),z(t.options),n(2),_(10,t.control.hasError("required")?10:-1),n(),_(11,t.control.hasError("invalid")?11:-1),n(),_(12,t.indicator()?12:-1));},dependencies:[I,w,M,X,le,se,ne,ae,Se,ue,J,fe,pe,me,_e,de,Q,ze,ve,Le,Oe,Re,ee,Z,Ee],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]{position:relative}mat-progress-bar[_ngcontent-%COMP%]{position:absolute;bottom:20px}"]});let o=i;return o;})();function qe(o,i){if(o&1&&u(0,"sz-ui-form-field-select",3),o&2){let a=p();m("source",a.laboratories);}}var Yt=(()=>{let i=class i extends ge{constructor(e,r,t,f){super(r),this.fb=e,this.dialog=r,this.mlabService=t,this.data=f,this.laboratories=this.mlabService.laboratories.getAll({orderBy:["name"]}),this.laboratoryOptionValueFn=y=>y,this.testTypesFilters=[],this.laboratoryId=this.data,this.form=e.group({laboratory:[this.laboratoryId,[]],testType:e.control(null,[G.required,De()])});}isTranferOutEnabled(){return this.form.value?.testType?.transferOutEnabled;}isTranferOutLaboratoryDisabled(){return this.form.value?.testType?.transferOutLaboratoryId;}testTypeSelected(e){console.log(e);}submit(){this.IsValid()&&this.dialog.close({laboratoryTestType:this.form.value.testType});}};i.ɵfac=function(r){return new(r||i)(c(U),c(te),c(d),c(oe));},i.ɵcmp=C({type:i,selectors:[["sz-medisy-laboratory-analysis-test-type-add"]],standalone:!0,features:[g([d]),E,b],decls:6,vars:6,consts:()=>{let e;return e="\u0627\u0644\u0645\u062E\u0628\u0631 \u0627\u0644\u0645\u062D\u0648\u0644 \u0644\u0647",[[3,"header"],[1,"sz-form",3,"formGroup"],["formControlName","testType",3,"laboratoryId","filters","szOptionSelected"],["formControlName","laboratory","label",e,3,"source"],[3,"actions"]];},template:function(r,t){r&1&&(u(0,"sz-ui-dialog-header",0),l(1,"mat-dialog-content")(2,"form",1)(3,"sz-medisy-laboratory-laboratory-test-type-search",2),T("szOptionSelected",function(y){return t.testTypeSelected(y);}),s(),S(4,qe,1,1,"sz-ui-form-field-select",3),s()(),u(5,"sz-ui-dialog-actions",4)),r&2&&(m("header",t.header),n(2),m("formGroup",t.form),n(),m("laboratoryId",t.laboratoryId)("filters",t.testTypesFilters),n(),_(4,t.isTranferOutEnabled()?4:-1),n(),m("actions",t.actions));},dependencies:[I,k,M,j,W,K,re,ie,Ie,be,Me,Fe,Ae],encapsulation:2});let o=i;return o;})();export{Yt as a};/**i18n:3c79f61dd4ae219236c62485f036b897dde9f999c4ae619f8589958cf23779e7*/