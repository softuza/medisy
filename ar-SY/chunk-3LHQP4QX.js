import{a as Q}from"./chunk-NSHCKHQH.js";import"./chunk-SID2K4ZA.js";import"./chunk-43SWRE3T.js";import{b as f}from"./chunk-5UXET42V.js";import"./chunk-MXNM5XST.js";import{a as c}from"./chunk-KD4SN5HI.js";import{a as o,d as x,e as E,i as G,j as O}from"./chunk-SNCSCLKF.js";import"./chunk-YGU4JTYS.js";import"./chunk-ER72QF5P.js";import{b as g,c as m,d as w,g as $}from"./chunk-ZYFBUFWT.js";import"./chunk-2A5GXBDS.js";import"./chunk-FNEDC6UP.js";import{e as S,h as u}from"./chunk-OMC3RSVM.js";import"./chunk-L65U5OHB.js";import"./chunk-SWHTRLHM.js";import{d as j,g as F}from"./chunk-AEJUXZCG.js";import"./chunk-LANNBXGX.js";import{b as l}from"./chunk-HBAIFRLQ.js";import{b as _}from"./chunk-264QKOH6.js";import"./chunk-W4ZBAGNE.js";import"./chunk-AAHDAXVC.js";import"./chunk-5ZGE7EDH.js";import"./chunk-VXNH5PTX.js";import{Y as s,Z as k}from"./chunk-XPJ4P4RZ.js";import{c as R,e as N}from"./chunk-DNH4OZS2.js";import"./chunk-ELRLVGRO.js";import{ia as T,la as V}from"./chunk-4B53IFHW.js";import{n as I}from"./chunk-UZ765RGE.js";import{Kb as M,Lb as B,Mb as P,Xb as D,bb as h,cb as p,ea as v,na as C,oa as z,ob as y,oc as A,zb as d}from"./chunk-G33TNFCW.js";import"./chunk-EAIILSS5.js";var q=(()=>{let i=class i{constructor(e,t,r,b){this.dialog=e,this.mpplService=t,this.personNamePipe=r,this.router=b,this.dataSource=new x("-createdAt"),this.alert=y(void 0),this.appBarConfig={title:s.patients,actions:[S.add(this.openPersonCreateComponent.bind(this)),S.search(()=>{})]},this.dataSource.columnDefs.push(o.uuid("id"),o.string("title.abbreviation").setVisible(!1),o.string("title.name").setVisible(!1).setName(s.title),o.hyperlink("names",n=>`/mppl/persons/${n.id}`).setValueGetter(n=>r.transform(n)).setName(s.name).setStacked(o.string("sex").setValueGetter(n=>k(n.sex))),o.date("birthDate"),o.string("ssn").setName(s.ssn).setResponsive(!0),o.date("createdAt").setVisible(!1),o.date("updatedAt").setVisible(!1)),this.get()}openPersonCreateComponent(){this.dialog.open(Q).afterClosed().subscribe(e=>{e&&this.router.navigate([`/mppl/persons/${e.id}`])})}openBarcodeScanner(){this.dialog.open($,{data:{formats:[g.QR_CODE,g.PDF_417]}}).afterClosed().subscribe(e=>{e&&this.parseBarcodeResult(e)})}parseBarcodeResult(e){let t=w.decode(e);if(!t){this.alert.set(_.error(s.barcode_not_supported,5e3));return}switch(t.type){case m.SyrianMsId:case m.SyrianId:{let r=this.dataSource.filtration?.find("ssn");r?r.value=t.value.ssn:this.dataSource.filtration?.equal("ssn",t.value.ssn),this.get();break}case m.PersonId:this.router.navigate([`/mppl/persons/${t.value}`]);break;case m.AnalysisId:this.router.navigate([`/mlab/analyses/${t.value}`]);break}}get(){this.mpplService.persons.get(this.dataSource.getQuery()).pipe(E(this.dataSource.state)).subscribe(e=>{this.dataSource.set(e.items,e.count)})}};i.\u0275fac=function(t){return new(t||i)(p(j),p(c),p(f),p(R))},i.\u0275cmp=C({type:i,selectors:[["sz-medisy-people-persons"]],features:[A([I,f])],decls:3,vars:3,consts:[[3,"config"],[3,"alert"],[3,"update","dataSource"]],template:function(t,r){t&1&&(P(0,"sz-ui-app-bar",0)(1,"sz-ui-alert",1),M(2,"sz-ui-table",2),D("update",function(){return r.get()}),B()),t&2&&(d("config",r.appBarConfig),h(),d("alert",r.alert()),h(),d("dataSource",r.dataSource))},dependencies:[G,u,l],encapsulation:2});let a=i;return a})();var ye=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=z({type:i}),i.\u0275inj=v({providers:[c],imports:[N.forChild([{path:"",component:q}]),F,V,O,u,T,l]});let a=i;return a})();export{ye as PersonsModule};
/**i18n:23b18f90dfad26ae6b830c3e760ecc323aedcfc43eb78549f6a00c2171dce7c8*/
