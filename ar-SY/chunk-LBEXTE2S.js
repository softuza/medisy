import{a as l}from"./chunk-GFRVKPAG.js";import{e as pe}from"./chunk-Z6CFIFUG.js";import{a as d,d as ne,e as le,f as se,i as me,j as O}from"./chunk-7FOO2BSN.js";import"./chunk-YGU4JTYS.js";import"./chunk-ALLHSD3Q.js";import"./chunk-LZIUZOQU.js";import{b as ee,f as te,g as ie,h as ae,j as oe,k as re}from"./chunk-BQ3MI4NW.js";import{b as N,e as Z}from"./chunk-JPFRJQ7V.js";import{g as v}from"./chunk-E6NASU4P.js";import{a as q,b as x,d as E,e as H,g as S}from"./chunk-WNUUIGGE.js";import{c as J,p as K,q as C,r as W,t as Y}from"./chunk-7CXFXQJU.js";import"./chunk-IP3Z2NCN.js";import"./chunk-264QKOH6.js";import"./chunk-W4ZBAGNE.js";import"./chunk-AAHDAXVC.js";import"./chunk-JACASQJP.js";import{d as I,f as B,g as y,l as F,n as G,q as $,r as j,u as w}from"./chunk-VXNH5PTX.js";import{Y as Q,r as U,t as X}from"./chunk-KQ5MQZXD.js";import{a as h,e as T}from"./chunk-DNH4OZS2.js";import"./chunk-ELRLVGRO.js";import{ia as k,la as _}from"./chunk-4B53IFHW.js";import"./chunk-UZ765RGE.js";import{Kb as s,Lb as m,Mb as p,Wb as L,Xb as A,bb as c,cb as b,ea as R,ja as r,na as u,oa as D,oc as g,pc as f,qb as P,zb as n}from"./chunk-G33TNFCW.js";import"./chunk-EAIILSS5.js";var de=(()=>{let e=class e extends te{constructor(a,t,i){super(t),this.fb=a,this.dialog=t,this.data=i,this.srptService=r(l),this.baseTemplateVariables=this.srptService.baseTemplates.variables.getAll(this.data.baseTemplateId,{orderBy:["name"],filterBehavior:U.Or,filters:X.create().equalIf("id",this.data.templateVariable?.baseTemplateVariableId).notAny("templates.templateId",this.data.templateId).filters()}),this.form=a.group({enabled:[i.templateVariable?.enabled??!0,[I.required]],description:[i.templateVariable?.description,[]],baseTemplateVariableId:[i.templateVariable?.baseTemplateVariableId,[I.required]],value:[i.templateVariable?.value,[]]});}submit(){this.IsValid()&&(this.data.templateVariable?this.save(this.srptService.templates.variables.update(this.data.templateId,this.data.templateVariable?.id,this.form.value)):this.save(this.srptService.templates.variables.create(this.data.templateId,this.form.value)));}};e.ɵfac=function(t){return new(t||e)(b(j),b(q),b(x));},e.ɵcmp=u({type:e,selectors:[["sz-mgmt-reporting-template-variables-save"]],standalone:!0,features:[g([l]),P,f],decls:9,vars:6,consts:()=>{let a;a="\u0627\u0644\u0645\u062A\u063A\u064A\u0631";let t;t="\u0642\u064A\u0645\u0629";let i;return i="\u0645\u0641\u0639\u0644",[i,[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","baseTemplateVariableId","label",a,3,"source"],["formControlName","value","label",t],[1,"sz-form-row"],["formControlName","enabled"],[3,"actions"]];},template:function(t,i){t&1&&(p(0,"sz-ui-dialog-header",1),s(1,"mat-dialog-content")(2,"form",2),p(3,"sz-ui-form-field-select",3)(4,"sz-ui-form-field-input",4),s(5,"div",5)(6,"mat-checkbox",6),L(7,0),m()()()(),p(8,"sz-ui-dialog-actions",7)),t&2&&(n("title",i.title)("subtitle",i.subtitle)("alert",i.alert()),c(2),n("formGroup",i.form),c(),n("source",i.baseTemplateVariables),c(5),n("actions",i.actions));},dependencies:[w,F,B,y,G,$,re,ie,ae,S,H,C,K,pe,Y,J,W],encapsulation:2});let o=e;return o;})();var ue=(()=>{let e=class e{constructor(){this.dialog=r(E),this.srptService=r(l),this.route=r(h),this.dataSource=new ne("baseTemplateVariable.name"),this.template=this.route.snapshot.data.template,this.appBarConfig={title:Q.variables,subtitle:this.template.name,actions:[N.add(this.openSaveComponent.bind(this)),N.menu([N.search()])]},this.dataSource.columnDefs.push(d.uuid("id"),d.string("baseTemplateVariable.name"),d.string("value"),d.date("createdAt").setVisible(!1),d.date("updatedAt").setVisible(!1),d.menu([v.edit(this.openSaveComponent.bind(this)),v.divider(),v.delete(this.openTemplateVariableDeleteComponent.bind(this))])),this.get();}openSaveComponent(a){this.dialog.open(de,{data:{templateId:this.template.id,baseTemplateId:this.template.baseTemplateId,templateVariable:a}}).afterClosed().subscribe(t=>{this.dataSource.addOrUpdateItem(t);});}openTemplateVariableDeleteComponent(a){this.dialog.open(oe,{data:ee.delete(this.srptService.templates.variables.delete(a.templateId,a.id),a)}).afterClosed().subscribe(t=>{this.dataSource.delete(t);});}get(){this.srptService.templates.variables.get(this.template.id,this.dataSource.getQuery()).pipe(le(this.dataSource.state)).subscribe(a=>{this.dataSource.set(a.items,a.count);});}};e.ɵfac=function(t){return new(t||e)();},e.ɵcmp=u({type:e,selectors:[["sz-mgmt-reporting-template-variables"]],standalone:!0,features:[f],decls:2,vars:3,consts:[[3,"changed","config","dataSource"],[3,"update","dataSource"]],template:function(t,i){t&1&&(s(0,"sz-ui-table-bar",0),A("changed",function(){return i.get();}),m(),s(1,"sz-ui-table",1),A("update",function(){return i.get();}),m()),t&2&&(n("config",i.appBarConfig)("dataSource",i.dataSource),c(),n("dataSource",i.dataSource));},dependencies:[T,O,me,se,C,_],encapsulation:2});let o=e;return o;})();var z=(()=>{let e=class e{constructor(){this.route=r(h),this.dialog=r(E),this.srptService=r(l),this.template=this.route.snapshot.data.template,this.appBarConfig={title:this.template.name,subtitle:this.template.description};}};e.ɵfac=function(t){return new(t||e)();},e.ɵcmp=u({type:e,selectors:[["sz-mgmt-reporting-template"]],standalone:!0,features:[g([]),f],decls:3,vars:1,consts:[[3,"config"],[1,"tw-my-4"]],template:function(t,i){t&1&&(p(0,"sz-ui-app-bar",0),s(1,"div",1),p(2,"sz-mgmt-reporting-template-variables"),m()),t&2&&n("config",i.appBarConfig);},dependencies:[S,_,O,Z,k,ue],encapsulation:2});let o=e;return o;})();var ct=(()=>{let e=class e{};e.ɵfac=function(t){return new(t||e)();},e.ɵmod=D({type:e}),e.ɵinj=R({providers:[l],imports:[T.forChild([{path:"",component:z}]),S,_,z]});let o=e;return o;})();export{ct as TemplatesModule};/**i18n:23b18f90dfad26ae6b830c3e760ecc323aedcfc43eb78549f6a00c2171dce7c8*/