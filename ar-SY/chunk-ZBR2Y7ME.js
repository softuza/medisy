import{c as ae}from"./chunk-DEF6I2JA.js";import{a as se}from"./chunk-GXBARVDJ.js";import{a as M}from"./chunk-BMJ3S5XZ.js";import"./chunk-JSCEI2V4.js";import{h as le}from"./chunk-2SZNFHCN.js";import"./chunk-GPAES7OP.js";import"./chunk-DSJR6L5G.js";import"./chunk-XDEHVO3T.js";import{d as re,e as L}from"./chunk-2BMNYJ3Z.js";import{f as ee,g as te,h as ie,k as oe}from"./chunk-AKE4IGL4.js";import"./chunk-ODYGSBAJ.js";import{b as H}from"./chunk-QERRRZIA.js";import{a as w,b as Q,d as q,e as U,g as c}from"./chunk-MHLQ5ASK.js";import{c as Y,u as W}from"./chunk-UPM3BUO4.js";import"./chunk-ZDS23LK5.js";import"./chunk-WX4XW32G.js";import{i as k}from"./chunk-Q4QLTUTU.js";import{d as h,f as A,g as P,l as b,n as $,q as G,r as X,t as B}from"./chunk-R425IBES.js";import{b as R,c as Z}from"./chunk-6YJUGZYY.js";import{a as ne}from"./chunk-KPHZXQ4R.js";import{c as J,d as K}from"./chunk-53QS6UIR.js";import"./chunk-TM26YT7E.js";import{a as j}from"./chunk-KDY7YLUU.js";import"./chunk-FZND2MZR.js";import{p as V}from"./chunk-CVZW7JYW.js";import"./chunk-GBJNACNX.js";import"./chunk-IJWI4VMJ.js";import{Ia as y,La as C}from"./chunk-OKKKBEFN.js";import{Fb as I,Hb as O,Ib as D,Jb as S,Kb as v,Lb as m,Yb as x,ac as E,bb as d,bc as g,cc as T,ja as a,mb as F,mc as f,na as p,nc as u,yb as s,zb as z}from"./chunk-K7VHIDZW.js";import"./chunk-VARUJZUG.js";var ce=["root"],me=(()=>{let n=class n{constructor(){this.element=null;}ngAfterViewInit(){this.render();}render(){console.log("render",this.field),this.field.type==="text"?this.addFieldText(this.field):this.field.type==="barcode"?this.addFieldBarcode(this.field):this.field.type==="table"?this.addFieldTable(this.field):this.field.type==="line"?this.addFieldLine(this.field):this.field.type==="image"&&this.addFieldImage(this.field);}getContainerElement(){return this.container.nativeElement;}addFieldText(t){let e=t;if(!e)return;let o=this.getContainerElement(),i=document.createElement("p");i.innerText=e.text,i.style.position="absolute",i.style.left=`${this.getRelativeSize(e.x)}px`,i.style.top=`${this.getRelativeSize(e.y)}px`,o.appendChild(i),this.addMouseEvents(i);}addFieldBarcode(t){let e=t;if(!e)return;let o=typeof e.value=="string"&&e.value?e.value:"1234567890",i=this.getContainerElement(),r=null;if(e.barcodeType==="qr"&&(r=L.qr(e.value)),e.barcodeType==="datamatrix"&&(r=L.datamatrix(e.value,!1)),!r)return;let _=re.toSVG(r,e.options);_&&i.appendChild(_);}addFieldTable(t){if(!t)return;let o=this.getContainerElement();}addFieldLine(t){let e=t;if(!e)return;let o=this.getContainerElement(),i=document.createElement("div");i.style.position="absolute",i.style.left=`${this.getRelativeSize(e.x)}px`,i.style.top=`${this.getRelativeSize(e.y)}px`,i.style.width=`${this.getRelativeSize(e.x2-e.x)}px`,i.style.height=`${this.getRelativeSize(e.y2-e.y)}px`,i.style.borderBottom=`${e.lineWidth??1}px solid ${e.lineColor??"black"}`,o.appendChild(i),this.addMouseEvents(i);}addFieldImage(t){let e=t;if(!e)return;let o=this.getContainerElement(),i=document.createElement("img");i.src=e.url,i.alt="",i.style.position="absolute",i.style.left=`${this.getRelativeSize(e.x)}px`,i.style.top=`${this.getRelativeSize(e.y)}px`,i.style.width=`${this.getRelativeSize(e.width)}px`,i.style.height=`${this.getRelativeSize(e.height)}px`,o.appendChild(i),this.addMouseEvents(i);}addMouseEvents(t){t.addEventListener("mousedown",r=>{r.button===0&&(t.style.cursor="move",document.addEventListener("mousemove",o),document.addEventListener("mouseup",i));}),t.addEventListener("mouseup",r=>{r.preventDefault();});let e=this.getContainerElement(),o=r=>{let _=r.clientX-e.getBoundingClientRect().left-t.offsetWidth/2,N=r.clientY-e.getBoundingClientRect().top-t.offsetHeight/2;t.style.left=`${_}px`,t.style.top=`${N}px`,this.field.x=_/this.scale,this.field.y=N/this.scale;},i=()=>{t.style.cursor="auto",document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",i);};}onRightClick(t){t.preventDefault(),this.matMenuTrigger.openMenu();}getRelativeSize(t){return t*this.scale;}};n.ɵfac=function(e){return new(e||n)();},n.ɵcmp=p({type:n,selectors:[["sz-mgmt-reporting-template-field"]],viewQuery:function(e,o){if(e&1&&(E(ce,5),E(J,7)),e&2){let i;g(i=T())&&(o.container=i.first),g(i=T())&&(o.matMenuTrigger=i.first);}},inputs:{field:"field",scale:"scale"},standalone:!0,features:[f([M]),u],decls:2,vars:0,consts:[["root",""]],template:function(e,o){e&1&&m(0,"div",null,0);},dependencies:[c,C,K,y],encapsulation:2});let l=n;return l;})();var pe=(()=>{let n=class n extends ee{constructor(){let t=a(w);super(t),this.fb=a(X),this.data=a(Q);let e=this.fb;this.dialog=t;let o=this.data;this.form=e.group({x:[o?.x??0,[h.required]],y:[o?.y??0,[h.required]],text:[o?.text??"",[h.required]],fontSize:[o?.fontSize??12,[h.required]]});}submit(){this.IsValid()&&this.dialog.close(this.form.value);}};n.ɵfac=function(e){return new(e||n)();},n.ɵcmp=p({type:n,selectors:[["sz-mgmt-reporting-template-text-field"]],standalone:!0,features:[f([]),F,u],decls:8,vars:8,consts:()=>{let t;t="X";let e;e="Y";let o;o="Font Size";let i;return i="Text",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","x","label",t,3,"type"],["formControlName","y","label",e,3,"type"],["formControlName","fontSize","label",o,3,"type"],["formControlName","text","label",i],[3,"actions"]];},template:function(e,o){e&1&&(m(0,"sz-ui-dialog-header",0),S(1,"mat-dialog-content")(2,"form",1),m(3,"sz-ui-form-field-input",2)(4,"sz-ui-form-field-input",3)(5,"sz-ui-form-field-input",4)(6,"sz-ui-form-field-input",5),v()(),m(7,"sz-ui-dialog-actions",6)),e&2&&(s("title",o.title)("subtitle",o.subtitle)("alert",o.alert()),d(2),s("formGroup",o.form),d(),s("type","number"),d(),s("type","number"),d(),s("type","number"),d(2),s("actions",o.actions));},dependencies:[B,b,A,P,$,G,c,U,k,ae,oe,te,ie,W,Y],encapsulation:2});let l=n;return l;})();var _e=["designer"];function Ee(l,n){if(l&1&&m(0,"sz-mgmt-reporting-template-field",4),l&2){let ue=n.$implicit,t=x();s("field",ue)("scale",t.scale);}}var fe=(()=>{let n=class n{constructor(){this.route=a(V),this.dialog=a(q),this.srptService=a(M),this.snackBar=a(H),this.template=this.route.snapshot.data.template,this.fields=[],this.size={width:210,height:297},this.scale=3,this.appBarConfig={title:this.template.name,subtitle:this.template.description,menu:Z.default().setItems([R.menu([R.divider(),R.text(this.openSaveTextFieldComponent.bind(this))])])};}ngAfterViewInit(){this.refresh(this.template.content);}refresh(t){try{let e=se.fromString(t);this.fields=e.fields??[];}catch(e){this.snackBar.open(e,j.close,{duration:5e3});}}getRelativeSize(t){return t*this.scale;}openSaveTextFieldComponent(){this.dialog.open(pe).afterClosed().subscribe(t=>{t&&this.fields.push(t);});}};n.ɵfac=function(e){return new(e||n)();},n.ɵcmp=p({type:n,selectors:[["sz-mgmt-reporting-template"]],viewQuery:function(e,o){if(e&1&&E(_e,5),e&2){let i;g(i=T())&&(o.designerEl=i.first);}},standalone:!0,features:[f([M]),u],decls:6,vars:5,consts:[["designer",""],[3,"config"],[1,"container"],[1,"designer"],[3,"field","scale"]],template:function(e,o){e&1&&(m(0,"sz-ui-app-bar",1),S(1,"div",2)(2,"div",3,0),O(4,Ee,1,2,"sz-mgmt-reporting-template-field",4,I),v()()),e&2&&(s("config",o.appBarConfig),d(2),z("width",o.getRelativeSize(o.size.width),"px")("height",o.getRelativeSize(o.size.height),"px"),d(2),D(o.fields));},dependencies:[c,C,le,ne,y,me],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}.designer[_ngcontent-%COMP%]{border:1px solid #c3c3c3;padding:10px;margin:10px;background-color:#f5f5f5;position:relative}"]});let l=n;return l;})();var ot=[{path:"",component:fe}];export{ot as default};/**i18n:7274145596894140ce8dc809ecf6b222e8bea6098fe1553d5bf6245265c46bf4*/