"use strict";(self.webpackChunkmedisy=self.webpackChunkmedisy||[]).push([[246],{8246:(L,f,e)=>{e.r(f),e.d(f,{AnalysesModule:()=>et});var m=e(6814),g=e(2296),a=e(7700),A=e(617),E=e(7988),d=e(8109),p=e(6883),y=e(758),l=e(9899),S=e(5041),_=e(3572),O=e(8262),C=e(9598),N=e(8721),R=e(8180),c=e(6223),P=e(8034),h=e(9157),J=e(7106),x=e(7195),Y=e(6028),t=e(5879),I=e(4630),M=e(2557),F=e(3680),z=e(2032),v=e(5026),D=e(9060),$=e(2393),B=e(5781),G=e(6089);const H=["input"];function X(r,T){if(1&r){const o=t.EpF();t.TgZ(0,"mat-chip-row",10),t.NdJ("removed",function(){const i=t.CHM(o).$implicit,u=t.oxw();return t.KtG(u.remove(i))}),t._uU(1),t.ALo(2,"personName"),t.TgZ(3,"button",11)(4,"mat-icon"),t._uU(5,"cancel"),t.qZA()()()}if(2&r){const o=T.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,o)," ")}}function Q(r,T){if(1&r&&(t.TgZ(0,"mat-option",12)(1,"div",13)(2,"span"),t._uU(3),t.ALo(4,"personName"),t.qZA(),t.TgZ(5,"small"),t._uU(6),t.ALo(7,"personAge"),t.qZA()()()),2&r){const o=T.$implicit;t.Q6J("value",o),t.xp6(3),t.Oqu(t.lcZ(4,3,o)),t.xp6(3),t.Oqu(t.lcZ(7,5,null==o?null:o.birthDate))}}function K(r,T){1&r&&(t.TgZ(0,"mat-error"),t.SDv(1,14),t.qZA())}let b=(()=>{class r extends B.lo{constructor(o,n,s,i){super(o),this.ngControl=o,this.mpplService=n,this.personNamePipe=s,this.personAgePipe=i,this.items=[],this.selections=[],this.separatorKeysCodes=[Y.K5,Y.OC],this.indicator=(0,t.tdS)(!0),this.filter=C.J.paged(1,10),this.totalPages=-1,this.displayFn=u=>{if(!u)return"";const Z=this.personNamePipe.transform(u),U=this.personAgePipe.transform(u?.birthDate);return U?`${Z}, ${U}`:`${Z}`}}ngOnInit(){this.control=this.ngControl.control,this.listenChanges()}listenChanges(){this.control.valueChanges.pipe((0,N.BI)(400)).subscribe(o=>{this.handleValueChanged(o)})}handleValueChanged(o){if(this.reset(),"string"==typeof o){const n=o.split(" ");2===n.length?(this.filter.query=n[0],this.filter.lastName=n[1]):this.filter.query=n[0]}this.get()}add(){this.control.setValue(this.selections.map(o=>o.id))}remove(o){const n=this.selections.indexOf(o);n>=0&&this.selections.splice(n,1)}optionSelected(o){this.selections.push(o.option.value),this.input.nativeElement.value="",this.control.setValue(this.selections.map(n=>n.id))}scroll(){this.filter.pageIndex<this.totalPages&&(++this.filter.pageIndex,this.get())}reset(){this.filter=C.J.paged(1,10),this.totalPages=-1,this.items=[]}get(){this.mpplService.persons.get(this.filter).pipe((0,R.q)(1),(0,N.sU)(this.indicator)).subscribe(o=>{this.items.push(...o.items),this.totalPages=o.totalPages})}static#t=this.\u0275fac=function(n){return new(n||r)(t.Y36(c.a5,10),t.Y36($.i),t.Y36(D.Y),t.Y36(v.g))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["medisy-form-field-persons-search"]],viewQuery:function(n,s){if(1&n&&t.Gf(H,5),2&n){let i;t.iGM(i=t.CRH())&&(s.input=i.first)}},standalone:!0,features:[t._Bn([$.i,v.g,D.Y]),t.qOj,t.jDz],decls:12,vars:9,consts:function(){let o,n;return o="\u0627\u0644\u0627\u0633\u0645 \u0627\u0648 \u0627\u0644\u0647\u0627\u062A\u0641 \u0627\u0648 \u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0627\u0644\u0643\u062A\u0631\u0648\u0646\u064A",n="\u0647\u0630\u0627 \u0627\u0644\u062D\u0642\u0644 \u0645\u0637\u0644\u0648\u0628",[o,["aria-label","Fruit selection"],["chipGrid",""],[3,"removed",4,"ngFor","ngForOf"],["matInput","",3,"matAutocomplete","formControl","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["input",""],[3,"displayWith","szOptionsScrollIgnored","optionSelected","optionsScroll"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"removed"],["matChipRemove",""],[3,"value"],[1,"sz-form"],n]},template:function(n,s){if(1&n&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t.SDv(2,0),t.qZA(),t.TgZ(3,"mat-chip-grid",1,2),t.YNc(5,X,6,3,"mat-chip-row",3),t.qZA(),t.TgZ(6,"input",4,5),t.NdJ("matChipInputTokenEnd",function(){return s.add()}),t.qZA(),t.TgZ(8,"mat-autocomplete",6,7),t.NdJ("optionSelected",function(u){return s.optionSelected(u)})("optionsScroll",function(){return s.scroll()}),t.YNc(10,Q,8,7,"mat-option",8),t.qZA(),t.YNc(11,K,2,0,"mat-error",9),t.qZA()),2&n){const i=t.MAs(4),u=t.MAs(9);t.xp6(5),t.Q6J("ngForOf",s.selections),t.xp6(1),t.Q6J("matAutocomplete",u)("formControl",s.control)("matChipInputFor",i)("matChipInputSeparatorKeyCodes",s.separatorKeysCodes),t.xp6(2),t.Q6J("displayWith",s.displayFn)("szOptionsScrollIgnored",s.indicator()),t.xp6(2),t.Q6J("ngForOf",s.items),t.xp6(1),t.Q6J("ngIf",s.control.hasError("required"))}},dependencies:[m.ez,m.sg,m.O5,c.UX,c.Fj,c.JJ,c.oH,h.lN,h.KE,h.hX,h.TO,I.Bb,I.XC,F.ey,I.ZL,z.c,z.Nt,F.Ng,M.Hi,M.RA,M.oH,M.qH,M.z3,A.Ps,A.Hw,G.W,v.g,D.Y],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]{position:relative}mat-progress-bar[_ngcontent-%COMP%]{position:absolute;bottom:20px}"]})}return r})();var W=e(4622),j=e(6091);let V=(()=>{class r extends l.Z2{constructor(o,n,s){super(n),this.fb=o,this.dialog=n,this.data=s,this.form=o.group({testGroupIds:[s.testGroupIds],laboratoryIds:[s.laboratoryIds],personIds:[s.personIds],startDate:[s.startDate],endDate:[s.endDate]})}submit(){this.IsValid()&&this.dialog?.close(this.form.value)}static#t=this.\u0275fac=function(n){return new(n||r)(t.Y36(c.qu),t.Y36(a.so),t.Y36(a.WI))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["medisy-laboratory-analyses-filter"]],standalone:!0,features:[t._Bn([]),t.qOj,t.jDz],decls:16,vars:9,consts:function(){let o,n,s;return o="\u0627\u0644\u062A\u0627\u0631\u064A\u062E",n="\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0628\u062F\u0627\u064A\u0629",s="\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0646\u0647\u0627\u064A\u0629",[[3,"header"],[1,"sz-form",3,"formGroup"],["formControlName","testGroupIds",3,"multiple"],["formControlName","laboratoryIds",3,"multiple"],["formControlName","personIds"],[1,"tw-flex-1"],o,["startView","year",3,"rangePicker","comparisonStart","comparisonEnd"],["matStartDate","","placeholder",n,"formControlName","startDate"],["matEndDate","","placeholder",s,"formControlName","endDate"],["matSuffix","",3,"for"],["datePicker",""],[3,"actions"]]},template:function(n,s){if(1&n&&(t._UZ(0,"sz-ui-dialog-header",0),t.TgZ(1,"mat-dialog-content")(2,"form",1),t._UZ(3,"medisy-form-field-test-group-select",2)(4,"medisy-form-field-laboratory",3)(5,"medisy-form-field-persons-search",4),t.TgZ(6,"mat-form-field",5)(7,"mat-label"),t.SDv(8,6),t.qZA(),t.TgZ(9,"mat-date-range-input",7),t._UZ(10,"input",8)(11,"input",9),t.qZA(),t._UZ(12,"mat-datepicker-toggle",10)(13,"mat-date-range-picker",null,11),t.qZA()()(),t._UZ(15,"sz-ui-dialog-actions",12)),2&n){const i=t.MAs(14);t.Q6J("header",s.header),t.xp6(2),t.Q6J("formGroup",s.form),t.xp6(1),t.Q6J("multiple",!0),t.xp6(1),t.Q6J("multiple",!0),t.xp6(5),t.Q6J("rangePicker",i)("comparisonStart",s.form.controls.startDate.value)("comparisonEnd",s.form.controls.endDate.value),t.xp6(3),t.Q6J("for",i),t.xp6(3),t.Q6J("actions",s.actions)}},dependencies:[m.ez,c.UX,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,a.Is,a.xY,h.lN,h.KE,h.hX,h.R9,l.su,W.Y,j.t,x.Q,J.w,b,P.FA,P.nW,P.wx,P.zY,P.By,P._g],encapsulation:2})}return r})();var q=e(8359),w=e(3144),k=e(2516);const tt=[{path:"",component:(()=>{class r{constructor(o,n,s){this.dialog=o,this.mlabService=n,this.route=s,this.dataSource=new _.b2(C.J.pagedSorted("-createdAt")),this.dataSource.columns=[_.UC.hyperlink("code","\u0627\u0644\u0631\u0645\u0632",i=>i.id),O.h.createdAt(),O.h.menu([])],this.dataSource.updateFilterModel(this.route.snapshot.queryParams),this.get()}openFilterComponent(){this.dialog.open(V,{data:this.dataSource.filterModel}).afterClosed().pipe((0,R.q)(1)).subscribe(n=>{this.dataSource.updateFilterModel(n),this.get()})}get(){this.mlabService.analyses.get(this.dataSource.filterModel).pipe((0,N.sU)(this.dataSource.indicator),(0,R.q)(1)).subscribe(o=>{this.dataSource.set(o.items,o.count)})}static#t=this.\u0275fac=function(n){return new(n||r)(t.Y36(a.uw),t.Y36(p.t),t.Y36(d.gz))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["medisy-laboratory-analyses"]],features:[t._Bn([])],decls:8,vars:4,consts:function(){let o,n;return o="\u0627\u0644\u062A\u062D\u0627\u0644\u064A\u0644",n="\u0625\u0636\u0627\u0641\u0629",[["start","",1,"sz-h5"],o,[3,"dataSource","search","filter"],["title","","mat-flat-button","","routerLink","create","color","primary","start",""],n,[3,"paginationEnabled","stateEnabled","dataSource","update"]]},template:function(n,s){1&n&&(t.TgZ(0,"sz-ui-header-basic")(1,"h5",0),t.SDv(2,1),t.qZA()(),t.TgZ(3,"sz-ui-table-filter",2),t.NdJ("search",function(){return s.get()})("filter",function(){return s.openFilterComponent()}),t.TgZ(4,"button",3)(5,"span"),t.SDv(6,4),t.qZA()()(),t.TgZ(7,"sz-ui-table",5),t.NdJ("update",function(){return s.get()}),t.qZA()),2&n&&(t.xp6(3),t.Q6J("dataSource",s.dataSource),t.xp6(4),t.Q6J("paginationEnabled",!0)("stateEnabled",!0)("dataSource",s.dataSource))},dependencies:[d.rH,q.K,w.f,k.z,g.lW],styles:[".column-status[_ngcontent-%COMP%], .mat-column-detail-status[_ngcontent-%COMP%], .mat-column-status[_ngcontent-%COMP%]:not(mat-header-cell){max-width:4px;margin-left:24px}.mat-column-status[_ngcontent-%COMP%]:not(mat-header-cell){background-color:#13a311}.mat-column-detail-status[_ngcontent-%COMP%]{background-color:#13a311}.mat-cell[_ngcontent-%COMP%]   .mat-column-status[_ngcontent-%COMP%]{padding-left:0}"]})}return r})()},{path:"create",loadComponent:()=>Promise.all([e.e(187),e.e(592),e.e(709)]).then(e.bind(e,6709)).then(r=>r.CreateComponent)}];let et=(()=>{class r{static#t=this.\u0275fac=function(n){return new(n||r)};static#e=this.\u0275mod=t.oAB({type:r});static#o=this.\u0275inj=t.cJS({providers:[p.t],imports:[m.ez,d.Bz.forChild(tt),a.Is,_.Vn,y.E3,l.su,S.n,E.Tx,A.Ps,g.ot]})}return r})()},5026:(L,f,e)=>{e.d(f,{g:()=>g});var m=e(5879);let g=(()=>{class a{transform(E){if(!E)return"";const d=new Date,p=new Date(E),l=~~((d.getTime()-p.getTime())/1e3/3600),S=~~(l/24),_=~~(S/7),O=~~(S/30),C=~~(d.getUTCFullYear()-p.getUTCFullYear());return C>0?`${C} `+"\u0633\u0646\u0629":O>0?`${O} `+"\u0634\u0647\u0631":_>0?`${_} `+"\u0623\u0633\u0628\u0648\u0639":S>0?`${S} `+"\u064A\u0648\u0645":l>0?`${l} `+"\u0633\u0627\u0639\u0629":""}static#t=this.\u0275fac=function(d){return new(d||a)};static#e=this.\u0275pipe=m.Yjl({name:"personAge",type:a,pure:!0,standalone:!0})}return a})()},6089:(L,f,e)=>{e.d(f,{W:()=>d});var m=e(5879),g=e(8645),a=e(9397),A=e(9773),E=e(4630);let d=(()=>{class p{constructor(l){this.autoComplete=l,this.szOptionsScrollThresholdPercent=.9,this.szOptionsScrollIgnored=!1,this.optionsScroll=new m.vpe,this._onDestroy=new g.x,this.autoComplete.opened.pipe((0,a.b)(()=>{setTimeout(()=>{this.removeScrollEventListener(),this.autoComplete.panel.nativeElement.addEventListener("scroll",this.onScroll.bind(this))})}),(0,A.R)(this._onDestroy)).subscribe(),this.autoComplete.closed.pipe((0,a.b)(()=>this.removeScrollEventListener()),(0,A.R)(this._onDestroy)).subscribe()}removeScrollEventListener(){this.autoComplete&&this.autoComplete.panel&&this.autoComplete.panel.nativeElement&&this.autoComplete.panel.nativeElement.removeEventListener("scroll",this.onScroll)}onScroll(l){this.szOptionsScrollIgnored||(void 0===this.szOptionsScrollThresholdPercent||l.target.scrollTop+l.target.clientHeight>100*this.szOptionsScrollThresholdPercent*l.target.scrollHeight/100)&&this.optionsScroll.next({autoComplete:this.autoComplete,scrollEvent:l})}ngOnDestroy(){this._onDestroy.next(!0),this._onDestroy.complete(),this.removeScrollEventListener()}static#t=this.\u0275fac=function(S){return new(S||p)(m.Y36(E.XC))};static#e=this.\u0275dir=m.lG2({type:p,selectors:[["mat-autocomplete","optionsScroll",""]],inputs:{szOptionsScrollThresholdPercent:"szOptionsScrollThresholdPercent",szOptionsScrollIgnored:"szOptionsScrollIgnored"},outputs:{optionsScroll:"optionsScroll"},standalone:!0})}return p})()}}]);