import{a as M}from"./chunk-F6XQL5QN.js";import{a as Re}from"./chunk-7W4DPCX5.js";import{a as he,d as Le,e as m,h as Ie,i as ve,j as v}from"./chunk-OKHT2ZMW.js";import"./chunk-YSNB3P37.js";import"./chunk-M6VFFTL7.js";import{a as Ce}from"./chunk-5TNDWLJL.js";import{a as f}from"./chunk-I3W7CTPV.js";import"./chunk-2DOHZQYD.js";import{b as Ne,f as Te,g as ge,h as Ve,j as Ae,k as I}from"./chunk-JDBQ45YP.js";import{a as L}from"./chunk-ZGUTF2MC.js";import{d as Me,j as s,k as Oe}from"./chunk-53DZ6NLX.js";import{a as ie,b as ne,d as V,e as ae,g as A}from"./chunk-7B3GMYBR.js";import{a as _e,b as fe,q as h,r as ce,s as Se,t as Ee}from"./chunk-NKLFXX3X.js";import"./chunk-VPIQ5RG6.js";import"./chunk-PYOUUVMA.js";import"./chunk-ODIMT2GD.js";import"./chunk-NBE6QGAD.js";import{h as le,i as se,k as me}from"./chunk-IT3CNXEP.js";import{b as X,d as T,f as j,g as k,k as q,l as H,n as W,q as Q,r as J,t as K,u as Z}from"./chunk-QZRJHJEV.js";import{Y as pe,Z as de,r as te,t as oe}from"./chunk-4QPQ7IQ3.js";import{a as g,d as ee}from"./chunk-WMCOMOML.js";import"./chunk-HNENNTVD.js";import"./chunk-V2COJPJH.js";import{ia as re,la as ue}from"./chunk-H2OL5IOU.js";import"./chunk-CYOOLWM5.js";import{Eb as N,Jb as d,Kb as _,Lb as l,Wb as y,Yb as D,bb as u,ea as Y,f as G,ja as n,mb as x,mc as E,na as S,nc as C,oa as w,rb as b,yb as a}from"./chunk-6EDHPT3A.js";import{c as $}from"./chunk-NLUW4JS2.js";function ye(i,t){if(i&1&&l(0,"sz-ui-form-field-select",4),i&2){let R=D();a("source",R.testTypeResultOptions);}}function De(i,t){i&1&&(d(0,"div",7)(1,"mat-form-field",8)(2,"label"),l(3,"input",9),_()(),d(4,"mat-form-field",8)(5,"label"),l(6,"input",10),_()()());}function ze(i,t){i&1&&(d(0,"mat-form-field",8)(1,"label"),l(2,"input",11),_()());}function Be(i,t){if(i&1&&b(0,De,7,0,"div",7)(1,ze,3,0,"mat-form-field",8),i&2){let R=D();N(R.isRange()?0:-1),u(),N(R.isRange()?-1:1);}}var be=(()=>{let t=class t extends Te{constructor(){let e=n(ie);super(e),this.mlabService=n(f),this.fb=n(J),this.data=n(ne),this.referenceGroups=this.mlabService.referenceGroups.getAll({orderBy:["nameEn"],filterBehavior:te.Or,filters:oe.create().equalIf("id",this.data.referenceValueRule?.referenceGroupId).notAny("referenceValueRules.referenceValueId",[this.data.referenceValue.id]).filters()}),this.testTypeResultOptions=this.mlabService.testTypes.resultOptions.getAll(this.data.referenceValue.testTypeId,{orderBy:["nameEn"]}),this.comparisonOperators=Object.keys(M).map(p=>M[p]);let r=this.fb;this.dialog=e;let o=this.data;this.form=r.group({description:[o.referenceValueRule?.description,[T.maxLength(4096)]],comparisonOperator:new q(o.referenceValueRule?.comparisonOperator??M.Equal,[T.required]),referenceGroupId:[o.referenceValueRule?.referenceGroupId,[T.required]],value:[o.referenceValueRule?.value,[]],start:[o.referenceValueRule?.start,[]],end:[o.referenceValueRule?.end,[]],testTypeResultOptionId:[o.referenceValueRule?.testTypeResultOptionId,[]]});}isRange(){return this.form.value.comparisonOperator===M.RangeWithBoundaries||this.form.value.comparisonOperator===M.RangeWithoutBoundaries;}submit(){this.IsValid()&&(this.data.referenceValueRuleId?this.save(this.mlabService.referenceValues.rules.update(this.data.referenceValue.id,this.data.referenceValueRuleId,this.form.value)):this.save(this.mlabService.referenceValues.rules.create(this.data.referenceValue.id,this.form.value)));}};t.ɵfac=function(r){return new(r||t)();},t.ɵcmp=S({type:t,selectors:[["sz-medisy-laboratory-reference-value-rules-save"]],standalone:!0,features:[E([]),x,C],decls:9,vars:9,consts:()=>{let e;e="\u0627\u0644\u0641\u0626\u0629 \u0627\u0644\u0645\u0631\u062C\u0639\u064A\u0629";let r;r="\u0627\u0644\u0639\u0645\u0644\u064A\u0629";let o;o="\u0642\u064A\u0645\u0629";let p;p="\u0627\u0644\u0648\u0635\u0641";let O;O="\u0628\u062F\u0627\u064A\u0629";let F;F="\u0646\u0647\u0627\u064A\u0629";let U;return U="\u0642\u064A\u0645\u0629",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","referenceGroupId","label",e,3,"source"],["formControlName","comparisonOperator","label",r,3,"source","localizedValue"],["formControlName","testTypeResultOptionId","label",o,3,"source"],["formControlName","description","label",p],[3,"actions"],[1,"tw-flex","md:tw-flex-row","tw-flex-col","md:tw-gap-4"],[1,"tw-flex-1"],["autocomplete","off","formControlName","start","matInput","","placeholder",O],["autocomplete","off","formControlName","end","matInput","","placeholder",F],["autocomplete","off","formControlName","value","matInput","","placeholder",U]];},template:function(r,o){r&1&&(l(0,"sz-ui-dialog-header",0),d(1,"mat-dialog-content")(2,"form",1),l(3,"sz-ui-form-field-select",2)(4,"sz-ui-form-field-select",3),b(5,ye,1,1,"sz-ui-form-field-select",4)(6,Be,2,2),l(7,"sz-ui-form-field-textarea",5),_()(),l(8,"sz-ui-dialog-actions",6)),r&2&&(a("title",o.title)("subtitle",o.subtitle)("alert",o.alert()),u(2),a("formGroup",o.form),u(),a("source",o.referenceGroups),u(),a("source",o.comparisonOperators)("localizedValue",!0),u(),N(o.data.referenceValue.testType.hasResultOptions?5:6),u(3),a("actions",o.actions));},dependencies:[Z,H,X,j,k,W,Q,fe,_e,le,A,ae,se,h,I,ge,Ve,Ee,Se,ce],encapsulation:2});let i=t;return i;})();var B=(()=>{let t=class t{constructor(){this.dialog=n(V),this.mlabService=n(f),this.route=n(g),this.dataSource=new Ie(),this.referenceValue=this.route.snapshot.data.referenceValue,this.appBarConfig={title:pe.rules,subtitle:this.referenceValue.testType.nameEn,backEnabled:!0,backUrl:`/${Ce.ReferenceValues}`,menu:Oe.default().setItems([s.add(this.openSaveComponent.bind(this)),s.menu([s.search(),s.filter()])])},this.dataSource.columnDefs.push(m.uuid("id"),m.string("referenceGroup.nameEn").setValueClassFontBold().setStacked(m.string("referenceGroup.description").setStyleSmall()),m.enum("comparisonOperator").setValueGetter(e=>de(e.comparisonOperator)),m.number("_value").setValueGetter(e=>e.testTypeResultOption?e.testTypeResultOption.nameEn:e.value!==null?e.value:`${e.start} - ${e.end}`).setHeaderSortable(!1),m.date("createdAt").setVisible(!1),m.date("updatedAt").setVisible(!1),m.menu([s.edit(this.openSaveComponent.bind(this)),s.divider(),s.clone(e=>{let O=e,{id:r,referenceGroupId:o}=O,p=$(O,["id","referenceGroupId"]);this.openSaveComponent(p);}),s.divider(),s.delete(this.openReferenceValueRuleDeleteComponent.bind(this))]));}ngOnInit(){this.get();}openSaveComponent(e){this.dialog.open(be,{data:{referenceValue:this.referenceValue,referenceValueRule:e,referenceValueRuleId:e?.id}}).afterClosed().subscribe(r=>{this.dataSource.addOrUpdateItem(r);});}openReferenceValueRuleDeleteComponent(e){this.dialog.open(Ae,{data:Ne.delete(this.mlabService.referenceValues.rules.delete(e.referenceValueId,e.id),e)}).afterClosed().subscribe(r=>{this.dataSource.delete(r);});}get(){this.mlabService.referenceValues.rules.get(this.referenceValue.id,this.dataSource.getQuery()).pipe(ve(this.dataSource.state)).subscribe(e=>{this.dataSource.set(e.items,e.count);});}};t.ɵfac=function(r){return new(r||t)();},t.ɵcmp=S({type:t,selectors:[["sz-medisy-laboratory-reference-value-rules"]],standalone:!0,features:[E([f]),C],decls:2,vars:3,consts:[[3,"changed","config","dataSource"],["content","",3,"update","dataSource"]],template:function(r,o){r&1&&(d(0,"sz-ui-table-bar",0),y("changed",function(){return o.get();}),_(),d(1,"sz-ui-table",1),y("update",function(){return o.get();}),_()),r&2&&(a("config",o.appBarConfig)("dataSource",o.dataSource),u(),a("dataSource",o.dataSource));},dependencies:[v,Le,he],encapsulation:2});let i=t;return i;})();var P=(()=>{let t=class t{constructor(){this.dialog=n(V),this.route=n(g),this.alert$=new G(),this.referenceValue=this.route.snapshot.data.referenceValue,this.appBarConfig={title:this.referenceValue.testType.nameEn,subtitle:this.referenceValue.description,backEnabled:!0};}};t.ɵfac=function(r){return new(r||t)();},t.ɵcmp=S({type:t,selectors:[["sz-medisy-laboratory-reference-value"]],standalone:!0,features:[E([]),C],decls:1,vars:1,consts:[[3,"config"]],template:function(r,o){r&1&&l(0,"sz-ui-app-bar",0),r&2&&a("config",o.appBarConfig);},dependencies:[L],encapsulation:2});let i=t;return i;})();var jt=(()=>{let t=class t{};t.ɵfac=function(r){return new(r||t)();},t.ɵmod=w({type:t}),t.ɵinj=Y({providers:[f],imports:[K,ee.forChild([{path:"",component:P},{path:"rules",component:B}]),A,h,Me,re,ue,me,v,Re,I,L,B,P]});let i=t;return i;})();export{jt as ReferenceValueModule};/**i18n:71c33448fc84035c6ee56f25f20b16a3c311d1f911de884d4bce9857c4574a16*/