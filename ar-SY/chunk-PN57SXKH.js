import{c as B}from"./chunk-5F562KO7.js";import{a as X}from"./chunk-N4OEAX3M.js";import{a as te}from"./chunk-62AWE5Y3.js";import{a as et,b as tt,c as it,d as ot,e as nt}from"./chunk-6RW6X2LX.js";import{a as Ke,b as Je,j as Ze}from"./chunk-7EDJIE54.js";import"./chunk-27JWOOCV.js";import"./chunk-YW243LJ5.js";import"./chunk-IPSBHU2F.js";import{d as Ye,e as Te}from"./chunk-NRCTH42F.js";import{b as He,g as z,h as v,i as x,j as We,k as je,l as V}from"./chunk-ELQLAKIA.js";import"./chunk-C5ZC4CIA.js";import{b as ve}from"./chunk-MWQGI46C.js";import{a as A,b as P,d as ze,e as b,g as c}from"./chunk-E4TEUKJS.js";import{c as U,p as G,s as we,v as y}from"./chunk-V4RZZIA4.js";import{b as Be}from"./chunk-WVGZ6EPO.js";import"./chunk-42VATFFK.js";import{i as F}from"./chunk-PTIBRYNA.js";import{d as r,f as N,g as h,l as O,o as I,p as Fe,r as L,s as D,u as R}from"./chunk-TREJVBUP.js";import{b as $,c as ke}from"./chunk-OVLZQTDQ.js";import{a as Qe}from"./chunk-7QH56VCJ.js";import{a as Ue,b as Xe,c as qe,d as Q,e as le}from"./chunk-PEM2EPPP.js";import"./chunk-EZUR7QLE.js";import{a as re}from"./chunk-ZFFSAQ5L.js";import{a as xe,b as Ve}from"./chunk-OAWJL35K.js";import{p as Ge}from"./chunk-3XDE5DVI.js";import"./chunk-YNTWYDZK.js";import"./chunk-UQVVYN55.js";import{Ia as $e,Ja as oe,Ma as ne,ja as ye,r as be}from"./chunk-34DVLRFE.js";import{Ab as Ie,Cb as ie,Ea as fe,Fb as Le,Hb as De,Ib as Re,Jb as Ae,K as Ce,Kb as m,Lb as p,Mb as a,Qb as Ee,Wb as K,Xb as j,Zb as w,ab as Ne,bc as J,cb as f,cc as Z,dc as ee,gc as Pe,hc as Me,ja as _,jb as he,lb as Oe,na as M,nb as C,nc as T,oc as S,sb as ue,wa as H,xa as W,zb as d}from"./chunk-43EFT4VW.js";import{a as ce,b as ge}from"./chunk-47HSKSNM.js";var q=class{static round2Decimals(n){return Math.round(n*100)/100;}};var g=class{static toPixel(n,u){return n==="mm"?u*3.78:n==="cm"?u*37.8:n==="in"?u*96:u;}static fromPixel(n,u){return n==="mm"?u/3.78:n==="cm"?u/37.8:n==="in"?u/96:u;}};var rt=(()=>{let n=class n{constructor(){this.httpClient=_(be),this.viewContainerRef=_(he),this.element=null,this.isMoving=!1,this.changed=new fe(),this.deleted=new fe();}ngAfterViewInit(){this.render();}handleKeyboardEvent(t){t.key==="Delete"&&console.log("delete");}render(){this.field.type==="text"?this.addTextField(this.field):this.field.type==="barcode"?this.addBarcodeField(this.field):this.field.type==="table"?this.addTableField(this.field):this.field.type==="line"?this.addLineField(this.field):this.field.type==="image"&&this.addImageField(this.field);}getContainerElement(){return this.viewContainerRef.element.nativeElement;}addTextField(t){let e=t;if(!e)return;let i=this.getContainerElement(),o=document.createElement("p");o.innerText=e.text,o.style.position="absolute",o.style.left=`${e.x}${this.unit}`,o.style.top=`${e.y}${this.unit}`,o.style.fontSize=`${e.fontSize}`,o.style.color=e.fontColor??"black",o.style.textAlign=e.textAlign??"left",i.appendChild(o);}addBarcodeField(t){let e=t;if(!e)return;let i=this.getContainerElement(),o=null;if(e.barcodeType==="qr"&&(o=Te.qr(e.value)),e.barcodeType==="datamatrix"&&(o=Te.datamatrix(e.value,!1)),!o)return;let s=Ye.toSVG(o,e.options);s&&(s.style.width=`${e.width??18}${this.unit}`,s.style.height=`${e.height??18}${this.unit}`,i.appendChild(s));}addTableField(t){let e=t;if(!e)return;let i=this.getContainerElement(),o=document.createElement("table");o.style.position="absolute",o.style.left=`${e.x}${this.unit}`,o.style.top=`${e.y}${this.unit}`,o.style.right=`${e.x2}${this.unit}`,o.style.bottom=`${e.y2}${this.unit}`,o.style.borderCollapse="collapse",o.style.border="1px solid black";let s=document.createElement("thead"),E=document.createElement("tr");e.columns.forEach(k=>{let pe=document.createElement("th");pe.innerText=typeof k=="string"?k:typeof k=="number"?k.toString():k.key?.toString()??"",pe.style.width="auto",E.appendChild(pe);}),s.appendChild(E),o.appendChild(s),i.appendChild(o);}addLineField(t){let e=t;if(!e)return;let i=this.getContainerElement(),o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("viewBox",`0 0 ${this.convertUnitToPixel(210)} ${this.convertUnitToPixel(297)}`),o.setAttribute("xmlns","http://www.w3.org/2000/svg"),o.setAttribute("version","1.1"),o.setAttribute("style","position: absolute;");let s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("d",`M${this.convertUnitToPixel(e.x)},${this.convertUnitToPixel(e.y)} L${this.convertUnitToPixel(e.x2)},${this.convertUnitToPixel(e.y2)}`),s.setAttribute("stroke",e.lineColor??"black"),s.setAttribute("stroke-width",`${this.convertUnitToPixel(e.lineWidth)??1}`),s.setAttribute("cdkDrag",""),o.appendChild(s),i.appendChild(o);}addImageField(t){let e=t;if(!e)return;let i=this.getContainerElement(),o=document.createElement("img");o.alt="",this.httpClient.get(e.url,{responseType:"blob"}).pipe(Ce(1)).subscribe(s=>{let E=new FileReader();E.onloadend=()=>{o.src=E.result;},E.readAsDataURL(s);}),o.style.position="absolute",o.style.left=`${e.x}${this.unit}`,o.style.top=`${e.y}${this.unit}`,o.style.width=`${e.width}${this.unit}`,o.style.height=`${e.height}${this.unit}`,i.appendChild(o);}convertUnitToPixel(t){return this.unit==="mm"?t*3.78:this.unit==="cm"?t*37.8:this.unit==="in"?t*96:t;}};n.ɵfac=function(e){return new(e||n)();},n.ɵcmp=M({type:n,selectors:[["sz-mgmt-reporting-template-field"]],viewQuery:function(e,i){if(e&1&&J(Q,7),e&2){let o;Z(o=ee())&&(i.matMenuTrigger=o.first);}},hostBindings:function(e,i){e&1&&j("keydown",function(s){return i.handleKeyboardEvent(s);},!1,Ne);},inputs:{field:"field",unit:"unit"},outputs:{changed:"changed",deleted:"deleted"},standalone:!0,features:[T([te]),S],decls:0,vars:0,template:function(e,i){},dependencies:[c,ne,le,oe],encapsulation:2});let l=n;return l;})();var lt=(()=>{let n=class n extends z{constructor(){super(_(A)),this.fb=_(D),this.data=_(P),this.barcodeTypes=["qr","datamatrix"];let t=this.fb,e=this.data;this.form=t.group({id:[e?.id??X.generateV7(),[r.required]],name:[e?.name,[]],type:["barcode",[r.required]],x:[e?.x??0,[r.required]],y:[e?.y??0,[r.required]],value:[e?.value??"",[r.required]],barcodeType:[e?.barcodeType??"qr",[r.required]],width:[e?.width??16,[r.required]],height:[e?.height??16,[r.required]]});}submit(){this.IsValid()&&this.dialogRef.close(this.form.value);}};n.ɵfac=function(e){return new(e||n)();},n.ɵcmp=M({type:n,selectors:[["sz-mgmt-reporting-template-barcode-field"]],standalone:!0,features:[T([]),C,S],decls:13,vars:6,consts:()=>{let t;t="\u0627\u0644\u0627\u0633\u0645";let e;e="\u0627\u0644\u0642\u064A\u0645\u0629";let i;i="\u0627\u0644\u0646\u0645\u0637";let o;o="\u0627\u0644\u0639\u0631\u0636";let s;return s="\u0627\u0644\u0627\u0631\u062A\u0641\u0627\u0639",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","name","label",t],["formControlName","value","label",e],["formControlName","barcodeType","label",i,3,"source"],[1,"sz-form-row"],["formControlName","x","label","X"],["formControlName","y","label","Y"],["formControlName","width","label",o],["formControlName","height","label",s],[3,"actions"]];},template:function(e,i){e&1&&(a(0,"sz-ui-dialog-header",0),m(1,"mat-dialog-content")(2,"form",1),a(3,"sz-ui-form-field-input-text",2)(4,"sz-ui-form-field-input-text",3)(5,"sz-ui-form-field-select",4),m(6,"div",5),a(7,"sz-ui-form-field-input-number",6)(8,"sz-ui-form-field-input-number",7),p(),m(9,"div",5),a(10,"sz-ui-form-field-input-number",8)(11,"sz-ui-form-field-input-number",9),p()()(),a(12,"sz-ui-dialog-actions",10)),e&2&&(d("title",i.title)("subtitle",i.subtitle)("alert",i.alert()),f(2),d("formGroup",i.form),f(3),d("source",i.barcodeTypes),f(7),d("actions",i.actions));},dependencies:[R,O,N,h,I,L,c,b,F,B,V,v,x,y,U,G,we],encapsulation:2});let l=n;return l;})();var at=(()=>{let n=class n extends z{constructor(){super(_(A)),this.fb=_(D),this.data=_(P);let t=this.fb,e=this.data;this.form=t.group({id:[e?.id??X.generateV7()],name:[e?.name,[]],type:["image",[r.required]],x:[e?.x??0,[r.required]],y:[e?.y??0,[r.required]],url:[e?.url??"",[r.required]],width:[e?.width??16,[r.required]],height:[e?.height??16,[r.required]]});}submit(){this.IsValid()&&this.dialogRef.close(this.form.value);}};n.ɵfac=function(e){return new(e||n)();},n.ɵcmp=M({type:n,selectors:[["sz-mgmt-reporting-template-image-field"]],standalone:!0,features:[T([]),C,S],decls:11,vars:5,consts:()=>{let t;t="\u0627\u0644\u0627\u0633\u0645";let e;e="\u0627\u0644\u0639\u0631\u0636";let i;return i="\u0627\u0644\u0627\u0631\u062A\u0641\u0627\u0639",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","name","label",t],[1,"sz-form-row"],["formControlName","x","label","X"],["formControlName","y","label","Y"],["formControlName","width","label",e],["formControlName","height","label",i],[3,"actions"]];},template:function(e,i){e&1&&(a(0,"sz-ui-dialog-header",0),m(1,"mat-dialog-content")(2,"form",1),a(3,"sz-ui-form-field-input-text",2),m(4,"div",3),a(5,"sz-ui-form-field-input-number",4)(6,"sz-ui-form-field-input-number",5),p(),m(7,"div",3),a(8,"sz-ui-form-field-input-number",6)(9,"sz-ui-form-field-input-number",7),p()()(),a(10,"sz-ui-dialog-actions",8)),e&2&&(d("title",i.title)("subtitle",i.subtitle)("alert",i.alert()),f(2),d("formGroup",i.form),f(8),d("actions",i.actions));},dependencies:[R,O,N,h,I,L,c,b,F,B,V,v,x,y,U,G],encapsulation:2});let l=n;return l;})();var st=(()=>{let n=class n extends z{constructor(){super(_(A)),this.fb=_(D),this.data=_(P);let t=this.fb,e=this.data;this.form=t.group({id:[e?.id??X.generateV7(),[r.required]],name:[e?.name,[]],type:["line",[r.required]],x:[e?.x??5,[r.required]],y:[e?.y??5,[r.required]],lineColor:[e?.lineColor??"#000",[r.required]],lineWidth:[e?.lineWidth??1,[r.required]],x2:[e?.x2??30,[r.required]],y2:[e?.y2??5,[r.required]]});}submit(){this.IsValid()&&this.dialogRef.close(this.form.value);}};n.ɵfac=function(e){return new(e||n)();},n.ɵcmp=M({type:n,selectors:[["sz-mgmt-reporting-template-line-field"]],standalone:!0,features:[T([]),C,S],decls:13,vars:5,consts:()=>{let t;t="\u0627\u0644\u0627\u0633\u0645";let e;e="\u0627\u0644\u0644\u0648\u0646";let i;return i="\u0627\u0644\u0639\u0631\u0636",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","name","label",t],[1,"sz-form-row"],["formControlName","x","label","X"],["formControlName","y","label","Y"],["formControlName","x2","label","X2"],["formControlName","y2","label","Y2"],["formControlName","lineColor","label",e],["formControlName","lineWidth","label",i],[3,"actions"]];},template:function(e,i){e&1&&(a(0,"sz-ui-dialog-header",0),m(1,"mat-dialog-content")(2,"form",1),a(3,"sz-ui-form-field-input-text",2),m(4,"div",3),a(5,"sz-ui-form-field-input-number",4)(6,"sz-ui-form-field-input-number",5),p(),m(7,"div",3),a(8,"sz-ui-form-field-input-number",6)(9,"sz-ui-form-field-input-number",7),p(),a(10,"sz-ui-form-field-input-text",8)(11,"sz-ui-form-field-input-number",9),p()(),a(12,"sz-ui-dialog-actions",10)),e&2&&(d("title",i.title)("subtitle",i.subtitle)("alert",i.alert()),f(2),d("formGroup",i.form),f(10),d("actions",i.actions));},dependencies:[R,O,N,h,I,L,c,b,F,B,V,v,x,y,U,G],encapsulation:2});let l=n;return l;})();var mt=(()=>{let n=class n extends z{constructor(){super(_(A)),this.fb=_(D),this.data=_(P);let t=this.fb,e=this.data;this.form=t.group({id:[e?.id??X.generateV7(),[r.required]],name:[e?.name,[]],type:["text",[r.required]],x:[e?.x??0,[r.required]],y:[e?.y??0,[r.required]],text:[e?.text??"",[r.required]],fontSize:[e?.fontSize??12,[r.required]],fontColor:[e?.fontColor??"#000",[r.required]]});}submit(){this.IsValid()&&this.dialogRef.close(this.form.value);}};n.ɵfac=function(e){return new(e||n)();},n.ɵcmp=M({type:n,selectors:[["sz-mgmt-reporting-template-text-field"]],standalone:!0,features:[T([]),C,S],decls:11,vars:5,consts:()=>{let t;t="\u0627\u0644\u0627\u0633\u0645";let e;e="\u0627\u0644\u0646\u0635";let i;i="\u062D\u062C\u0645 \u0627\u0644\u062E\u0637";let o;return o="\u0644\u0648\u0646 \u0627\u0644\u062E\u0637",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","name","label",t],[1,"sz-form-row"],["formControlName","x","label","X"],["formControlName","y","label","Y"],["formControlName","text","label",e],["formControlName","fontSize","label",i],["formControlName","fontColor","label",o],[3,"actions"]];},template:function(e,i){e&1&&(a(0,"sz-ui-dialog-header",0),m(1,"mat-dialog-content")(2,"form",1),a(3,"sz-ui-form-field-input-text",2),m(4,"div",3),a(5,"sz-ui-form-field-input-number",4)(6,"sz-ui-form-field-input-number",5),p(),a(7,"sz-ui-form-field-input-text",6)(8,"sz-ui-form-field-input-number",7)(9,"sz-ui-form-field-input-text",8),p()(),a(10,"sz-ui-dialog-actions",9)),e&2&&(d("title",i.title)("subtitle",i.subtitle)("alert",i.alert()),f(2),d("formGroup",i.form),f(8),d("actions",i.actions));},dependencies:[R,O,N,h,I,L,c,b,F,B,V,v,x,y,U,G],encapsulation:2});let l=n;return l;})();var _t=(()=>{let n=class n extends z{constructor(){super(_(A)),this.fb=_(D),this.data=_(P);let t=this.fb,e=this.data;this.form=t.group({margins:this.fb.group({top:[e?.margins?.top??0,[r.required]],right:[e?.margins?.right??0,[r.required]],bottom:[e?.margins?.bottom??0,[r.required]],left:[e?.margins?.left??0,[r.required]]}),fields:[e?.fields??[],[r.required]]});}submit(){this.IsValid()&&this.dialogRef.close(this.form.value);}};n.ɵfac=function(e){return new(e||n)();},n.ɵcmp=M({type:n,selectors:[["sz-mgmt-reporting-template-settings"]],standalone:!0,features:[T([]),C,S],decls:16,vars:5,consts:()=>{let t;t="\u064A\u0633\u0627\u0631";let e;e="\u0623\u0639\u0644\u0649";let i;i="\u064A\u0645\u064A\u0646";let o;o="\u0623\u0633\u0641\u0644";let s;return s="\u0627\u0644\u0647\u0648\u0627\u0645\u0634",[s,[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formGroupName","margins",1,"tw-mb-4"],["multi",""],[1,"sz-form-row"],["formControlName","left","label",t],["formControlName","top","label",e],["formControlName","right","label",i],["formControlName","bottom","label",o],[3,"actions"]];},template:function(e,i){e&1&&(a(0,"sz-ui-dialog-header",1),m(1,"mat-dialog-content")(2,"form",2)(3,"div",3)(4,"mat-accordion",4)(5,"mat-expansion-panel")(6,"mat-expansion-panel-header")(7,"mat-panel-title"),K(8,0),p()(),m(9,"div",5),a(10,"sz-ui-form-field-input-number",6)(11,"sz-ui-form-field-input-number",7),p(),m(12,"div",5),a(13,"sz-ui-form-field-input-number",8)(14,"sz-ui-form-field-input-number",9),p()()()()()(),a(15,"sz-ui-dialog-actions",10)),e&2&&(d("title",i.title)("subtitle",i.subtitle)("alert",i.alert()),f(2),d("formGroup",i.form),f(13),d("actions",i.actions));},dependencies:[R,O,N,h,I,L,Fe,c,b,F,B,nt,ot,et,tt,it,V,v,x,y,G],encapsulation:2});let l=n;return l;})();var pt=["designer"];function ft(l,n){if(l&1&&a(0,"div"),l&2){let u=w();ie(u.getMarginsStyle());}}function ut(l,n){if(l&1){let u=Ee();m(0,"sz-mgmt-reporting-template-field",12),j("cdkDragEnded",function(e){let i=H(u).$implicit,o=w();return W(o.drop(e,i));})("dblclick",function(){let e=H(u).$implicit,i=w();return W(i.openFieldSettingsComponent(e));})("contextmenu",function(e){let i=H(u).$implicit,o=w();return W(o.fieldRightClick(e,i));}),p();}if(l&2){let u=n.$implicit,t=w();ie(t.getFieldStyle(u)),d("field",u);}}function Et(l,n){if(l&1){let u=Ee();m(0,"button",13),j("click",function(){let e=H(u).field,i=w();return W(i.openFieldSettingsComponent(e));}),m(1,"mat-icon"),Me(2,"edit"),p(),m(3,"span"),K(4,2),p()(),a(5,"mat-divider"),m(6,"button",13),j("click",function(){let e=H(u).field,i=w();return W(i.openFieldDeleteComponent(e));}),m(7,"mat-icon"),Me(8,"delete"),p(),m(9,"span"),K(10,3),p()();}}var dt=(()=>{let n=class n{constructor(){this.route=_(Ge),this.dialog=_(ze),this.srptService=_(te),this.snackBar=_(ve),this.template=this.route.snapshot.data.template,this.alert=Oe(void 0),this.size={width:210,height:297,unit:"mm"},this.contextMenuPosition={x:"0px",y:"0px"},this.appBarConfig={title:this.template.name,subtitle:this.template.description,menu:ke.default([$.add().setSubItems([$.text(()=>this.openSaveTextFieldComponent()),$.barcode(()=>this.openSaveBarcodeFieldComponent()),$.image(()=>this.openSaveImageFieldComponent()),$.line(()=>this.openSaveLineFieldComponent())]).setTitle(),$.menu([$.settings(this.openSettingsComponent.bind(this)),$.divider(),$.reset(this.openResetComponent.bind(this))])])},this.templateDef=this.template.content??{fields:[],margins:{top:0,right:0,bottom:0,left:0}};}openSettingsComponent(){this.dialog.open(_t,{data:this.templateDef}).afterClosed().subscribe(t=>{t&&(this.templateDef=t,this.save());});}openResetComponent(){this.dialog.open(We,{data:{message:re.reset_template}}).afterClosed().subscribe(t=>{t&&(this.templateDef=this.template.baseTemplate.content??{fields:[],margins:{top:0,right:0,bottom:0,left:0}},this.save());});}drop(t,e){if(!t.distance)return;let i=e.x+q.round2Decimals(g.fromPixel(this.size.unit,t.distance.x)),o=e.y+q.round2Decimals(g.fromPixel(this.size.unit,t.distance.y)),s=q.round2Decimals(g.fromPixel(this.size.unit,t.source.element.nativeElement.offsetWidth)),E=q.round2Decimals(g.fromPixel(this.size.unit,t.source.element.nativeElement.offsetHeight));i<0?i=0:i+s>this.size.width&&(i=this.size.width-s),o<0?o=0:o+E>this.size.height&&(o=this.size.height-E),e.x=i,e.y=o,t.source._dragRef._initialTransform&&(t.source._dragRef._initialTransform=`translate3d(${g.toPixel(this.size.unit,i)}px, ${g.toPixel(this.size.unit,o)}px, 0)`),t.source._dragRef.reset(),this.fieldChanged(e);}getTemplateStyle(){return`width: ${this.size.width}${this.size.unit}; height: ${this.size.height}${this.size.unit}; position: relative;`;}getMarginsStyle(){return`position: absolute; 
    top: ${this.templateDef.margins.top}${this.size.unit}; 
    right: ${this.templateDef.margins.right}${this.size.unit}; 
    bottom: ${this.templateDef.margins.bottom}${this.size.unit}; 
    left: ${this.templateDef.margins.left}${this.size.unit};
    border: 1px dotted black;
    `;}getFieldStyle(t){let e=`translate3d(${g.toPixel(this.size.unit,t.x)}px, ${g.toPixel(this.size.unit,t.y)}px, 0)`;switch(t.type){case"text":{let i=t;return`position: absolute; transform: ${e}; font-size: ${i.fontSize}px; color: ${i.fontColor}; text-align: ${i.textAlign};`;}case"image":{let i=t;return`position: absolute; transform: ${e}; width: ${i.width}${this.size.unit}; height: ${i.height}${this.size.unit};`;}case"barcode":{let i=t;return`position: absolute; transform: ${e}; width: ${i.width}${this.size.unit}; height: ${i.height}${this.size.unit};`;}case"table":{let i=t;return`position: absolute; transform: ${e};width:${i.x2-i.x};`;}case"line":return"position: absolute;";}return"";}openFieldSettingsComponent(t){switch(t.type){case"text":this.openSaveTextFieldComponent(t);break;case"barcode":this.openSaveBarcodeFieldComponent(t);break;case"image":this.openSaveImageFieldComponent(t);break;case"line":this.openSaveLineFieldComponent(t);break;}}fieldRightClick(t,e){t.preventDefault(),this.contextMenuPosition.x=t.clientX+"px",this.contextMenuPosition.y=t.clientY+"px",this.menuTrigger.menuData={field:e},this.menuTrigger.openMenu();}openFieldDeleteComponent(t){this.dialog.open(je,{data:{message:He.delete,data:t}}).afterClosed().subscribe(e=>{e&&this.fieldDeleted(t);});}openSaveTextFieldComponent(t){this.dialog.open(mt,{data:t}).afterClosed().subscribe(e=>{e&&this.fieldChanged(e);});}openSaveBarcodeFieldComponent(t){this.dialog.open(lt,{data:t}).afterClosed().subscribe(e=>{e&&this.fieldChanged(e);});}openSaveImageFieldComponent(t){this.dialog.open(at,{data:t}).afterClosed().subscribe(e=>{e&&this.fieldChanged(e);});}openSaveLineFieldComponent(t){this.dialog.open(st,{data:t}).afterClosed().subscribe(e=>{e&&this.fieldChanged(e);});}fieldChanged(t){let e=this.templateDef.fields.findIndex(i=>i.id===t.id);e!==-1?this.templateDef.fields[e]=t:this.templateDef.fields.push(t),this.save();}fieldDeleted(t){this.templateDef.fields=this.templateDef.fields.filter(e=>e.id!==t.id),this.save();}save(){this.srptService.templates.update(this.template.id,ge(ce({},this.template),{content:this.templateDef})).subscribe(()=>{this.snackBar.open(re.saved,re.close,{duration:5e3});});}};n.ɵfac=function(e){return new(e||n)();},n.ɵcmp=M({type:n,selectors:[["sz-mgmt-reporting-template"]],viewQuery:function(e,i){if(e&1&&(J(pt,5),J(Q,5)),e&2){let o;Z(o=ee())&&(i.designerEl=o.first),Z(o=ee())&&(i.menuTrigger=o.first);}},standalone:!0,features:[T([te]),S],decls:12,vars:10,consts:()=>{let t;t="\u062A\u0639\u062F\u064A\u0644";let e;return e="\u062D\u0630\u0641",[["designer",""],["menuTrigger","matMenu"],t,e,[3,"config"],[3,"alert"],[1,"container"],["dir","ltr",1,"designer"],[3,"style"],["cdkDrag","","cdkDragBoundary",".designer",2,"position","absolute",3,"field","style"],[2,"visibility","hidden","position","fixed",3,"matMenuTriggerFor"],["matMenuContent",""],["cdkDrag","","cdkDragBoundary",".designer",2,"position","absolute",3,"cdkDragEnded","dblclick","contextmenu","field"],["mat-menu-item","",3,"click"]];},template:function(e,i){if(e&1&&(a(0,"sz-ui-app-bar",4)(1,"sz-ui-alert",5),m(2,"div",6)(3,"div",7,0),ue(5,ft,1,2,"div",8),Re(6,ut,1,3,"sz-mgmt-reporting-template-field",9,De),a(8,"div",10),m(9,"mat-menu",null,1),ue(11,Et,11,0,"ng-template",11),p()()()),e&2){let o=Pe(10);d("config",i.appBarConfig),f(),d("alert",i.alert()),f(2),ie(i.getTemplateStyle()),f(2),Le(i.templateDef.margins?5:-1),f(),Ae(i.templateDef.fields),f(2),Ie("left",i.contextMenuPosition.x)("top",i.contextMenuPosition.y),d("matMenuTriggerFor",o);}},dependencies:[c,ye,ne,Ve,xe,Je,Ke,Ze,Qe,oe,$e,le,qe,Ue,Xe,Q,rt,Be],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}.designer[_ngcontent-%COMP%]{border:1px solid #c3c3c3;background-color:#fff;position:relative}table[_ngcontent-%COMP%]{font-family:arial,sans-serif;border-collapse:collapse}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{border:1px solid #dddddd;text-align:left}"]});let l=n;return l;})();var Io=[{path:"",component:dt}];export{Io as default};/**i18n:88fff6855ba28d4c8b98104a25523cf265e1264225a6f202fed27e9c25681d21*/