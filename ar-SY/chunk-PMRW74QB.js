import{c}from"./chunk-F7MEOHHL.js";import{c as te,d as ie,e as _,h as oe,i as re,j as ae}from"./chunk-F32ZABI3.js";import"./chunk-4DCDCHB6.js";import"./chunk-PWRCXTHR.js";import"./chunk-K5UGIYX3.js";import{c as Q,g as W,h as Y,i as Z,k as x,l as ee}from"./chunk-ZQB4NDVO.js";import{a as $,b as V,d as w,e as j,g as q}from"./chunk-FURDGHLT.js";import"./chunk-TDPUDKXE.js";import"./chunk-7LV3YXIE.js";import"./chunk-PI7SXNAH.js";import"./chunk-TWY5RYOX.js";import{b as X,i as k,k as J,l as K}from"./chunk-376VVTQV.js";import{d as O,f as A,g as y,l as F,o as I,r as R,s as U,u as P}from"./chunk-AHXH4DOS.js";import{b as g,c as h}from"./chunk-23FA5564.js";import"./chunk-AYZ3P7GD.js";import"./chunk-OLNJCPIA.js";import"./chunk-UNNL7KWU.js";import"./chunk-PUAS3BAZ.js";import{s as L}from"./chunk-JXMVGGLE.js";import"./chunk-KC3OOHS3.js";import"./chunk-RLAIQ2FO.js";import{Ba as B,Ma as H}from"./chunk-P6NOJIJ3.js";import{Fb as D,Hb as v,Ia as C,Ib as G,Jb as u,Kb as p,Lb as f,Vb as z,Wb as S,bb as m,gc as T,hc as E,ja as a,mb as b,mc as N,na as l,nc as d,yb as n}from"./chunk-YQNBR3H5.js";import"./chunk-NFTRFLMQ.js";function me(r,t){if(r&1&&(u(0,"mat-option",4),T(1),p()),r&2){let M=t.$implicit;n("value",M.id),m(),E(M.name);}}var ne=(()=>{let t=class t extends W{constructor(){super(a($)),this.accessManagementService=a(c),this.fb=a(U),this.user=a(V),this.groups=[];let e=this.fb;this.form=e.group({groupId:[null,[O.required]]}),this.getGroups();}flattenGroups(e){let i=[];function o(s){i.push({id:s.id,name:s.name,path:s.path,subGroups:[]}),s.subGroups&&s.subGroups.forEach(o);}return e.forEach(o),i;}getGroups(){this.accessManagementService.getGroups().subscribe(e=>{this.groups=this.flattenGroups(e);});}submit(){this.IsValid()&&this.accessManagementService.addUserGroup(this.user.id,this.form.value.groupId).subscribe(()=>{this.dialogRef.close(!0);});}};t.ɵfac=function(i){return new(i||t)();},t.ɵcmp=l({type:t,selectors:[["sz-iam-users-user-group-add"]],standalone:!0,features:[b,d],decls:10,vars:5,consts:()=>{let e;return e="\u0627\u0644\u0645\u062C\u0645\u0648\u0639\u0627\u062A",[e,[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","groupId"],[3,"value"],[3,"actions"]];},template:function(i,o){i&1&&(f(0,"sz-ui-dialog-header",1),u(1,"mat-dialog-content")(2,"form",2)(3,"mat-form-field")(4,"mat-label"),z(5,0),p(),u(6,"mat-select",3),v(7,me,2,2,"mat-option",4,D),p()()()(),f(9,"sz-ui-dialog-actions",5)),i&2&&(n("title",o.title)("subtitle",o.subtitle)("alert",o.alert()),m(2),n("formGroup",o.form),m(5),G(o.groups),m(2),n("actions",o.actions));},dependencies:[P,F,A,y,I,R,q,j,ee,Y,Z,K,k,X,J,B],encapsulation:2});let r=t;return r;})();var Pe=(()=>{let t=class t{constructor(){this.dialog=a(w),this.adminService=a(c),this.user=C.required(),this.dataSource=new oe(),this.appBarConfig={title:"Groups",menu:h.default([g.add(this.openAddComponent.bind(this))])},this.dataSource.columnDefs.push(_.string("name").setValueGetter(e=>e.name),_.menu(h.more([g.delete(e=>this.openDeleteComponent(e))])));}ngOnInit(){this.get();}openDeleteComponent(e){this.dialog.open(x,{data:Q.delete(this.adminService.deleteUserGroup(this.user().id,e.id),e)}).afterClosed().subscribe(i=>{this.dataSource.delete(i);});}openAddComponent(){this.dialog.open(ne,{data:this.user()}).afterClosed().subscribe(e=>{e&&this.get();});}get(){this.adminService.getUserGroups(this.user().id).pipe(re(this.dataSource.state)).subscribe(e=>{this.dataSource.set(e,e.length);});}};t.ɵfac=function(i){return new(i||t)();},t.ɵcmp=l({type:t,selectors:[["sz-iam-users-user-groups"]],inputs:{user:[1,"user"]},standalone:!0,features:[N([]),d],decls:2,vars:3,consts:[[3,"changed","config","dataSource"],[3,"update","dataSource"]],template:function(i,o){i&1&&(u(0,"sz-ui-table-bar",0),S("changed",function(){return o.get();}),p(),u(1,"sz-ui-table",1),S("update",function(){return o.get();}),p()),i&2&&(n("config",o.appBarConfig)("dataSource",o.dataSource),m(),n("dataSource",o.dataSource));},dependencies:[L,ae,ie,te,H],encapsulation:2});let r=t;return r;})();export{Pe as UserGroupsComponent};/**i18n:4496faec5fdb532a79a61dee9b0e39fe2c3a8394fb36deafb49598fafb3bf39e*/