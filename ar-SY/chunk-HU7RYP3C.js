import{a as Fe}from"./chunk-TXRHKTMR.js";import{a as Oe,c as Re,d as Le,e as ve,f as ze}from"./chunk-TIDOZCHS.js";import{a as c}from"./chunk-GG4TDHI7.js";import{d as be,f as ge,g as Ie,j as Me}from"./chunk-XPEER3MI.js";import{a as te,b as oe,e as ie,g as re}from"./chunk-RYPJGNS7.js";import{a as ce,b as _e,e as ue,f as fe,g as Se,h as Ce,r as Ee,s as Ae}from"./chunk-OZYWWEF2.js";import{c as Te,d as ye}from"./chunk-CVLOUW53.js";import{b as de}from"./chunk-624ACHJE.js";import{a as me,b as pe}from"./chunk-NKOEFEWM.js";import{c as he}from"./chunk-GIY3I2EY.js";import{a as ne,b as ae,h as se,i as le}from"./chunk-T6JZHMHL.js";import{b as $,d as H,e as G,f as R,g as q,k as j,l as X,m as k,p as W,q as K,t as L}from"./chunk-6EYFULIN.js";import{t as U}from"./chunk-PTMK2T5I.js";import{$ as J,ca as Q,ga as Z,ha as ee}from"./chunk-7YAHW23C.js";import{Da as h,Db as m,Ea as C,Ib as _,Kb as v,Lb as z,Ma as x,Mb as F,Nb as l,Ob as s,Pb as u,Sc as w,Tb as g,Zb as D,_b as S,a as N,ac as p,b as B,hb as n,ib as d,ic as I,jc as E,kc as V,lc as Y,pc as M,qc as O,ta as P,ua as A,ub as b,zb as f}from"./chunk-XXEHGU7A.js";function xe(o,r){if(o&1){let a=g();l(0,"mat-chip-row",10),S("removed",function(){let i=h(a).$implicit,t=p(2);return C(t.removeSelection(i));}),E(1),l(2,"button",11)(3,"mat-icon"),E(4,"cancel"),s()()();}if(o&2){let a=r.$implicit,e=p(2);n(),Y(" ",e.getSelectionFormat(a)," ");}}function Ve(o,r){if(o&1){let a=g();l(0,"mat-chip-grid",null,1),z(2,xe,5,1,"mat-chip-row",null,v),s(),l(4,"input",9,2),S("matChipInputTokenEnd",function(){h(a);let i=p();return C(i.addSelection());}),s();}if(o&2){let a=I(1),e=p(),i=I(7);n(2),F(e.selections),n(2),m("matAutocomplete",i)("formControl",e.control)("matChipInputFor",a)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes);}}function we(o,r){if(o&1&&u(0,"input",12,2),o&2){let a=p(),e=I(7);m("matAutocomplete",e)("formControl",a.control);}}function $e(o,r){if(o&1&&(l(0,"mat-option",7),E(1),s()),o&2){let a=r.$implicit,e=p();m("value",e.getOptionValue(a)),n(),Y(" ",e.getOptionContent(a)," ");}}function He(o,r){o&1&&(l(0,"mat-error"),D(1,3),s());}function Ge(o,r){o&1&&(l(0,"mat-error"),D(1,4),s());}function qe(o,r){o&1&&u(0,"mat-progress-bar",8);}var De=(()=>{let r=class r extends Ce{get laboratoryId(){return this._laboratoryId;}set laboratoryId(e){e!==this._laboratoryId&&(this._laboratoryId=e,this.reset());}constructor(e,i){super(e),this.ngControl=e,this.mlatService=i,this.query=null,this.label=he.testType,this._laboratoryId="",this.filters=x([]),this.szOptionContentFn=t=>t.testType.name,this.szOptionValueFn=t=>t,this.szOptionFormatFn=t=>t?t.testType.name:"",w(()=>this.refresh(),{allowSignalWrites:!0});}ngOnInit(){this.control=this.ngControl.control,this.listenChanges();}ngOnDestroy(){this.subscriptions.unsubscribe();}listenChanges(){this.subscriptions.add(this.control.valueChanges.pipe(ye(400)).subscribe(e=>{e!==null&&this.handleValueChanged(e);}));}handleValueChanged(e){if(this.reset(),typeof e=="string")this.query=e;else if(typeof e=="object"&&e)return;this.fetch();}reset(){this.query=null,this.totalPages=-1,this.options=[];}fetch(){this.mlatService.laboratories.testTypes.get(this._laboratoryId,B(N({query:this.query},de.minimal()),{orderBy:["-isFavorite","testType.name"],filters:this.filters()})).pipe(Te(this.indicator)).subscribe(e=>{this.options.push(...e.items),this.totalPages=e.totalPages,this.afterSourceUpdated();});}};r.ɵfac=function(i){return new(i||r)(d(G,10),d(c));},r.ɵcmp=A({type:r,selectors:[["sz-medisy-laboratory-laboratory-test-type-search"]],inputs:{query:"query",laboratoryId:"laboratoryId",filters:[P.SignalBased,"filters"]},standalone:!0,features:[M([c]),b,O],decls:13,vars:7,consts:()=>{let e;e="\u0647\u0630\u0627 \u0627\u0644\u062D\u0642\u0644 \u0645\u0637\u0644\u0648\u0628";let i;return i="\u0647\u0630\u0627 \u0627\u0644\u062D\u0642\u0644 \u063A\u064A\u0631 \u0635\u062D\u064A\u062D",[["auto","matAutocomplete"],["chipGrid",""],["input",""],e,i,[1,"container"],[3,"optionSelected","szScrolled","displayWith","szScrollIgnored"],[3,"value"],["mode","indeterminate"],["matInput","",3,"matChipInputTokenEnd","matAutocomplete","formControl","matChipInputFor","matChipInputSeparatorKeyCodes"],[3,"removed"],["matChipRemove",""],["matInput","",3,"matAutocomplete","formControl"]];},template:function(i,t){if(i&1){let T=g();l(0,"div",5)(1,"mat-form-field")(2,"mat-label"),E(3),s(),f(4,Ve,6,4)(5,we,2,2),l(6,"mat-autocomplete",6,0),S("optionSelected",function(Ye){return h(T),C(t.optionSelected(Ye));})("szScrolled",function(){return h(T),C(t.scroll());}),z(8,$e,2,2,"mat-option",7,v),s(),f(10,He,2,0,"mat-error")(11,Ge,2,0,"mat-error"),s(),f(12,qe,1,0,"mat-progress-bar",8),s();}i&2&&(n(3),V(t.label),n(),_(4,t.multiple?4:5),n(2),m("displayWith",t.szOptionFormatFn)("szScrollIgnored",t.indicator()),n(2),F(t.options),n(2),_(10,t.control.hasError("required")?10:-1),n(),_(11,t.control.hasError("invalid")?11:-1),n(),_(12,t.indicator()?12:-1));},dependencies:[L,$,R,X,le,se,ne,ae,Se,ue,J,fe,pe,me,_e,ce,Q,ze,Le,ve,Oe,Re,ee,Z,Ee],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]{position:relative}mat-progress-bar[_ngcontent-%COMP%]{position:absolute;bottom:20px}"]});let o=r;return o;})();function je(o,r){if(o&1&&u(0,"sz-ui-form-field-select",3),o&2){let a=p();m("source",a.laboratories);}}var Nt=(()=>{let r=class r extends be{constructor(e,i,t,T){super(i),this.fb=e,this.dialog=i,this.mlabService=t,this.data=T,this.laboratories=this.mlabService.laboratories.getAll({orderBy:["name"],filters:U.create().equal("id",this.data).filters()}),this.laboratoryOptionValueFn=y=>y,this.testTypesFilters=[],this.laboratoryId=this.data,this.form=e.group({transferOutLaboratoryId:[null,[]],testType:e.control(null,[H.required,Fe()])});}isTranferOutEnabled(){return this.form.value?.testType?.transferOutEnabled;}testTypeSelected(e){this.form.patchValue({transferOutLaboratoryId:e.transferOutLaboratoryId}),e.transferOutLaboratoryId?this.form.controls.transferOutLaboratoryId.disable():this.form.controls.transferOutLaboratoryId.enable();}submit(){this.IsValid()&&this.dialog.close({laboratoryTestType:this.form.value.testType,transferOutLaboratoryId:this.form.getRawValue().transferOutLaboratoryId});}};r.ɵfac=function(i){return new(i||r)(d(K),d(te),d(c),d(oe));},r.ɵcmp=A({type:r,selectors:[["sz-medisy-laboratory-analysis-test-type-add"]],standalone:!0,features:[M([c]),b,O],decls:6,vars:6,consts:()=>{let e;return e="\u0627\u0644\u0645\u062E\u0628\u0631 \u0627\u0644\u0645\u062D\u0648\u0644 \u0644\u0647",[[3,"header"],[1,"sz-form",3,"formGroup"],["formControlName","testType",3,"szOptionSelected","laboratoryId","filters"],["formControlName","transferOutLaboratoryId","label",e,3,"source"],[3,"actions"]];},template:function(i,t){i&1&&(u(0,"sz-ui-dialog-header",0),l(1,"mat-dialog-content")(2,"form",1)(3,"sz-medisy-laboratory-laboratory-test-type-search",2),S("szOptionSelected",function(y){return t.testTypeSelected(y);}),s(),f(4,je,1,1,"sz-ui-form-field-select",3),s()(),u(5,"sz-ui-dialog-actions",4)),i&2&&(m("header",t.header),n(2),m("formGroup",t.form),n(),m("laboratoryId",t.laboratoryId)("filters",t.testTypesFilters),n(),_(4,t.isTranferOutEnabled()?4:-1),n(),m("actions",t.actions));},dependencies:[L,j,R,q,k,W,re,ie,Me,ge,Ie,De,Ae],encapsulation:2});let o=r;return o;})();export{Nt as a};/**i18n:1c5a057012127d5b8d089498ac661b5227d0455136ea3b9f25a2d8940ec324d8*/