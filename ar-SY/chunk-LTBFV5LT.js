import{a as pe,b as me,c as ue,d as Me,e as fe}from"./chunk-P4FVNSVS.js";import{a as Se,b as Te,c as T,f as Ee,g as de,h as Oe}from"./chunk-YUC45UAG.js";import"./chunk-GPAES7OP.js";import"./chunk-DSJR6L5G.js";import"./chunk-XDEHVO3T.js";import{b as ae,f as ie,g as ne,h as se,j as _e,k as le}from"./chunk-LUZYQH3A.js";import{a as C}from"./chunk-AOV25AXW.js";import"./chunk-ODYGSBAJ.js";import{b as W}from"./chunk-QERRRZIA.js";import{a as w,b as j,d as H,e as Q,g as J}from"./chunk-MHLQ5ASK.js";import{c as Z,p as ee,q as N,r as te}from"./chunk-EMVR6TPU.js";import"./chunk-ZDS23LK5.js";import"./chunk-WX4XW32G.js";import"./chunk-Q4QLTUTU.js";import{d as m,f as $,g as z,l as F,n as G,q as U,r as X,t as k}from"./chunk-R425IBES.js";import{a as oe,b as O,c as re}from"./chunk-MFJGOIE4.js";import"./chunk-KPHZXQ4R.js";import"./chunk-53QS6UIR.js";import"./chunk-TM26YT7E.js";import{a as A}from"./chunk-XYHX3JVK.js";import"./chunk-FZND2MZR.js";import{p as q,s as x,v as R,x as c}from"./chunk-CVZW7JYW.js";import"./chunk-GBJNACNX.js";import"./chunk-IJWI4VMJ.js";import{La as K}from"./chunk-OKKKBEFN.js";import{G as v,Jb as n,Kb as a,Lb as E,Vb as d,Wb as y,bb as l,ja as _,mb as V,n as D,na as M,nc as f,yb as i}from"./chunk-K7VHIDZW.js";import{i as B}from"./chunk-VARUJZUG.js";var ce=S=>r=>r.pipe(v(u=>{let e="";if(u.error instanceof ErrorEvent)e=u.error.message;else if(u){let o=u;e=o.error.message??o.message??o.statusText,console.log(o.error.code);}return S.open(e,A.close),D(()=>e);}));var Ae=(()=>{let r=class r extends ie{constructor(){let e=_(w);super(e),this.mlabService=_(C),this.fb=_(X),this.data=_(j),this.testTypes=this.mlabService.testTypes.getAll({orderBy:["nameEn"],filterBehavior:R.Or,filters:c.create().equalIf("id",this.data.laboratoryTestType?.testTypeId).notAny("laboratories.laboratoryId",[this.data.laboratoryId]).filters()}),this.laboratories=this.mlabService.laboratories.getAll({orderBy:["name"],filters:c.create().notEqual("id",this.data.laboratoryId).filters()}),this.referenceValueSelectConfig={emptyOption:!0,autoSelect:!0,optionContentFn:p=>p.testType.nameEn},this.testTypeSelectConfig={optionSelectedFn:this.testTypeChnaged.bind(this)},this.transferOutLaboratorySelectConfig={emptyOption:!0},this.referenceValues=null;let o=this.fb;this.dialog=e;let t=this.data;this.form=o.group({enabled:[t.laboratoryTestType?.enabled??!0,[m.required]],transferInPrice:[t.laboratoryTestType?.transferInPrice??0,[]],transferInEnabled:[t.laboratoryTestType?.transferInEnabled??!0,[m.required]],transferOutEnabled:[t.laboratoryTestType?.transferOutEnabled??!0,[m.required]],transferOutLaboratoryId:[t.laboratoryTestType?.transferOutLaboratoryId,[]],price:[t.laboratoryTestType?.price??0,[]],isFavorite:[t.laboratoryTestType?.isFavorite??!1,[m.required]],testTypeId:[t.laboratoryTestType?.testTypeId,[m.required]],referenceValueId:[t.laboratoryTestType?.referenceValueId,[]]}),t.laboratoryTestType&&this.testTypeChnaged(t.laboratoryTestType.testTypeId);}testTypeChnaged(e){this.referenceValues=this.mlabService.referenceValues.getAll({orderBy:["testType.nameEn"],filterBehavior:R.And,filters:c.create().equalIf("testType.id",e).filters()});}submit(){this.IsValid()&&(this.data.laboratoryTestType?this.save(this.mlabService.laboratories.testTypes.update(this.data.laboratoryId,this.data.laboratoryTestType?.id,this.form.value)):this.save(this.mlabService.laboratories.testTypes.create(this.data.laboratoryId,this.form.value)));}};r.ɵfac=function(o){return new(o||r)();},r.ɵcmp=M({type:r,selectors:[["sz-medisy-laboratory-laboratory-test-types-save"]],standalone:!0,features:[V,f],decls:29,vars:13,consts:()=>{let e;e="\u0646\u0645\u0637 \u0627\u062E\u062A\u0628\u0627\u0631";let o;o="\u0627\u0644\u0642\u064A\u0645\u0629 \u0627\u0644\u0645\u0631\u062C\u0639\u064A\u0629";let t;t="\u0627\u0644\u0633\u0639\u0631";let p;p="\u0627\u0644\u0633\u0639\u0631";let b;b="\u0627\u0644\u0645\u062E\u0628\u0631";let g;g="\u0645\u0641\u0639\u0644";let L;L="\u0645\u0641\u0636\u0644\u0629";let I;I="\u062A\u062D\u0648\u064A\u0644 \u0625\u0644\u0649";let h;h="\u0645\u0641\u0639\u0644";let P;P="\u062A\u062D\u0648\u064A\u0644 \u0644\u0644\u062E\u0627\u0631\u062C";let Y;return Y="\u0645\u0641\u0639\u0644",[g,L,I,h,P,Y,[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","testTypeId","label",e,3,"source","config"],["formControlName","referenceValueId","label",o,3,"source","config"],[1,"sz-form-row"],["formControlName","enabled"],["formControlName","isFavorite"],["formControlName","price","label",t,3,"type"],["multi","",1,"tw-mb-4"],["formControlName","transferInEnabled"],["formControlName","transferInPrice","label",p,3,"type"],["formControlName","transferOutEnabled"],["formControlName","transferOutLaboratoryId","label",b,3,"source","config"],[3,"actions"]];},template:function(o,t){o&1&&(E(0,"sz-ui-dialog-header",6),n(1,"mat-dialog-content")(2,"form",7),E(3,"sz-ui-form-field-select",8)(4,"sz-ui-form-field-select",9),n(5,"div",10)(6,"mat-checkbox",11),d(7,0),a(),n(8,"mat-checkbox",12),d(9,1),a()(),n(10,"div",10),E(11,"sz-ui-form-field-input",13),a(),E(12,"div",10),n(13,"mat-accordion",14)(14,"mat-expansion-panel")(15,"mat-expansion-panel-header")(16,"mat-panel-title"),d(17,2),a()(),n(18,"mat-checkbox",15),d(19,3),a(),E(20,"sz-ui-form-field-input",16),a(),n(21,"mat-expansion-panel")(22,"mat-expansion-panel-header")(23,"mat-panel-title"),d(24,4),a()(),n(25,"mat-checkbox",17),d(26,5),a(),E(27,"sz-ui-form-field-select",18),a()()()(),E(28,"sz-ui-dialog-actions",19)),o&2&&(i("title",t.title)("subtitle",t.subtitle)("alert",t.alert()),l(2),i("formGroup",t.form),l(),i("source",t.testTypes)("config",t.testTypeSelectConfig),l(),i("source",t.referenceValues)("config",t.referenceValueSelectConfig),l(7),i("type","number"),l(9),i("type","number"),l(7),i("source",t.laboratories)("config",t.transferOutLaboratorySelectConfig),l(),i("actions",t.actions));},dependencies:[k,F,$,z,G,U,le,ne,se,J,Q,N,ee,fe,Me,pe,me,ue,Z,te],encapsulation:2});let S=r;return S;})();var St=(()=>{let r=class r{constructor(){this.dialog=_(H),this.mlabService=_(C),this.route=_(q),this.snackbar=_(W),this.dataSource=new Ee("testType.nameEn"),this.laboratory=this.route.snapshot.data.laboratory,this.appBarConfig={title:A.test_types,subtitle:this.laboratory.name,backEnabled:!0,menu:re.default().setItems([O.add(this.openSaveComponent.bind(this)),O.menu([O.search()])])},this.dataSource.columnDefs.push(T.uuid("id"),T.uuid("testTypeId"),T.icon("isFavorite").setValueGetter(oe.star).setValueStyle(e=>e.isFavorite?"font-variation-settings: 'FILL' 1":"font-variation-settings: 'FILL' 0").addClassClickable().setClickFn(e=>{e.isFavorite=!e.isFavorite,this.updateItem(e);}).setResponsive(!0),T.string("testType.nameEn"),T.date("createdAt").setResponsive(!0),T.date("updatedAt").setVisible(!1),T.boolean("enabled").setChangeFn((e,o)=>B(this,null,function*(){e.enabled=o,this.updateItem(e);})).setResponsive(!0),T.menu([O.edit(this.openSaveComponent.bind(this)),O.divider(),O.delete(this.openLaboratoryTestTypeDeleteComponent.bind(this))])),this.get();}openSaveComponent(e){this.dialog.open(Ae,{data:{laboratoryId:this.laboratory.id,laboratoryTestType:e}}).afterClosed().subscribe(o=>{this.dataSource.addOrUpdateItem(o);});}openLaboratoryTestTypeDeleteComponent(e){this.dialog.open(_e,{data:ae.delete(this.mlabService.laboratories.testTypes.delete(e.laboratoryId,e.id),e)}).afterClosed().subscribe(o=>{this.dataSource.delete(o);});}updateItem(e){this.mlabService.laboratories.testTypes.update(e.laboratoryId,e.id,e).pipe(ce(this.snackbar)).subscribe(o=>{this.dataSource.update(o);});}get(){this.mlabService.laboratories.testTypes.get(this.laboratory.id,this.dataSource.getQuery()).pipe(de(this.dataSource.state)).subscribe(e=>{this.dataSource.set(e.items,e.count);});}};r.ɵfac=function(o){return new(o||r)();},r.ɵcmp=M({type:r,selectors:[["sz-medisy-laboratory-laboratory-test-types"]],standalone:!0,features:[f],decls:2,vars:3,consts:[[3,"changed","config","dataSource"],[3,"update","dataSource"]],template:function(o,t){o&1&&(n(0,"sz-ui-table-bar",0),y("changed",function(){return t.get();}),a(),n(1,"sz-ui-table",1),y("update",function(){return t.get();}),a()),o&2&&(i("config",t.appBarConfig)("dataSource",t.dataSource),l(),i("dataSource",t.dataSource));},dependencies:[x,Oe,Te,Se,N,K],encapsulation:2});let S=r;return S;})();export{St as LaboratoryTestTypesComponent};/**i18n:7274145596894140ce8dc809ecf6b222e8bea6098fe1553d5bf6245265c46bf4*/