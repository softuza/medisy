import{a as M}from"./chunk-QODWAO26.js";import{a as Re}from"./chunk-EYOAPD5J.js";import{a as Ce}from"./chunk-KTVRGAGG.js";import{a as m,d as he,e as Le,f as Ie,i as ve,j as b}from"./chunk-SBT2HQEK.js";import"./chunk-X6VBMNJ2.js";import"./chunk-5C5WSMNK.js";import{a as f}from"./chunk-IUJYLG7X.js";import"./chunk-LRDLJVBZ.js";import{b as Ne,f as Te,g as ge,h as Ve,j as Ae,k as v}from"./chunk-CA22MQET.js";import{a as I}from"./chunk-DPXACLS5.js";import{d as Me,j as u,k as Oe}from"./chunk-PFHXPQGV.js";import{a as ie,b as ne,d as A,e as ae,g as h}from"./chunk-5PZUP35D.js";import{a as _e,b as ce,q as L,r as fe,s as Se,t as Ee}from"./chunk-2W3NGOE3.js";import"./chunk-UEB44RWK.js";import"./chunk-SESM2AVP.js";import"./chunk-FP5MMWA5.js";import"./chunk-IDXAQSNX.js";import{h as le,i as se,k as me}from"./chunk-BNO7PVLL.js";import{b as X,d as g,f as j,g as k,k as q,l as H,n as W,q as Q,r as J,t as K,u as Z}from"./chunk-DVVRYZHF.js";import{Y as pe,Z as de,r as te,t as oe}from"./chunk-UYLGN5KQ.js";import{a as V,e as ee}from"./chunk-66ZH2AKO.js";import"./chunk-M2MCGKGK.js";import{ia as re,la as ue}from"./chunk-U3QD6NNV.js";import"./chunk-EKJLBWRM.js";import{Fb as N,Kb as p,Lb as d,Mb as l,Xb as D,Zb as z,bb as s,cb as O,ea as Y,f as G,ja as c,na as E,nc as C,oa as w,oc as T,qb as x,vb as y,zb as a}from"./chunk-WVA7UUYP.js";import{c as $}from"./chunk-QRHOBZKE.js";function De(r,e){if(r&1&&l(0,"sz-ui-form-field-select",4),r&2){let R=z();a("source",R.testTypeResultOptions);}}function ze(r,e){r&1&&(p(0,"div",7)(1,"mat-form-field",8)(2,"label"),l(3,"input",9),d()(),p(4,"mat-form-field",8)(5,"label"),l(6,"input",10),d()()());}function Be(r,e){r&1&&(p(0,"mat-form-field",8)(1,"label"),l(2,"input",11),d()());}function Pe(r,e){if(r&1&&y(0,ze,7,0,"div",7)(1,Be,3,0,"mat-form-field",8),r&2){let R=z();N(R.isRange()?0:-1),s(),N(R.isRange()?-1:1);}}var be=(()=>{let e=class e extends Te{constructor(t,o,i,n){super(i),this.mlabService=t,this.fb=o,this.dialog=i,this.data=n,this.referenceGroups=this.mlabService.referenceGroups.getAll({orderBy:["nameEn"],filterBehavior:te.Or,filters:oe.create().equalIf("id",this.data.referenceValueRule?.referenceGroupId).notAny("referenceValueRules.referenceValueId",[this.data.referenceValue.id]).filters()}),this.testTypeResultOptions=this.mlabService.testTypes.resultOptions.getAll(this.data.referenceValue.testTypeId,{orderBy:["nameEn"]}),this.comparisonOperators=Object.keys(M).map(_=>M[_]),this.form=o.group({description:[n.referenceValueRule?.description,[g.maxLength(4096)]],comparisonOperator:new q(n.referenceValueRule?.comparisonOperator??M.Equal,[g.required]),referenceGroupId:[n.referenceValueRule?.referenceGroupId,[g.required]],value:[n.referenceValueRule?.value,[]],start:[n.referenceValueRule?.start,[]],end:[n.referenceValueRule?.end,[]],testTypeResultOptionId:[n.referenceValueRule?.testTypeResultOptionId,[]]});}isRange(){return this.form.value.comparisonOperator===M.RangeWithBoundaries||this.form.value.comparisonOperator===M.RangeWithoutBoundaries;}submit(){this.IsValid()&&(this.data.referenceValueRuleId?this.save(this.mlabService.referenceValues.rules.update(this.data.referenceValue.id,this.data.referenceValueRuleId,this.form.value)):this.save(this.mlabService.referenceValues.rules.create(this.data.referenceValue.id,this.form.value)));}};e.ɵfac=function(o){return new(o||e)(O(f),O(J),O(ie),O(ne));},e.ɵcmp=E({type:e,selectors:[["sz-medisy-laboratory-reference-value-rules-save"]],standalone:!0,features:[C([]),x,T],decls:9,vars:9,consts:()=>{let t;t="\u0627\u0644\u0641\u0626\u0629 \u0627\u0644\u0645\u0631\u062C\u0639\u064A\u0629";let o;o="\u0627\u0644\u0639\u0645\u0644\u064A\u0629";let i;i="\u0642\u064A\u0645\u0629";let n;n="\u0627\u0644\u0648\u0635\u0641";let _;_="\u0628\u062F\u0627\u064A\u0629";let F;F="\u0646\u0647\u0627\u064A\u0629";let U;return U="\u0642\u064A\u0645\u0629",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","referenceGroupId","label",t,3,"source"],["formControlName","comparisonOperator","label",o,3,"source","localizedValue"],["formControlName","testTypeResultOptionId","label",i,3,"source"],["formControlName","description","label",n],[3,"actions"],[1,"tw-flex","md:tw-flex-row","tw-flex-col","md:tw-gap-4"],[1,"tw-flex-1"],["autocomplete","off","formControlName","start","matInput","","placeholder",_],["autocomplete","off","formControlName","end","matInput","","placeholder",F],["autocomplete","off","formControlName","value","matInput","","placeholder",U]];},template:function(o,i){o&1&&(l(0,"sz-ui-dialog-header",0),p(1,"mat-dialog-content")(2,"form",1),l(3,"sz-ui-form-field-select",2)(4,"sz-ui-form-field-select",3),y(5,De,1,1,"sz-ui-form-field-select",4)(6,Pe,2,2),l(7,"sz-ui-form-field-textarea",5),d()(),l(8,"sz-ui-dialog-actions",6)),o&2&&(a("title",i.title)("subtitle",i.subtitle)("alert",i.alert()),s(2),a("formGroup",i.form),s(),a("source",i.referenceGroups),s(),a("source",i.comparisonOperators)("localizedValue",!0),s(),N(i.data.referenceValue.testType.hasResultOptions?5:6),s(3),a("actions",i.actions));},dependencies:[Z,H,X,j,k,W,Q,ce,_e,le,h,ae,se,L,v,ge,Ve,Ee,Se,fe],encapsulation:2});let r=e;return r;})();var P=(()=>{let e=class e{constructor(){this.dialog=c(A),this.mlabService=c(f),this.route=c(V),this.dataSource=new he(),this.referenceValue=this.route.snapshot.data.referenceValue,this.appBarConfig={title:pe.rules,subtitle:this.referenceValue.testType.nameEn,backEnabled:!0,backUrl:`/${Ce.ReferenceValues}`,menu:Oe.default().setItems([u.add(this.openSaveComponent.bind(this)),u.menu([u.search(),u.filter()])])},this.dataSource.columnDefs.push(m.uuid("id"),m.string("referenceGroup.nameEn").setValueClassFontBold().setStacked(m.string("referenceGroup.description").setStyleSmall()),m.enum("comparisonOperator").setValueGetter(t=>de(t.comparisonOperator)),m.number("_value").setValueGetter(t=>t.testTypeResultOption?t.testTypeResultOption.nameEn:t.value!==null?t.value:`${t.start} - ${t.end}`).setHeaderSortable(!1),m.date("createdAt").setVisible(!1),m.date("updatedAt").setVisible(!1),m.menu([u.edit(this.openSaveComponent.bind(this)),u.clone(t=>{let _=t,{id:o,referenceGroupId:i}=_,n=$(_,["id","referenceGroupId"]);this.openSaveComponent(n);}),u.divider(),u.delete(this.openReferenceValueRuleDeleteComponent.bind(this))]));}ngOnInit(){this.get();}openSaveComponent(t){this.dialog.open(be,{data:{referenceValue:this.referenceValue,referenceValueRule:t,referenceValueRuleId:t?.id}}).afterClosed().subscribe(o=>{this.dataSource.addOrUpdateItem(o);});}openReferenceValueRuleDeleteComponent(t){this.dialog.open(Ae,{data:Ne.delete(this.mlabService.referenceValues.rules.delete(t.referenceValueId,t.id),t)}).afterClosed().subscribe(o=>{this.dataSource.delete(o);});}get(){this.mlabService.referenceValues.rules.get(this.referenceValue.id,this.dataSource.getQuery()).pipe(Le(this.dataSource.state)).subscribe(t=>{this.dataSource.set(t.items,t.count);});}};e.ɵfac=function(o){return new(o||e)();},e.ɵcmp=E({type:e,selectors:[["sz-medisy-laboratory-reference-value-rules"]],standalone:!0,features:[C([f]),T],decls:2,vars:3,consts:[[3,"changed","config","dataSource"],["content","",3,"update","dataSource"]],template:function(o,i){o&1&&(p(0,"sz-ui-table-bar",0),D("changed",function(){return i.get();}),d(),p(1,"sz-ui-table",1),D("update",function(){return i.get();}),d()),o&2&&(a("config",i.appBarConfig)("dataSource",i.dataSource),s(),a("dataSource",i.dataSource));},dependencies:[b,ve,Ie],encapsulation:2});let r=e;return r;})();var ye=(()=>{let e=class e{constructor(){this.dialog=c(A),this.route=c(V),this.alert$=new G(),this.referenceValue=this.route.snapshot.data.referenceValue,this.appBarConfig={title:this.referenceValue.testType.nameEn,subtitle:this.referenceValue.description,backEnabled:!0};}};e.ɵfac=function(o){return new(o||e)();},e.ɵcmp=E({type:e,selectors:[["sz-medisy-laboratory-reference-value"]],features:[C([])],decls:1,vars:1,consts:[[3,"config"]],template:function(o,i){o&1&&l(0,"sz-ui-app-bar",0),o&2&&a("config",i.appBarConfig);},dependencies:[I],encapsulation:2});let r=e;return r;})();var Ht=(()=>{let e=class e{};e.ɵfac=function(o){return new(o||e)();},e.ɵmod=w({type:e}),e.ɵinj=Y({providers:[f],imports:[K,ee.forChild([{path:"",component:ye},{path:"rules",component:P}]),h,L,Me,re,ue,me,b,Re,v,I,P]});let r=e;return r;})();export{Ht as ReferenceValueModule};/**i18n:c9e15842f10b1052d55bdcedea67c6fd1ddab180b3eed8257f2e03ab0ad2f031*/