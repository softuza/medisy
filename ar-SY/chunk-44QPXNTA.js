import{p as N}from"./chunk-ZZK427TV.js";import{$ as U,Ac as _,C as T,Ca as B,Cc as M,D as d,E as f,K as p,M as F,Na as C,Oc as G,Qc as H,S as L,Y as E,da as b,ea as j,f as A,ga as W,ia as S,ib as K,m,n as D,oa as V,ob as Z,ra as x,s as l,w as k,x as I,z as O}from"./chunk-3KG4VHVC.js";import{a as h,b as R}from"./chunk-B3HEJ5KY.js";var y=class{constructor(){this.stateLocation="@state",this.state=Z({})}select(e){return G(()=>this.state()[e])}pmutate(e,s){this.state.update(t=>R(h({},t),{[e]:s}))}mutate(e){this.state.update(s=>h(h({},s),e))}set(e){this.state.set(e)}get(){return this.state}load(){let e=localStorage.getItem(this.stateLocation);if(!e)return null;try{let s=JSON.parse(e);return this.set(s),s}catch{return null}}save(e){localStorage.setItem(this.stateLocation,JSON.stringify(e))}listen(){H(()=>{this.save(this.state())})}};var ae=(()=>{let e=class e extends y{constructor(){super(),this.stateLocation="@appState",this.init(),this.listen()}init(){this.load()||this.set({header:{title:"Dashboard"},sidebar:{visible:!0},theme:{selector:void 0}})}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=b({token:e,factory:e.\u0275fac});let r=e;return r})();var w="Service workers are disabled or not supported by this browser";function X(r){return I(()=>D(new Error(r)))}var g=class{constructor(e){if(this.serviceWorker=e,!e)this.worker=this.events=this.registration=X(w);else{let t=O(e,"controllerchange").pipe(l(()=>e.controller)),n=I(()=>m(e.controller)),i=k(n,t);this.worker=i.pipe(f(u=>!!u)),this.registration=this.worker.pipe(E(()=>e.getRegistration()));let P=O(e,"message").pipe(l(u=>u.data)).pipe(f(u=>u&&u.type)).pipe(L());P.connect(),this.events=P}}postMessage(e,s){return this.worker.pipe(p(1),U(t=>{t.postMessage(h({action:e},s))})).toPromise().then(()=>{})}postMessageWithOperation(e,s,t){let n=this.waitForOperationCompleted(t),i=this.postMessage(e,s);return Promise.all([i,n]).then(([,a])=>a)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(e){let s;return typeof e=="string"?s=t=>t.type===e:s=t=>e.includes(t.type),this.events.pipe(f(s))}nextEventOfType(e){return this.eventsOfType(e).pipe(p(1))}waitForOperationCompleted(e){return this.eventsOfType("OPERATION_COMPLETED").pipe(f(s=>s.nonce===e),p(1),l(s=>{if(s.result!==void 0)return s.result;throw new Error(s.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}},z=(()=>{let e=class e{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,this.pushManager=null,this.subscriptionChanges=new A,!t.isEnabled){this.messages=d,this.notificationClicks=d,this.subscription=d;return}this.messages=this.sw.eventsOfType("PUSH").pipe(l(i=>i.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(l(i=>i.data)),this.pushManager=this.sw.registration.pipe(l(i=>i.pushManager));let n=this.pushManager.pipe(E(i=>i.getSubscription()));this.subscription=T(n,this.subscriptionChanges)}requestSubscription(t){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(w));let n={userVisibleOnly:!0},i=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),a=new Uint8Array(new ArrayBuffer(i.length));for(let o=0;o<i.length;o++)a[o]=i.charCodeAt(o);return n.applicationServerKey=a,this.pushManager.pipe(E(o=>o.subscribe(n)),p(1)).toPromise().then(o=>(this.subscriptionChanges.next(o),o))}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(w));let t=n=>{if(n===null)throw new Error("Not subscribed to push notifications.");return n.unsubscribe().then(i=>{if(!i)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})};return this.subscription.pipe(p(1),E(t)).toPromise()}decodeBase64(t){return atob(t)}};e.\u0275fac=function(n){return new(n||e)(S(g))},e.\u0275prov=b({token:e,factory:e.\u0275fac});let r=e;return r})(),Y=(()=>{let e=class e{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,!t.isEnabled){this.versionUpdates=d,this.unrecoverable=d;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(w));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(w));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}};e.\u0275fac=function(n){return new(n||e)(S(g))},e.\u0275prov=b({token:e,factory:e.\u0275fac});let r=e;return r})();var J=new W("");function ee(r,e,s,t){return()=>{if(!(N(t)&&"serviceWorker"in navigator&&s.enabled!==!1))return;let n=r.get(K),i=r.get(M);n.runOutsideAngular(()=>{let o=navigator.serviceWorker,c=()=>o.controller?.postMessage({action:"INITIALIZE"});o.addEventListener("controllerchange",c),i.onDestroy(()=>{o.removeEventListener("controllerchange",c)})});let a;if(typeof s.registrationStrategy=="function")a=s.registrationStrategy();else{let[o,...c]=(s.registrationStrategy||"registerWhenStable:30000").split(":");switch(o){case"registerImmediately":a=m(null);break;case"registerWithDelay":a=$(+c[0]||0);break;case"registerWhenStable":a=c[0]?T(q(r),$(+c[0])):q(r);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${s.registrationStrategy}`)}}n.runOutsideAngular(()=>a.pipe(p(1)).subscribe(()=>navigator.serviceWorker.register(e,{scope:s.scope}).catch(o=>console.error("Service worker registration failed with:",o))))}}function $(r){return m(null).pipe(F(r))}function q(r){return r.get(M).isStable.pipe(f(s=>s))}function te(r,e){return new g(N(e)&&r.enabled!==!1?navigator.serviceWorker:void 0)}var v=class{};function re(r,e={}){return x([z,Y,{provide:J,useValue:r},{provide:v,useValue:e},{provide:g,useFactory:te,deps:[v,C]},{provide:_,useFactory:ee,deps:[B,J,v,C],multi:!0}])}var ve=(()=>{let e=class e{static register(t,n={}){return{ngModule:e,providers:[re(t,n)]}}};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=V({type:e}),e.\u0275inj=j({providers:[z,Y]});let r=e;return r})();export{ae as a,z as b,ve as c};
/**i18n:7a9f3c982e3d544e8991bb34cdb5a6fdcf3438cf410fb6ab9f6732a102cfaa64*/
