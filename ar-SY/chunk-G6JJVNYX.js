import{c as x}from"./chunk-5OX3T53N.js";import{a as k}from"./chunk-PRE7JJQ2.js";import{a as De,i as Fe}from"./chunk-OO7WXDNA.js";import"./chunk-7LNJURWF.js";import"./chunk-CR3EG57M.js";import"./chunk-DDR27OLS.js";import"./chunk-VJUFY4S4.js";import{f as P,g as $,h as G,k as z}from"./chunk-A7E5JPIG.js";import"./chunk-7WUJMPOQ.js";import{b as Le}from"./chunk-OYPL7GXD.js";import{a as O,b as A,d as Ce,e as D,g as T}from"./chunk-2QLZYHNX.js";import{c as v,r as Ie,u as R}from"./chunk-OMP4AQCP.js";import{b as ye}from"./chunk-IBSJVRMZ.js";import"./chunk-YGAFJZ7Z.js";import{i as F}from"./chunk-JHAJTEDZ.js";import{d as s,f as g,g as h,l as C,o as N,r as L,s as y,u as I}from"./chunk-OFW4TIFY.js";import{b,c as Oe}from"./chunk-SKF4QW7T.js";import{a as Ae}from"./chunk-Z7BGN3TV.js";import"./chunk-BCTBGMRZ.js";import"./chunk-3KPGUJYL.js";import{a as Q}from"./chunk-LUJYMJYX.js";import"./chunk-X7PAXQSZ.js";import{p as Se}from"./chunk-OGWUOLNG.js";import"./chunk-OTZDURPI.js";import"./chunk-BIQ4NYU7.js";import{A as Te,Ka as he,Na as Ne,ka as ge,m as Me,s as q}from"./chunk-TSFITG5P.js";import{$a as re,Cb as U,Fb as ae,Hb as de,Ib as me,Jb as _e,Kb as m,Lb as _,Mb as a,Zb as f,bc as pe,cb as l,cc as ue,db as H,dc as fe,hc as Ee,ic as ce,ja as d,lb as le,na as E,nb as S,nc as B,oc as c,pc as M,qa as ne,s as oe,sb as se,tc as W,uc as j,zb as r}from"./chunk-ZWUPDFUR.js";import{a as te,b as ie}from"./chunk-ZA5F7ID5.js";var ve=(()=>{let o=class o{constructor(e,i){this.http=e,this.sanitizer=i;}transform(e){return this.http.get(e,{responseType:"blob"}).pipe(oe(i=>this.sanitizer.bypassSecurityTrustUrl(URL.createObjectURL(i))));}};o.ɵfac=function(i){return new(i||o)(H(q,16),H(Te,16));},o.ɵpipe=ne({name:"secure",type:o,pure:!0,standalone:!0});let n=o;return n;})();var Re=(()=>{let o=class o extends P{constructor(){let e=d(O);super(e),this.fb=d(y),this.data=d(A),this.barcodeTypes=["qr","datamatrix"];let i=this.fb;this.dialog=e;let t=this.data;this.form=i.group({name:[t?.name??"_barcode1",[s.required]],type:["barcode",[s.required]],x:[t?.x??0,[s.required]],y:[t?.y??0,[s.required]],value:[t?.value??"",[s.required]],barcodeType:[t?.barcodeType??"qr",[s.required]],width:[t?.width??16,[s.required]],height:[t?.height??16,[s.required]]});}submit(){this.IsValid()&&this.dialog.close(this.form.value);}};o.ɵfac=function(i){return new(i||o)();},o.ɵcmp=E({type:o,selectors:[["sz-mgmt-reporting-template-barcode-field"]],standalone:!0,features:[c([]),S,M],decls:13,vars:10,consts:()=>{let e;e="\u0627\u0644\u0627\u0633\u0645";let i;i="\u0627\u0644\u0642\u064A\u0645\u0629";let t;t="\u0627\u0644\u0646\u0645\u0637";let u;u="\u0627\u0644\u0639\u0631\u0636";let V;return V="\u0627\u0644\u0627\u0631\u062A\u0641\u0627\u0639",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","name","label",e],["formControlName","value","label",i],["formControlName","barcodeType","label",t,3,"source"],[1,"sz-form-row"],["formControlName","x","label","X",3,"type"],["formControlName","y","label","Y",3,"type"],["formControlName","width","label",u,3,"type"],["formControlName","height","label",V,3,"type"],[3,"actions"]];},template:function(i,t){i&1&&(a(0,"sz-ui-dialog-header",0),m(1,"mat-dialog-content")(2,"form",1),a(3,"sz-ui-form-field-input",2)(4,"sz-ui-form-field-input",3)(5,"sz-ui-form-field-select",4),m(6,"div",5),a(7,"sz-ui-form-field-input",6)(8,"sz-ui-form-field-input",7),_(),m(9,"div",5),a(10,"sz-ui-form-field-input",8)(11,"sz-ui-form-field-input",9),_()()(),a(12,"sz-ui-dialog-actions",10)),i&2&&(r("title",t.title)("subtitle",t.subtitle)("alert",t.alert()),l(2),r("formGroup",t.form),l(3),r("source",t.barcodeTypes),l(2),r("type","number"),l(),r("type","number"),l(2),r("type","number"),l(),r("type","number"),l(),r("actions",t.actions));},dependencies:[I,C,g,h,N,L,T,D,F,x,z,$,G,R,v,Ie],encapsulation:2});let n=o;return n;})();var be=(()=>{let o=class o extends P{constructor(){let e=d(O);super(e),this.fb=d(y),this.data=d(A);let i=this.fb;this.dialog=e;let t=this.data;this.form=i.group({name:[t?.name??"_image1",[s.required]],type:["image",[s.required]],x:[t?.x??0,[s.required]],y:[t?.y??0,[s.required]],url:[t?.url??"",[s.required]],width:[t?.width??16,[s.required]],height:[t?.height??16,[s.required]]});}submit(){this.IsValid()&&this.dialog.close(this.form.value);}};o.ɵfac=function(i){return new(i||o)();},o.ɵcmp=E({type:o,selectors:[["sz-mgmt-reporting-template-image-field"]],standalone:!0,features:[c([]),S,M],decls:11,vars:9,consts:()=>{let e;e="\u0627\u0644\u0627\u0633\u0645";let i;i="\u0627\u0644\u0639\u0631\u0636";let t;return t="\u0627\u0644\u0627\u0631\u062A\u0641\u0627\u0639",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","name","label",e],[1,"sz-form-row"],["formControlName","x","label","X",3,"type"],["formControlName","y","label","Y",3,"type"],["formControlName","width","label",i,3,"type"],["formControlName","height","label",t,3,"type"],[3,"actions"]];},template:function(i,t){i&1&&(a(0,"sz-ui-dialog-header",0),m(1,"mat-dialog-content")(2,"form",1),a(3,"sz-ui-form-field-input",2),m(4,"div",3),a(5,"sz-ui-form-field-input",4)(6,"sz-ui-form-field-input",5),_(),m(7,"div",3),a(8,"sz-ui-form-field-input",6)(9,"sz-ui-form-field-input",7),_()()(),a(10,"sz-ui-dialog-actions",8)),i&2&&(r("title",t.title)("subtitle",t.subtitle)("alert",t.alert()),l(2),r("formGroup",t.form),l(3),r("type","number"),l(),r("type","number"),l(2),r("type","number"),l(),r("type","number"),l(),r("actions",t.actions));},dependencies:[I,C,g,h,N,L,T,D,F,x,z,$,G,R,v],encapsulation:2});let n=o;return n;})();var Pe=(()=>{let o=class o extends P{constructor(){let e=d(O);super(e),this.fb=d(y),this.data=d(A);let i=this.fb;this.dialog=e;let t=this.data;this.form=i.group({name:[t?.name??"_line1",[s.required]],type:["line",[s.required]],x:[t?.x??5,[s.required]],y:[t?.y??5,[s.required]],lineColor:[t?.lineColor??"#000",[s.required]],lineWidth:[t?.lineWidth??1,[s.required]],x2:[t?.x2??30,[s.required]],y2:[t?.y2??5,[s.required]]});}submit(){this.IsValid()&&this.dialog.close(this.form.value);}};o.ɵfac=function(i){return new(i||o)();},o.ɵcmp=E({type:o,selectors:[["sz-mgmt-reporting-template-line-field"]],standalone:!0,features:[c([]),S,M],decls:13,vars:10,consts:()=>{let e;e="\u0627\u0644\u0627\u0633\u0645";let i;i="\u0627\u0644\u0644\u0648\u0646";let t;return t="\u0627\u0644\u0639\u0631\u0636",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","name","label",e],[1,"sz-form-row"],["formControlName","x","label","X",3,"type"],["formControlName","y","label","Y",3,"type"],["formControlName","x2","label","X2",3,"type"],["formControlName","y2","label","Y2",3,"type"],["formControlName","lineColor","label",i],["formControlName","lineWidth","label",t,3,"type"],[3,"actions"]];},template:function(i,t){i&1&&(a(0,"sz-ui-dialog-header",0),m(1,"mat-dialog-content")(2,"form",1),a(3,"sz-ui-form-field-input",2),m(4,"div",3),a(5,"sz-ui-form-field-input",4)(6,"sz-ui-form-field-input",5),_(),m(7,"div",3),a(8,"sz-ui-form-field-input",6)(9,"sz-ui-form-field-input",7),_(),a(10,"sz-ui-form-field-input",8)(11,"sz-ui-form-field-input",9),_()(),a(12,"sz-ui-dialog-actions",10)),i&2&&(r("title",t.title)("subtitle",t.subtitle)("alert",t.alert()),l(2),r("formGroup",t.form),l(3),r("type","number"),l(),r("type","number"),l(2),r("type","number"),l(),r("type","number"),l(2),r("type","number"),l(),r("actions",t.actions));},dependencies:[I,C,g,h,N,L,T,D,F,x,z,$,G,R,v],encapsulation:2});let n=o;return n;})();var $e=(()=>{let o=class o extends P{constructor(){let e=d(O);super(e),this.fb=d(y),this.data=d(A);let i=this.fb;this.dialog=e;let t=this.data;this.form=i.group({name:[t?.name??"_text1",[s.required]],type:["text",[s.required]],x:[t?.x??0,[s.required]],y:[t?.y??0,[s.required]],text:[t?.text??"",[s.required]],fontSize:[t?.fontSize??12,[s.required]],fontColor:[t?.fontColor??"#000",[s.required]]});}submit(){this.IsValid()&&this.dialog.close(this.form.value);}};o.ɵfac=function(i){return new(i||o)();},o.ɵcmp=E({type:o,selectors:[["sz-mgmt-reporting-template-text-field"]],standalone:!0,features:[c([]),S,M],decls:11,vars:8,consts:()=>{let e;e="\u0627\u0644\u0627\u0633\u0645";let i;i="\u0627\u0644\u0646\u0635";let t;t="\u062D\u062C\u0645 \u0627\u0644\u062E\u0637";let u;return u="\u0644\u0648\u0646 \u0627\u0644\u062E\u0637",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","name","label",e],[1,"sz-form-row"],["formControlName","x","label","X",3,"type"],["formControlName","y","label","Y",3,"type"],["formControlName","text","label",i],["formControlName","fontSize","label",t,3,"type"],["formControlName","fontColor","label",u],[3,"actions"]];},template:function(i,t){i&1&&(a(0,"sz-ui-dialog-header",0),m(1,"mat-dialog-content")(2,"form",1),a(3,"sz-ui-form-field-input",2),m(4,"div",3),a(5,"sz-ui-form-field-input",4)(6,"sz-ui-form-field-input",5),_(),a(7,"sz-ui-form-field-input",6)(8,"sz-ui-form-field-input",7)(9,"sz-ui-form-field-input",8),_()(),a(10,"sz-ui-dialog-actions",9)),i&2&&(r("title",t.title)("subtitle",t.subtitle)("alert",t.alert()),l(2),r("formGroup",t.form),l(3),r("type","number"),l(),r("type","number"),l(2),r("type","number"),l(2),r("actions",t.actions));},dependencies:[I,C,g,h,N,L,T,D,F,x,z,$,G,R,v],encapsulation:2});let n=o;return n;})();var ze=["designer"];function xe(n,o){if(n&1&&(B(0),m(1,"p",7),Ee(2),_()),n&2){let p=f().$implicit,e=f(),i=e.getTextField(p);l(),U(e.getTextFieldStyle(i)),r("id",e.getFieldId(i)),l(),ce(i.text);}}function Ve(n,o){if(n&1&&(B(0),a(1,"img",8),W(2,"secure"),W(3,"async")),n&2){let p=f().$implicit,e=f(),i=e.getImageField(p);l(),U(e.getImageFieldStyle(i)),r("alt",i.name)("id",e.getFieldId(i))("src",j(3,7,j(2,5,i.url)),re);}}function Be(n,o){if(n&1&&B(0),n&2){let p=f().$implicit;f().getBarcodeField(p);}}function we(n,o){if(n&1&&B(0),n&2){let p=f().$implicit;f().getBarcodeField(p);}}function Xe(n,o){if(n&1&&B(0),n&2){let p=f().$implicit;f().getBarcodeField(p);}}function Ue(n,o){if(n&1&&se(0,xe,3,4,"p",5)(1,Ve,4,9,"img",6)(2,Be,1,0)(3,we,1,0)(4,Xe,1,0),n&2){let p=o.$implicit;ae(p.type==="text"?0:p.type==="image"?1:p.type==="barcode"?2:p.type==="table"?3:p.type==="line"?4:-1);}}var Ge=(()=>{let o=class o{constructor(){this.route=d(Se),this.dialog=d(Ce),this.srptService=d(k),this.snackBar=d(Le),this.httpClient=d(q),this.template=this.route.snapshot.data.template,this.alert=le(void 0),this.fields=[],this.size={width:210,height:297,unit:"mm"},this.appBarConfig={title:this.template.name,subtitle:this.template.description,menu:Oe.default([b.add().setSubItems([b.text(this.openSaveTextFieldComponent.bind(this)),b.barcode(this.openSaveBarcodeFieldComponent.bind(this)),b.image(this.openSaveImageFieldComponent.bind(this)),b.line(this.openSaveLineFieldComponent.bind(this))]).setTitle(),b.menu([b.reset(this.reset.bind(this))])])};}ngAfterViewInit(){this.refresh();}refresh(){this.fields=this.template.content?.fields??[];}getTemplateStyle(){return`width: ${this.size.width}${this.size.unit}; height: ${this.size.height}${this.size.unit}; position: relative;`;}getFieldId(e){return this.template.id+"-"+e.name;}getTextField(e){return e;}getTextFieldStyle(e){return`left: ${e.x}${this.size.unit}; top: ${e.y}${this.size.unit};position: absolute;`;}getImageField(e){return e;}getImageFieldStyle(e){return`left: ${e.x}${this.size.unit}; top: ${e.y}${this.size.unit};position: absolute; width: ${e.width}${this.size.unit}; height: ${e.height}${this.size.unit};`;}getBarcodeField(e){return e;}openSaveTextFieldComponent(){this.dialog.open($e).afterClosed().subscribe(e=>{e&&(this.fields.push(e),this.save());});}openSaveBarcodeFieldComponent(){this.dialog.open(Re).afterClosed().subscribe(e=>{e&&(this.fields.push(e),this.save());});}openSaveImageFieldComponent(){this.dialog.open(be).afterClosed().subscribe(e=>{e&&(this.fields.push(e),this.save());});}openSaveLineFieldComponent(){this.dialog.open(Pe).afterClosed().subscribe(e=>{e&&(this.fields.push(e),this.save());});}fieldChanged(e){this.fields=this.fields.map(i=>i.name===e.name?e:i),this.save();}fieldDeleted(e){this.fields=this.fields.filter(i=>i.name!==e.name);}reset(){this.fields=[],this.fields=this.template.baseTemplate.content?.fields??[],this.save();}save(){this.srptService.templates.update(this.template.id,ie(te({},this.template),{content:{fields:this.fields}})).subscribe(()=>{this.snackBar.open(Q.saved,Q.close,{duration:5e3});});}};o.ɵfac=function(i){return new(i||o)();},o.ɵcmp=E({type:o,selectors:[["sz-mgmt-reporting-template"]],viewQuery:function(i,t){if(i&1&&pe(ze,5),i&2){let u;ue(u=fe())&&(t.designerEl=u.first);}},standalone:!0,features:[c([k]),M],decls:7,vars:4,consts:[["designer",""],[3,"config"],[3,"alert"],[1,"container"],["dir","ltr","cdkDropListGroup","",1,"designer"],["cdkDrag","",3,"id","style"],["cdkDrag","",3,"alt","id","style","src"],["cdkDrag","",3,"id"],["cdkDrag","",3,"alt","id","src"]],template:function(i,t){i&1&&(a(0,"sz-ui-app-bar",1)(1,"sz-ui-alert",2),m(2,"div",3)(3,"div",4,0),me(5,Ue,5,1,null,null,de),_()()),i&2&&(r("config",t.appBarConfig),l(),r("alert",t.alert()),l(2),U(t.getTemplateStyle()),l(2),_e(t.fields));},dependencies:[De,T,ge,Ne,Fe,Ae,he,ye,ve,Me],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}.designer[_ngcontent-%COMP%]{border:1px solid #c3c3c3;background-color:#fff;position:relative}"]});let n=o;return n;})();var Ei=[{path:"",component:Ge}];export{Ei as default};/**i18n:9054193bb4dcc24d51a6dba534830e37dcd91e77a8a9ecb6b346a792eb872c67*/