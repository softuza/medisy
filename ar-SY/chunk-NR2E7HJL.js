import{b as fe}from"./chunk-XMGOBE6T.js";import{a as x,b as P}from"./chunk-KSGWVIAJ.js";import{a as u}from"./chunk-3UTLHJGL.js";import{a as Mt,b as ft,c as ht,d as gt,e as Tt}from"./chunk-H445WRSX.js";import{a as dt}from"./chunk-HOYPB7ME.js";import{d as Ze,h as et}from"./chunk-QNM6XM36.js";import{a as Nt}from"./chunk-TXRHKTMR.js";import{a as Se,b as ut,c as Ce,d as ue,e as Me,f as Y}from"./chunk-PT75MKNF.js";import{a as pt}from"./chunk-Q2N4ZM5T.js";import{e as ct,f as Et,g as St,j as Ct}from"./chunk-OPST3HSR.js";import{a as We,b as Ke,e as Je,g as Qe}from"./chunk-5MAY3I4F.js";import{a as le,b as se,c as it,d as ot,e as me,f as _e,g as pe,h as ce,m as lt,r as Ee,s as st,t as mt,v as _t}from"./chunk-RZLFWLWK.js";import{c as O,d as de,e as nt}from"./chunk-4GL34ATX.js";import{g as ae}from"./chunk-VQDUMFVZ.js";import{a as re,b as X}from"./chunk-D5DPYT77.js";import{b as tt,c as rt,d as at}from"./chunk-OPRLBPJZ.js";import{a as ee,b as te,d as ie,h as oe,i as ne}from"./chunk-C77Q6E22.js";import{b as j,d as h,e as W,f as G,g as Xe,j as H,k as Ye,l as K,m as Ve,p as He,q as ke,t as w}from"./chunk-ZBCFQZ6O.js";import{c as qe,e as je}from"./chunk-IWB7BCZA.js";import{c as Ue}from"./chunk-FBMLFETS.js";import{$ as J,ca as Q,ga as U,ha as Z}from"./chunk-VGXLPPL2.js";import{$b as Ge,Bb as p,Gb as S,Ib as b,Jb as D,Kb as B,Lb as l,Mb as r,Nb as _,Ob as De,Pb as Be,Rb as $,Xb as M,Yb as N,_b as c,a as y,ac as we,b as $e,g as xe,gb as a,gc as R,hb as d,hc as C,ic as T,jc as V,na as I,nc as A,oc as L,ra as v,rb as be,sa as F,sb as z,sc as k,tc as q,xb as f,y as ze}from"./chunk-75X3YXCS.js";function Rt(i,n){if(i&1&&(l(0,"mat-card-subtitle"),C(1),r()),i&2){let s=c(2);a(),T(s.person.primaryEmail);}}function At(i,n){if(i&1&&(De(0,1),l(1,"mat-card-subtitle"),C(2),r(),l(3,"mat-card-subtitle"),C(4),r(),f(5,Rt,2,1,"mat-card-subtitle"),Be()),i&2){let s=c();a(2),T(s.getSex()),a(2),T(s.getMobilePhone()),a(),S(5,s.person.primaryEmail?5:-1);}}var fi=(()=>{let n=class n{set personId(e){this._personId=e,this.getPerson(e);}get personId(){return this._personId;}constructor(e,t,o){this.mpplService=e,this.personNamePipe=t,this.router=o,this.indicator=be(!1),this.card={icon:"person",clickFn:()=>this.router.navigate([`/mppl/persons/${this._personId}`]),actions:[]};}getPerson(e){this.mpplService.persons.getById(e).pipe(O(this.indicator)).subscribe(t=>{this.person=t,this.card.title=this.personNamePipe.transform(t);});}getSex(){return at(this.person?.sex);}getMobilePhone(){return this.person.mobilePhone.countryCode&&this.person.mobilePhone.number?`${this.person.mobilePhone.countryCode}${this.person.mobilePhone.number}`:null;}};n.ɵfac=function(t){return new(t||n)(d(u),d(P),d(qe));},n.ɵcmp=I({type:n,selectors:[["sz-medisy-people-person-card"]],inputs:{personId:"personId"},standalone:!0,features:[A([P,x,u]),L],decls:2,vars:3,consts:[[3,"card","indicator"],["subtitle",""]],template:function(t,o){t&1&&(l(0,"sz-ui-card",0),f(1,At,6,3,"ng-container",1),r()),t&2&&(p("card",o.card)("indicator",o.indicator),a(),S(1,o.person?1:-1));},dependencies:[je,et,Ze,dt,X,tt,Ue,Y],encapsulation:2});let i=n;return i;})();function bt(i,n){if(i&1){let s=$();l(0,"mat-chip-row",8),N("removed",function(){let o=v(s).$implicit,m=c(2);return F(m.removeSelection(o));}),C(1),k(2,"personName"),l(3,"button",9)(4,"mat-icon"),C(5,"cancel"),r()()();}if(i&2){let s=n.$implicit;a(),V(" ",q(2,1,s)," ");}}function Dt(i,n){if(i&1){let s=$();l(0,"mat-chip-grid",null,5),D(2,bt,6,3,"mat-chip-row",null,b),r(),l(4,"input",6,7),N("matChipInputTokenEnd",function(){v(s);let t=c();return F(t.addSelection());}),r();}if(i&2){let s=R(1),e=c(),t=R(7);a(2),B(e.selections),a(2),p("matAutocomplete",t)("formControl",e.control)("matChipInputFor",s)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes);}}function Bt(i,n){if(i&1&&_(0,"input",10,7),i&2){let s=c(),e=R(7);p("matAutocomplete",e)("formControl",s.control);}}function Gt(i,n){if(i&1&&(l(0,"small"),C(1),k(2,"personAge"),r()),i&2){let s=c().$implicit;a(),T(q(2,1,s==null?null:s.birthDate));}}function wt(i,n){if(i&1&&(l(0,"mat-option",11)(1,"div",12)(2,"strong"),C(3),k(4,"personName"),r(),f(5,Gt,3,3,"small"),r()()),i&2){let s=n.$implicit;p("value",s),a(3),T(q(4,3,s)),a(2),S(5,s!=null&&s.birthDate?5:-1);}}function Xt(i,n){i&1&&(l(0,"mat-error"),M(1,13),r());}function Yt(i,n){i&1&&(l(0,"mat-error"),M(1,14),r());}function Vt(i,n){i&1&&_(0,"mat-progress-bar",4);}var Ht=[[["","suffix",""]]],kt=["[suffix]"],zi=(()=>{let n=class n extends ce{constructor(e,t,o,m){super(e),this.ngControl=e,this.mpplService=t,this.personNamePipe=o,this.personAgePipe=m,this.filter={},this.label="\u0627\u0644\u0627\u0633\u0645 \u0627\u0648 \u0627\u0644\u0647\u0627\u062A\u0641 \u0627\u0648 \u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0627\u0644\u0643\u062A\u0631\u0648\u0646\u064A",this.szOptionFormatFn=g=>this.personNamePipe.transform(g);}ngOnInit(){this.control=this.ngControl.control,this.listenChanges();}listenChanges(){this.control.valueChanges.pipe(de(400)).subscribe(e=>{this.handleValueChanged(e);});}handleValueChanged(e){if(this.reset(),typeof e=="string"){let t=e.split(" ");t.length===2?(this.filter.firstName=t[0],this.filter.lastName=t[1]):this.filter.query=t[0];}else if(typeof e=="object"&&e)return;this.fetch();}reset(){this.filter={},this.totalPages=-1,this.pagination.pageIndex=1,this.options=[];}fetch(){this.mpplService.persons.get(y(y({},this.filter),this.pagination)).pipe(O(this.indicator)).subscribe(e=>{this.options.push(...e.items),this.totalPages=e.totalPages;});}};n.ɵfac=function(t){return new(t||n)(d(W,10),d(u),d(P),d(x));},n.ɵcmp=I({type:n,selectors:[["sz-medisy-people-person-search"]],standalone:!0,features:[A([u,x,P]),z,L],ngContentSelectors:kt,decls:15,vars:7,consts:()=>{let e;e="\u0647\u0630\u0627 \u0627\u0644\u062D\u0642\u0644 \u0645\u0637\u0644\u0648\u0628";let t;return t="\u0647\u0630\u0627 \u0627\u0644\u062D\u0642\u0644 \u063A\u064A\u0631 \u0635\u062D\u064A\u062D",[[1,"container"],[3,"displayWith","szScrollIgnored","optionSelected","szScrolled"],["auto","matAutocomplete"],["matSuffix",""],["mode","indeterminate"],["chipGrid",""],["matInput","",3,"matAutocomplete","formControl","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["input",""],[3,"removed"],["matChipRemove",""],["matInput","",3,"matAutocomplete","formControl"],[3,"value"],[1,"sz-form"],e,t];},template:function(t,o){t&1&&(Ge(Ht),l(0,"div",0)(1,"mat-form-field")(2,"mat-label"),C(3),r(),f(4,Dt,6,4)(5,Bt,2,2),l(6,"mat-autocomplete",1,2),N("optionSelected",function(g){return o.optionSelected(g);})("szScrolled",function(){return o.scroll();}),D(8,wt,6,5,"mat-option",11,b),r(),f(10,Xt,2,0,"mat-error")(11,Yt,2,0,"mat-error"),l(12,"span",3),we(13),r()(),f(14,Vt,1,0,"mat-progress-bar",4),r()),t&2&&(a(3),T(o.label),a(),S(4,o.multiple?4:5),a(2),p("displayWith",o.szOptionFormatFn)("szScrollIgnored",o.indicator()),a(2),B(o.options),a(2),S(10,o.control.hasError("required")?10:-1),a(),S(11,o.control.hasError("invalid")?11:-1),a(3),S(14,o.indicator()?14:-1));},dependencies:[w,j,G,K,ne,oe,ee,te,ie,pe,me,J,_e,X,re,se,le,Q,Y,ue,Me,Se,Ce,Z,U,Ee,x,P],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]{position:relative}mat-progress-bar[_ngcontent-%COMP%]{position:absolute;bottom:20px}"]});let i=n;return i;})();function qt(i,n){if(i&1){let s=$();l(0,"mat-chip-row",8),N("removed",function(){let o=v(s).$implicit,m=c(2);return F(m.removeSelection(o));}),C(1),l(2,"button",9)(3,"mat-icon"),C(4,"cancel"),r()()();}if(i&2){let s=n.$implicit,e=c(2);a(),V(" ",e.getSelectionFormat(s)," ");}}function jt(i,n){if(i&1){let s=$();l(0,"mat-chip-grid",null,5),D(2,qt,5,1,"mat-chip-row",null,b),r(),l(4,"input",6,7),N("matChipInputTokenEnd",function(){v(s);let t=c();return F(t.addSelection());}),r();}if(i&2){let s=R(1),e=c(),t=R(7);a(2),B(e.selections),a(2),p("matAutocomplete",t)("formControl",e.control)("matChipInputFor",s)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes);}}function Wt(i,n){if(i&1&&_(0,"input",10,7),i&2){let s=c(),e=R(7);p("matAutocomplete",e)("formControl",s.control);}}function Kt(i,n){if(i&1&&(l(0,"mat-option",11),C(1),r()),i&2){let s=n.$implicit,e=c();p("value",e.getOptionValue(s)),a(),V(" ",e.getOptionContent(s)," ");}}function Jt(i,n){i&1&&(l(0,"mat-error"),M(1,12),r());}function Qt(i,n){i&1&&(l(0,"mat-error"),M(1,13),r());}function Ut(i,n){if(i&1){let s=$();l(0,"mat-chip",14),N("click",function(){v(s);let t=c();return F(t.save());}),M(1,15),r();}}function Zt(i,n){i&1&&_(0,"mat-progress-bar",4);}var Pt=(()=>{let n=class n extends ce{constructor(e,t){super(e),this.ngControl=e,this.mpplService=t,this.label=rt.title,this.query=null,this.orderBy=["name"],this.isNew=!1,this.szOptionFormatFn=o=>o?o.name:"";}ngOnInit(){this.control=this.ngControl.control,this.listenChanges();}ngOnDestroy(){this.subscriptions.unsubscribe();}listenChanges(){this.subscriptions.add(this.control.valueChanges.pipe(de(400)).subscribe(e=>{this.handleValueChanged(e);}));}handleValueChanged(e){if(this.reset(),typeof e=="string"){if(e===""){this.control.setValue(null);return;}this.query=e;}else if(typeof e=="object"&&e)return;this.fetch();}reset(){this.isNew=!1,this.query=null,this.totalPages=-1,this.options=[];}fetch(){this.mpplService.titles.get($e(y({query:this.query},ae.unpaged()),{orderBy:this.orderBy})).pipe(O(this.indicator)).subscribe(e=>{this.options.push(...e.items),this.totalPages=e.totalPages,e.count==0&&this.query&&(this.isNew=!0);});}save(){this.mpplService.titles.create({name:this.query}).pipe(O(this.indicator)).subscribe(e=>{this.isNew=!1,this.control.setValue(e);});}getOptionValue(e){return e;}};n.ɵfac=function(t){return new(t||n)(d(W,10),d(u));},n.ɵcmp=I({type:n,selectors:[["sz-medisy-people-title-search"]],inputs:{query:"query",orderBy:"orderBy"},standalone:!0,features:[A([pt]),z,L],decls:14,vars:8,consts:()=>{let e;e="\u0647\u0630\u0627 \u0627\u0644\u062D\u0642\u0644 \u0645\u0637\u0644\u0648\u0628";let t;t="\u0647\u0630\u0627 \u0627\u0644\u062D\u0642\u0644 \u063A\u064A\u0631 \u0635\u062D\u064A\u062D";let o;return o="\u062D\u0641\u0638",[[1,"container"],[3,"displayWith","szScrollIgnored","optionSelected","szScrolled"],["auto","matAutocomplete"],["class","tw-m-1","matSuffix","","color","accent"],["mode","indeterminate"],["chipGrid",""],["matInput","",3,"matAutocomplete","formControl","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["input",""],[3,"removed"],["matChipRemove",""],["matInput","",3,"matAutocomplete","formControl"],[3,"value"],e,t,["matSuffix","","color","accent",1,"tw-m-1",3,"click"],o];},template:function(t,o){t&1&&(l(0,"div",0)(1,"mat-form-field")(2,"mat-label"),C(3),r(),f(4,jt,6,4)(5,Wt,2,2),l(6,"mat-autocomplete",1,2),N("optionSelected",function(g){return o.optionSelected(g);})("szScrolled",function(){return o.scroll();}),D(8,Kt,2,2,"mat-option",11,b),r(),f(10,Jt,2,0,"mat-error")(11,Qt,2,0,"mat-error")(12,Ut,2,0,"mat-chip",3),r(),f(13,Zt,1,0,"mat-progress-bar",4),r()),t&2&&(a(3),T(o.label),a(),S(4,o.multiple?4:5),a(2),p("displayWith",o.szOptionFormatFn)("szScrollIgnored",o.indicator()),a(2),B(o.options),a(2),S(10,o.control.hasError("required")?10:-1),a(),S(11,o.control.hasError("invalid")?11:-1),a(),S(12,o.isNew&&!o.indicator()?12:-1),a(),S(13,o.indicator()?13:-1));},dependencies:[w,j,G,K,ne,oe,ee,te,ie,pe,me,J,_e,X,re,se,le,Q,Y,ut,ue,Me,Se,Ce,Z,U,Ee],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]{position:relative}mat-progress-bar[_ngcontent-%COMP%]{position:absolute;bottom:20px}"]});let i=n;return i;})();var Ao=(()=>{let n=class n extends ct{constructor(e,t,o,m){super(o),this.mpplService=e,this.fb=t,this.dialog=o,this.data=m,this.nationalities=this.mpplService.nationalities.getAll({orderBy:["name"]}),this.languages=this.mpplService.languages.getAll({orderBy:["name"]}),this.sexes=Object.keys(fe).map(g=>fe[g]),this.subscriptions=new xe(),this.form=t.group({firstName:t.control(m?.firstName,[h.required,h.maxLength(128)]),lastName:t.control(m?.lastName,[h.required,h.maxLength(128)]),fatherName:t.control(m?.fatherFirstName?`${m.fatherFirstName} ${m?.lastName}`:null,[h.maxLength(128)]),motherName:t.control(m?.motherName,[h.maxLength(128)]),birthDate:t.control(m?.birthDate,[]),nationalityId:t.control(null,[]),ssn:t.control(m?.ssn,[h.maxLength(128)]),languageId:t.control(null,[h.required]),sex:t.control(null,[h.required]),title:t.control(null,[Nt()]),primaryEmail:[null,[h.email]],secondaryEmail:[null,[h.email]],mobilePhone:new H(null),homePhone:new H(null),workPhone:new H(null),homeAddress:new H({street:m?.address?"":void 0,city:m?.address,country:m?.address?"":void 0,province:m?.address?"":void 0,postalCode:m?.address?"":void 0})}),this.subscibeChanges();}subscibeChanges(){this.subscriptions.add(this.form.get("firstName")?.valueChanges.subscribe(e=>{if(!e||e===""){this.updateSex(null),this.updateLanguageId(null);return;}else this.getGenders(e);}));}getGenders(e){this.mpplService.autosuggestions.getGenders(y({query:e},ae.minimal())).pipe(ze(t=>t.items)).subscribe(t=>{!t||t.length===0||(this.updateSex(t[0].sex),this.updateLanguageId(t[0].languageId));});}updateSex(e){this.form.controls.sex.setValue(e);}updateLanguageId(e){this.form.controls.languageId.setValue(e);}submit(){if(!this.IsValid())return;let e=this.form.value;this.mpplService.persons.create({languageId:e.languageId,sex:e.sex,titleId:e.title?.id,birthDate:e.birthDate,nationalitiyId:e.nationalitiyId,ssn:e.ssn,names:[{firstName:e.firstName,lastName:e.lastName,fatherName:e.fatherName,motherName:e.motherName,languageId:e.languageId}],primaryEmail:e.primaryEmail,secondaryEmail:e.secondaryEmail,mobilePhone:e.mobilePhone,homePhone:e.homePhone,workPhone:e.workPhone,homeAddress:e.homeAddress}).pipe(O(this.indicator),nt(this.alert)).subscribe(t=>{this.dialog.close(t);});}};n.ɵfac=function(t){return new(t||n)(d(u),d(ke),d(We),d(Ke));},n.ɵcmp=I({type:n,selectors:[["sz-medisy-people-person-create"]],standalone:!0,features:[A([u]),z,L],decls:47,vars:7,consts:()=>{let e;e="\u0627\u0644\u0627\u0633\u0645 \u0627\u0644\u0627\u0648\u0644";let t;t="\u0627\u0644\u0643\u0646\u064A\u0629";let o;o="\u0627\u0633\u0645 \u0627\u0644\u0623\u0628";let m;m="\u0627\u0633\u0645 \u0627\u0644\u0623\u0645";let g;g="\u0627\u0644\u062C\u0646\u0633\u064A\u0629";let Te;Te="\u0627\u0644\u0631\u0642\u0645 \u0627\u0644\u0648\u0637\u0646\u064A";let Ne;Ne="\u0627\u0644\u062C\u0646\u0633";let Oe;Oe="\u0627\u0644\u0644\u063A\u0629";let Pe;Pe="\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0648\u0644\u0627\u062F\u0629";let Ie;Ie="\u0639\u0646\u0648\u0627\u0646 \u0627\u0644\u0645\u0646\u0632\u0644";let Re;Re="\u0627\u0644\u0647\u0627\u062A\u0641 \u0627\u0644\u062C\u0648\u0627\u0644";let Ae;Ae="\u0647\u0627\u062A\u0641 \u0627\u0644\u0645\u0646\u0632\u0644";let Le;Le="\u0647\u0627\u062A\u0641 \u0627\u0644\u0639\u0645\u0644";let ye;ye="\u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0627\u0644\u0643\u062A\u0631\u0648\u0646\u064A";let ve;ve="\u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0627\u0644\u0643\u062A\u0631\u0648\u0646\u064A \u0627\u0644\u0627\u0633\u0627\u0633\u064A";let Fe;return Fe="\u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0627\u0644\u0643\u062A\u0631\u0648\u0646\u064A \u0627\u0644\u062B\u0627\u0646\u0648\u064A",[[3,"header"],[1,"sz-form",3,"formGroup"],[1,"sz-form-row"],["formControlName","title"],["formControlName","firstName","label",e],["formControlName","lastName","label",t],["formControlName","fatherName","label",o],["formControlName","motherName","label",m],["formControlName","nationalityId","label",g,3,"source"],["formControlName","ssn","label",Te],["formControlName","sex","label",Ne,3,"source","localizedValue"],["formControlName","languageId","label",Oe,3,"source"],["formControlName","birthDate","label",Pe],[1,"tw-mb-4"],["multi",""],Ie,["formControlName","homeAddress"],Re,["formControlName","mobilePhone"],Ae,["formControlName","homePhone"],Le,["formControlName","workPhone"],ye,["formControlName","primaryEmail","label",ve],["formControlName","secondaryEmail","label",Fe],[3,"actions"]];},template:function(t,o){t&1&&(_(0,"sz-ui-dialog-header",0),l(1,"mat-dialog-content")(2,"form",1)(3,"div",2),_(4,"sz-medisy-people-title-search",3),r(),l(5,"div",2),_(6,"sz-ui-form-field-input",4)(7,"sz-ui-form-field-input",5),r(),l(8,"div",2),_(9,"sz-ui-form-field-input",6)(10,"sz-ui-form-field-input",7),r(),l(11,"div",2),_(12,"sz-ui-form-field-select",8)(13,"sz-ui-form-field-input",9),r(),l(14,"div",2),_(15,"sz-ui-form-field-select",10)(16,"sz-ui-form-field-select",11),r(),_(17,"sz-ui-form-field-date",12),l(18,"div",13)(19,"mat-accordion",14)(20,"mat-expansion-panel")(21,"mat-expansion-panel-header")(22,"mat-panel-title"),M(23,15),r()(),_(24,"sz-ui-form-field-address",16),r(),l(25,"mat-expansion-panel")(26,"mat-expansion-panel-header")(27,"mat-panel-title"),M(28,17),r()(),_(29,"sz-ui-form-field-phone-number",18),r(),l(30,"mat-expansion-panel")(31,"mat-expansion-panel-header")(32,"mat-panel-title"),M(33,19),r()(),_(34,"sz-ui-form-field-phone-number",20),r(),l(35,"mat-expansion-panel")(36,"mat-expansion-panel-header")(37,"mat-panel-title"),M(38,21),r()(),_(39,"sz-ui-form-field-phone-number",22),r(),l(40,"mat-expansion-panel")(41,"mat-expansion-panel-header")(42,"mat-panel-title"),M(43,23),r()(),_(44,"sz-ui-form-field-input",24)(45,"sz-ui-form-field-input",25),r()()()()(),_(46,"sz-ui-dialog-actions",26)),t&2&&(p("header",o.header),a(2),p("formGroup",o.form),a(10),p("source",o.nationalities),a(3),p("source",o.sexes)("localizedValue",!0),a(),p("source",o.languages),a(30),p("actions",o.actions));},dependencies:[w,Ye,G,Xe,Ve,He,Qe,Je,Tt,gt,Mt,ft,ht,Ct,Et,St,_t,it,st,lt,Pt,ot,mt],encapsulation:2});let i=n;return i;})();export{fi as a,Ao as b,zi as c,Pt as d};/**i18n:1c5a057012127d5b8d089498ac661b5227d0455136ea3b9f25a2d8940ec324d8*/