import{b as R}from"./chunk-M67AZG5X.js";import{a as Ce,b as Me,c as de,d as Ne,e as Oe}from"./chunk-LOIIJ3SA.js";import{a as ue}from"./chunk-KGN22PJE.js";import{a as u}from"./chunk-H26Z3OP5.js";import{e as ae,f as se,g as me,j as Se}from"./chunk-VSSKGV6R.js";import{g as re}from"./chunk-7LPVSDDF.js";import{a as W,b as J,e as K,g as Q}from"./chunk-7V5K6Q5S.js";import{c as U,d as Z,h as ee,i as oe,j as ne,o as te,r as _e,s as Ee,u as le}from"./chunk-NGJJQGF7.js";import{c as O}from"./chunk-7ZI3SE3B.js";import{c as ie}from"./chunk-MB66MPUF.js";import{d as r,f as x,g as w,k as M,l as V,n as k,q as j,r as H,u as q}from"./chunk-6ZNCB6JN.js";import{Kb as a,Lb as E,Mb as l,Wb as N,a as G,bb as m,cb as C,na as F,oc as X,pc as Y,qb as v,s as b,zb as s}from"./chunk-6DKTNWLB.js";import{a as d,b as g}from"./chunk-6HJHW4I2.js";var qe=(()=>{let S=class S extends ae{constructor(e,o,n,t){super(n),this.mpplService=e,this.fb=o,this.dialog=n,this.data=t,this.nationalities=this.mpplService.nationalities.getAll({orderBy:["name"]}),this.languages=this.mpplService.languages.getAll({orderBy:["name"]}),this.sexes=Object.keys(R).map(_=>R[_]),this.subscriptions=new G(),this.titles=this.mpplService.titles.get(g(d({},O.unpaged()),{orderBy:"name"})),this.titleAutoCompleteConfig={valueChangedFn:_=>(typeof _=="string"&&(this.titles=this.mpplService.titles.get(g(d({query:_},O.default()),{orderBy:"name"}))),!1),optionDisplayWithFn:_=>_.name,optionValueFn:_=>_,suffixes:[{icon:re.save,tooltip:ie.save,hideOnLoading:!0,hideOnValid:!0,hideOnEmpty:!0,clickFn:_=>this.mpplService.titles.create({name:_})}]},this.form=o.group({firstName:o.control(t?.firstName,[r.required,r.maxLength(128)]),lastName:o.control(t?.lastName,[r.required,r.maxLength(128)]),fatherName:o.control(t?.fatherFirstName?`${t.fatherFirstName} ${t?.lastName}`:null,[r.maxLength(128)]),motherName:o.control(t?.motherName,[r.maxLength(128)]),birthDate:o.control(t?.birthDate,[]),nationalityId:o.control(null,[]),ssn:o.control(t?.ssn,[r.maxLength(128)]),languageId:o.control(null,[r.required]),sex:o.control(null,[r.required]),title:o.control(null,[ue()]),primaryEmail:[null,[r.email]],secondaryEmail:[null,[r.email]],mobilePhone:new M(null),homePhone:new M(null),workPhone:new M(null),homeAddress:new M(t?.address)}),this.subscibeChanges();}subscibeChanges(){this.subscriptions.add(this.form.get("firstName")?.valueChanges.subscribe(e=>{if(!e||e===""){this.updateSex(null),this.updateLanguageId(null);return;}else this.getGenders(e);}));}getGenders(e){this.mpplService.autosuggestions.getGenders(d({query:e},O.minimal())).pipe(b(o=>o.items)).subscribe(o=>{!o||o.length===0||(this.updateSex(o[0].sex),this.updateLanguageId(o[0].languageId));});}updateSex(e){this.form.controls.sex.setValue(e);}updateLanguageId(e){this.form.controls.languageId.setValue(e);}submit(){if(!this.IsValid())return;let e=this.form.value;this.mpplService.persons.create({languageId:e.languageId,nationalityId:e.nationalityId,sex:e.sex,titleId:e.title?.id,birthDate:e.birthDate,nationalitiyId:e.nationalitiyId,ssn:e.ssn,names:[{firstName:e.firstName,lastName:e.lastName,fatherName:e.fatherName,motherName:e.motherName,languageId:e.languageId}],primaryEmail:e.primaryEmail,secondaryEmail:e.secondaryEmail,mobilePhone:e.mobilePhone,homePhone:e.homePhone,workPhone:e.workPhone,homeAddress:e.homeAddress}).pipe(ee(this.indicator),oe(this.alert)).subscribe(o=>{this.dialog.close(o);});}};S.ɵfac=function(o){return new(o||S)(C(u),C(H),C(W),C(J));},S.ɵcmp=F({type:S,selectors:[["sz-medisy-people-person-create"]],standalone:!0,features:[X([u]),v,Y],decls:39,vars:11,consts:()=>{let e;e="\u0627\u0644\u0644\u0642\u0628";let o;o="\u0627\u0644\u0627\u0633\u0645 \u0627\u0644\u0627\u0648\u0644";let n;n="\u0627\u0644\u0643\u0646\u064A\u0629";let t;t="\u0627\u0633\u0645 \u0627\u0644\u0623\u0628";let _;_="\u0627\u0633\u0645 \u0627\u0644\u0623\u0645";let P;P="\u0627\u0644\u062C\u0646\u0633\u064A\u0629";let p;p="\u0627\u0644\u0631\u0642\u0645 \u0627\u0644\u0648\u0637\u0646\u064A";let f;f="\u0627\u0644\u062C\u0646\u0633";let c;c="\u0627\u0644\u0644\u063A\u0629";let I;I="\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0648\u0644\u0627\u062F\u0629";let A;A="\u0627\u0644\u062C\u0648\u0627\u0644";let L;L="\u0627\u0644\u0645\u0646\u0632\u0644";let h;h="\u0627\u0644\u0639\u0645\u0644";let $;$="\u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0627\u0644\u0643\u062A\u0631\u0648\u0646\u064A \u0627\u0644\u0627\u0633\u0627\u0633\u064A";let D;D="\u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0627\u0644\u0643\u062A\u0631\u0648\u0646\u064A \u0627\u0644\u062B\u0627\u0646\u0648\u064A";let y;y="\u0639\u0646\u0648\u0627\u0646 \u0627\u0644\u0645\u0646\u0632\u0644";let z;z="\u0627\u0644\u0647\u0648\u0627\u062A\u0641";let B;return B="\u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0627\u0644\u0643\u062A\u0631\u0648\u0646\u064A",[y,z,B,[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],[1,"sz-form-row"],["formControlName","title","label",e,3,"source","config"],["formControlName","firstName","label",o],["formControlName","lastName","label",n],["formControlName","fatherName","label",t],["formControlName","motherName","label",_],["formControlName","nationalityId","label",P,3,"source"],["formControlName","ssn","label",p],["formControlName","sex","label",f,3,"source","localizedValue"],["formControlName","languageId","label",c,3,"source"],["formControlName","birthDate","label",I],[1,"tw-mb-4"],["multi",""],["formControlName","homeAddress"],["formControlName","mobilePhone","label",A],["formControlName","homePhone","label",L],["formControlName","workPhone","label",h],["formControlName","primaryEmail","label",$],["formControlName","secondaryEmail","label",D],[3,"actions"]];},template:function(o,n){o&1&&(l(0,"sz-ui-dialog-header",3),a(1,"mat-dialog-content")(2,"form",4)(3,"div",5),l(4,"sz-ui-form-field-autocomplete",6),E(),a(5,"div",5),l(6,"sz-ui-form-field-input",7)(7,"sz-ui-form-field-input",8),E(),a(8,"div",5),l(9,"sz-ui-form-field-input",9)(10,"sz-ui-form-field-input",10),E(),a(11,"div",5),l(12,"sz-ui-form-field-select",11)(13,"sz-ui-form-field-input",12),E(),a(14,"div",5),l(15,"sz-ui-form-field-select",13)(16,"sz-ui-form-field-select",14),E(),l(17,"sz-ui-form-field-date",15),a(18,"div",16)(19,"mat-accordion",17)(20,"mat-expansion-panel")(21,"mat-expansion-panel-header")(22,"mat-panel-title"),N(23,0),E()(),l(24,"sz-ui-form-field-address",18),E(),a(25,"mat-expansion-panel")(26,"mat-expansion-panel-header")(27,"mat-panel-title"),N(28,1),E()(),l(29,"sz-ui-form-field-phone-number",19)(30,"sz-ui-form-field-phone-number",20)(31,"sz-ui-form-field-phone-number",21),E(),a(32,"mat-expansion-panel")(33,"mat-expansion-panel-header")(34,"mat-panel-title"),N(35,2),E()(),l(36,"sz-ui-form-field-input",22)(37,"sz-ui-form-field-input",23),E()()()()(),l(38,"sz-ui-dialog-actions",24)),o&2&&(s("title",n.title)("subtitle",n.subtitle)("alert",n.alert()),m(2),s("formGroup",n.form),m(2),s("source",n.titles)("config",n.titleAutoCompleteConfig),m(8),s("source",n.nationalities),m(3),s("source",n.sexes)("localizedValue",!0),m(),s("source",n.languages),m(22),s("actions",n.actions));},dependencies:[q,V,x,w,k,j,Q,K,Oe,Ne,Ce,Me,de,Se,se,me,le,U,te,_e,ne,Z,Ee],encapsulation:2});let T=S;return T;})();export{qe as a};/**i18n:cc8d0044d806093be808d6b8741d081bf6b6d1e6fbd0e894171d30a61993b6a3*/