import{a as se}from"./chunk-26R4Z6FV.js";import{a as ce,b as pe,c as _e,e as de,f as ue,g as Se}from"./chunk-RMIHOFED.js";import{a as me}from"./chunk-UJRSINNB.js";import{a as k,b as G,c as j,g as X,h as Y,i as Z,j as ee,k as te,l as ie,m as oe,n as ae,w as le}from"./chunk-PR23273C.js";import{Ba as re,Q as J,R as Q,Z as U,b as w,e as $,f as V,l as B,t as D,ya as N,za as ne}from"./chunk-MNBERY7T.js";import{Ba as H,Ia as K,Ja as W,ya as q}from"./chunk-6NFGCLSN.js";import{Ab as p,Cb as I,Db as F,Eb as v,Fb as m,Gb as l,Hb as y,Lb as h,M as E,Rb as T,Tb as d,Vb as s,a as P,b as x,dc as M,ec as u,fc as R,gb as a,gc as O,hb as g,hc as z,kc as b,oa as L,ob as A,rb as f,ta as S,ua as C,vb as _}from"./chunk-6OQDJKEQ.js";function ve(){return t=>typeof t.value!="object"?{invalid:{value:t.value}}:null;}function fe(t,o){if(t&1){let r=h();m(0,"mat-chip-row",8),d("removed",function(){let i=S(r).$implicit,c=s(2);return C(c.removeSelection(i));}),u(1),m(2,"button",9)(3,"mat-icon"),u(4,"cancel"),l()()();}if(t&2){let r=o.$implicit,e=s(2);a(),O(" ",e.getSelectionFormat(r)," ");}}function he(t,o){if(t&1){let r=h();m(0,"mat-chip-grid",null,5),F(2,fe,5,1,"mat-chip-row",null,I),l(),m(4,"input",6,7),d("matChipInputTokenEnd",function(){S(r);let n=s();return C(n.addSelection());}),l();}if(t&2){let r=M(1),e=s(),n=M(7);a(2),v(e.selections),a(2),_("matAutocomplete",n)("formControl",e.control)("matChipInputFor",r)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes);}}function Te(t,o){if(t&1&&y(0,"input",10,7),t&2){let r=s(),e=M(7);_("matAutocomplete",e)("formControl",r.control);}}function Me(t,o){if(t&1&&(m(0,"mat-option",11),u(1),l()),t&2){let r=o.$implicit,e=s();_("value",e.getOptionValue(r)),a(),O(" ",e.getOptionContent(r)," ");}}function Ee(t,o){t&1&&(m(0,"mat-error"),T(1,12),l());}function ge(t,o){t&1&&(m(0,"mat-error"),T(1,13),l());}function Ie(t,o){if(t&1){let r=h();m(0,"mat-chip",14),d("click",function(){S(r);let n=s();return C(n.save());}),T(1,15),l();}}function Fe(t,o){t&1&&y(0,"mat-progress-bar",4);}var ot=(()=>{let o=class o extends ae{constructor(e,n){super(e),this.ngControl=e,this.mpplService=n,this.label=re.title,this.query=null,this.orderBy=["name"],this.isNew=!1,this.szOptionFormatFn=i=>i?i.name:"";}ngOnInit(){this.control=this.ngControl.control,this.listenChanges();}ngOnDestroy(){this.subscriptions.unsubscribe();}listenChanges(){this.subscriptions.add(this.control.valueChanges.pipe(ne(400)).subscribe(e=>{this.handleValueChanged(e);}));}handleValueChanged(e){if(this.reset(),typeof e=="string"){if(e===""){this.control.setValue(null);return;}this.query=e;}else if(typeof e=="object"&&e)return;this.fetch();}reset(){this.isNew=!1,this.query=null,this.totalPages=-1,this.options=[];}fetch(){this.mpplService.titles.get(x(P({query:this.query},U.unpaged()),{orderBy:this.orderBy})).pipe(E(1),N(this.indicator)).subscribe(e=>{this.options.push(...e.items),this.totalPages=e.totalPages,e.count==0&&this.query&&(this.isNew=!0);});}save(){this.mpplService.titles.create({name:this.query}).pipe(N(this.indicator),E(1)).subscribe(e=>{this.isNew=!1,this.control.setValue(e);});}getOptionValue(e){return e;}};o.ɵfac=function(n){return new(n||o)(g($,10),g(se));},o.ɵcmp=L({type:o,selectors:[["medisy-form-field-title-search"]],inputs:{query:"query",orderBy:"orderBy"},standalone:!0,features:[z([me]),A,b],decls:14,vars:8,consts:()=>{let e;e="\u0647\u0630\u0627 \u0627\u0644\u062D\u0642\u0644 \u0645\u0637\u0644\u0648\u0628";let n;n="\u0647\u0630\u0627 \u0627\u0644\u062D\u0642\u0644 \u063A\u064A\u0631 \u0635\u062D\u064A\u062D";let i;return i="\u062D\u0641\u0638",[[1,"container"],[3,"displayWith","szScrollIgnored","optionSelected","szScrolled"],["auto","matAutocomplete"],["class","tw-m-1","matSuffix","","color","accent"],["mode","indeterminate"],["chipGrid",""],["matInput","",3,"matAutocomplete","formControl","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["input",""],[3,"removed"],["matChipRemove",""],["matInput","",3,"matAutocomplete","formControl"],[3,"value"],e,n,["matSuffix","","color","accent",1,"tw-m-1",3,"click"],i];},template:function(n,i){n&1&&(m(0,"div",0)(1,"mat-form-field")(2,"mat-label"),u(3),l(),f(4,he,6,4)(5,Te,2,2),m(6,"mat-autocomplete",1,2),d("optionSelected",function(Ce){return i.optionSelected(Ce);})("szScrolled",function(){return i.scroll();}),F(8,Me,2,2,"mat-option",11,I),l(),f(10,Ee,2,0,"mat-error")(11,ge,2,0,"mat-error")(12,Ie,2,0,"mat-chip",3),l(),f(13,Fe,1,0,"mat-progress-bar",4),l()),n&2&&(a(3),R(i.label),a(),p(4,i.multiple?4:5),a(2),_("displayWith",i.szOptionFormatFn)("szScrollIgnored",i.indicator()),a(2),v(i.options),a(2),p(10,i.control.hasError("required")?10:-1),a(),p(11,i.control.hasError("invalid")?11:-1),a(),p(12,i.isNew&&!i.indicator()?12:-1),a(),p(13,i.indicator()?13:-1));},dependencies:[D,w,V,B,Y,X,k,G,j,te,Z,q,ee,Q,J,oe,ie,H,Se,pe,de,ue,ce,_e,W,K,le],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]{position:relative}mat-progress-bar[_ngcontent-%COMP%]{position:absolute;bottom:20px}"]});let t=o;return t;})();export{ve as a,ot as b};/**i18n:01970b5be1a6a06655fe4c3b2f38689bdabee61974e5aa4bcc571eb668de444c*/