import{a as C}from"./chunk-YT6CASAK.js";import{a as pe}from"./chunk-YNUTG2SB.js";import{a as Ee,b as de,c as _,f as ue,g as me}from"./chunk-QSKC3G63.js";import"./chunk-2KPNCTCB.js";import"./chunk-S7INMPNY.js";import"./chunk-25IBV356.js";import{b as re,f as ae,g as se,h as le,j as _e,k as Se}from"./chunk-SQCF3S47.js";import{a as p}from"./chunk-74BP7MNC.js";import"./chunk-RSYANUDV.js";import{a as x,b as k,d as q,e as Q,g as j}from"./chunk-FRBT2WCB.js";import{h as K,q as ee,r as te,s as oe,u as ie}from"./chunk-ZTT2CFXD.js";import"./chunk-HLTWUKSH.js";import"./chunk-276RQCOC.js";import{h as H,i as J}from"./chunk-2IPEL4E4.js";import{b as D,d as f,f as b,g as z,k as F,l as $,n as B,q as U,r as P,t as Y}from"./chunk-FY76SKRQ.js";import{b as m,c as ne}from"./chunk-IDQKS733.js";import"./chunk-RCHOHS2G.js";import"./chunk-W75G3ZKH.js";import"./chunk-5MQKWJS4.js";import{a as W,b as Z}from"./chunk-N4MQQJHL.js";import"./chunk-FJ4IFQWV.js";import{r as G,v as X,x as w}from"./chunk-4I74CWZL.js";import"./chunk-LLSKOB3G.js";import"./chunk-OWRQBV6B.js";import"./chunk-3AQJ5CSK.js";import{Eb as R,Jb as E,Kb as s,Lb as l,Wb as g,Yb as L,bb as a,ja as S,mb as y,mc as T,na as M,nc as N,rb as A,yb as r}from"./chunk-YAUSGWXJ.js";import"./chunk-QXHRBTK3.js";function Oe(i,n){if(i&1&&l(0,"sz-ui-form-field-select",7),i&2){let O=L();r("source",O.testTypeResultOptions);}}function Me(i,n){i&1&&(E(0,"div",10)(1,"mat-form-field",11)(2,"label"),l(3,"input",12),s()(),E(4,"mat-form-field",11)(5,"label"),l(6,"input",13),s()()());}function Re(i,n){i&1&&(E(0,"mat-form-field",11)(1,"label"),l(2,"input",14),s()());}function Te(i,n){if(i&1&&A(0,Me,7,0,"div",10)(1,Re,3,0,"mat-form-field",11),i&2){let O=L();R(O.isRange()?0:-1),a(),R(O.isRange()?-1:1);}}var ce=(()=>{let n=class n extends ae{constructor(){let e=S(x);super(e),this.mlabService=S(p),this.fb=S(P),this.data=S(k),this.units=[],this.testTypes=this.mlabService.testTypes.getAll({orderBy:["nameEn"]}),this.unitSelectConfig={autoSelect:!0},this.referenceGroups=this.mlabService.referenceGroups.getAll({orderBy:["nameEn"],filterBehavior:X.Or}),this.testTypeResultOptions=[],this.comparisonOperators=Object.keys(C).map(u=>C[u]),this.testTypeSelectConfig={optionSelectedFn:(u,c)=>{c&&this.testTypeSelected(c);}},this.isQuantitative=!1;let o=this.fb;this.dialog=e;let t=this.data;this.form=o.group({description:[t?.description,[f.maxLength(4096)]],testTypeId:[t?.testTypeId,[f.required]],unitId:[t?.unitId,[]],comparisonOperator:new F(t?.comparisonOperator??C.Range,[f.required]),referenceGroupId:[t?.referenceGroupId,[f.required]],value:[t?.value,[]],start:[t?.start,[]],end:[t?.end,[]],testTypeResultOptionId:[t?.testTypeResultOptionId,[]]});}testTypeSelected(e){e.unitId&&e.unit?this.getUnits(e.unit):this.units=[],this.testTypeResultOptions=[],e.testResultType===pe.Qualitative&&this.mlabService.testTypes.resultOptions.getAllItems(e.id,{orderBy:["nameEn"]}).pipe(K(this.indicator)).subscribe(o=>{o&&(this.testTypeResultOptions=o);});}getUnits(e){this.units=[e],this.form.patchValue({unitId:e?.id}),this.mlabService.unitConverters.getAllItems({filters:w.create().equal("toUnitId",e.id).filters()}).subscribe(o=>{this.units.push(...o.map(t=>t.fromUnit));});}isRange(){return this.form.value.comparisonOperator===C.Range;}submit(){this.IsValid()&&(this.data?this.save(this.mlabService.referenceValues.update(this.data.id,this.form.value)):this.save(this.mlabService.referenceValues.create(this.form.value)));}};n.ɵfac=function(o){return new(o||n)();},n.ɵcmp=M({type:n,selectors:[["sz-medisy-laboratory-reference-values-save"]],standalone:!0,features:[T([p]),y,N],decls:13,vars:13,consts:()=>{let e;e="\u0646\u0645\u0637 \u0627\u062E\u062A\u0628\u0627\u0631";let o;o="\u0648\u0627\u062D\u062F\u0629";let t;t="\u0627\u0644\u0641\u0626\u0629 \u0627\u0644\u0645\u0631\u062C\u0639\u064A\u0629";let u;u="\u0627\u0644\u0639\u0645\u0644\u064A\u0629";let c;c="\u0642\u064A\u0645\u0629";let h;h="\u0627\u0644\u0648\u0635\u0641";let I;I="\u0628\u062F\u0627\u064A\u0629";let V;V="\u0646\u0647\u0627\u064A\u0629";let v;return v="\u0642\u064A\u0645\u0629",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],[1,"sz-form-row"],["formControlName","testTypeId","label",e,3,"source","config"],["formControlName","unitId","label",o,3,"source","config"],["formControlName","referenceGroupId","label",t,3,"source"],["formControlName","comparisonOperator","label",u,3,"source","localizedValue"],["formControlName","testTypeResultOptionId","label",c,3,"source"],["formControlName","description","label",h],[3,"actions"],[1,"tw-flex","md:tw-flex-row","tw-flex-col","md:tw-gap-4"],[1,"tw-flex-1"],["autocomplete","off","formControlName","start","matInput","","placeholder",I],["autocomplete","off","formControlName","end","matInput","","placeholder",V],["autocomplete","off","formControlName","value","matInput","","placeholder",v]];},template:function(o,t){o&1&&(l(0,"sz-ui-dialog-header",0),E(1,"mat-dialog-content")(2,"form",1)(3,"div",2),l(4,"sz-ui-form-field-select",3)(5,"sz-ui-form-field-select",4),s(),E(6,"div",2),l(7,"sz-ui-form-field-select",5)(8,"sz-ui-form-field-select",6),s(),A(9,Oe,1,1,"sz-ui-form-field-select",7)(10,Te,2,2),l(11,"sz-ui-form-field-textarea",8),s()(),l(12,"sz-ui-dialog-actions",9)),o&2&&(r("title",t.title)("subtitle",t.subtitle)("alert",t.alert()),a(2),r("formGroup",t.form),a(2),r("source",t.testTypes)("config",t.testTypeSelectConfig),a(),r("source",t.units)("config",t.unitSelectConfig),a(2),r("source",t.referenceGroups),a(),r("source",t.comparisonOperators)("localizedValue",!0),a(),R(t.isQuantitative?10:9),a(3),r("actions",t.actions));},dependencies:[Y,$,D,b,z,B,U,j,Q,J,H,ee,Se,se,le,ie,oe,te],encapsulation:2});let i=n;return i;})();var fe=(()=>{let n=class n{constructor(){this.dialog=S(q),this.mlabService=S(p),this.router=S(G),this.dataSource=new ue(),this.appBarConfig={title:W.reference_values,menu:ne.default().setItems([m.add(this.openSaveComponent.bind(this)),m.menu([m.search()])])},this.dataSource.columnDefs.push(_.uuid("id"),_.hyperlink("testType.nameEn").setStacked(_.string("description").setValueClassFontSmall()),_.string("unit").setValueGetter(e=>e.unit?.symbol),_.enum("comparisonOperator").setValueGetter(e=>Z(e.comparisonOperator)),_.number("_value").setValueGetter(e=>e.testTypeResultOption?e.testTypeResultOption.nameEn:e.value!==null?e.value:`${e.start} - ${e.end}`).setHeaderSortable(!1),_.date("createdAt").setVisible(!1),_.date("updatedAt").setVisible(!1),_.menu([m.edit(this.openSaveComponent.bind(this)),m.divider(),m.delete(this.openReferenceValueDeleteComponent.bind(this))])),this.get();}openSaveComponent(e){this.dialog.open(ce,{data:e}).afterClosed().subscribe(o=>{this.dataSource.addOrUpdateItem(o);});}openReferenceValueDeleteComponent(e){this.dialog.open(_e,{data:re.delete(this.mlabService.referenceValues.delete(e.id),e)}).afterClosed().subscribe(o=>{this.dataSource.delete(o);});}get(){this.mlabService.referenceValues.get(this.dataSource.getQuery()).pipe(me(this.dataSource.state)).subscribe(e=>{this.dataSource.set(e.items,e.count);});}};n.ɵfac=function(o){return new(o||n)();},n.ɵcmp=M({type:n,selectors:[["sz-medisy-laboratory-reference-values"]],standalone:!0,features:[T([p]),N],decls:2,vars:3,consts:[[3,"changed","config","dataSource"],[3,"update","dataSource"]],template:function(o,t){o&1&&(E(0,"sz-ui-table-bar",0),g("changed",function(){return t.get();}),s(),E(1,"sz-ui-table",1),g("update",function(){return t.get();}),s()),o&2&&(r("config",t.appBarConfig)("dataSource",t.dataSource),a(),r("dataSource",t.dataSource));},dependencies:[Ee,de],encapsulation:2});let i=n;return i;})();var ot=[{path:"",component:fe}];export{ot as default};/**i18n:359c45a37699f2cf41ff2ce7681094fb8642750bd9400ade44324692d4b7d733*/