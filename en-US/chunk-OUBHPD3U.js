import{c as ne}from"./chunk-SYMCIFNI.js";import{a as re}from"./chunk-6YC7OI6U.js";import{a,b as te,d as oe,f as ie,i as ae,j as se}from"./chunk-TI3KPOR7.js";import{a as u}from"./chunk-Q2N4ZM5T.js";import{e as J,f as K,g as W,i as Z,j as x,k as ee}from"./chunk-OPST3HSR.js";import{g as q,j as C}from"./chunk-JHC5R5G3.js";import{a as P,b as Y,d as V,e as $,g as j}from"./chunk-5MAY3I4F.js";import{c as X,s as H,v as Q}from"./chunk-RZLFWLWK.js";import{c as M}from"./chunk-4GL34ATX.js";import{c as y,d as w}from"./chunk-OPRLBPJZ.js";import{f as I,g as b,k as v,m as L,p as D,q as z,t as R}from"./chunk-ZBCFQZ6O.js";import{a as G,c as F,e as B}from"./chunk-IWB7BCZA.js";import{a as k,c as U}from"./chunk-FBMLFETS.js";import{Bb as s,Fc as N,Ja as d,Lb as n,Mb as S,Nb as _,Xb as A,Yb as f,f as g,gb as m,hb as p,na as c,nc as O,oc as T,sb as h,x as E}from"./chunk-75X3YXCS.js";var le=(()=>{let i=class i extends J{constructor(e,t,o,l){super(o),this.mlabService=e,this.fb=t,this.dialog=o,this.data=l,this.testGroups=this.mlabService.testGroups.getAll({orderBy:["name"]}),this.form=t.group({testGroupId:[l?.testGroupId,[]],note:[l?.note,[]]});}submit(){this.IsValid()&&this.data&&this.save(this.mlabService.analyses.tests.update(this.data.analysisId,this.data.id,this.form.value));}};i.ɵfac=function(t){return new(t||i)(p(u),p(z),p(P),p(Y));},i.ɵcmp=c({type:i,selectors:[["sz-medisy-laboratory-analysis-tests-save"]],standalone:!0,features:[h,T],decls:6,vars:5,consts:()=>{let e;e="Test Group";let t;return t="Note",[[3,"header"],[1,"sz-form",3,"formGroup"],["formControlName","testGroupId","label",e,3,"source","emptyOption"],["formControlName","note","label",t],[3,"actions"]];},template:function(t,o){t&1&&(_(0,"sz-ui-dialog-header",0),n(1,"mat-dialog-content")(2,"form",1),_(3,"sz-ui-form-field-select",2)(4,"sz-ui-form-field-input",3),S()(),_(5,"sz-ui-dialog-actions",4)),t&2&&(s("header",o.header),m(2),s("formGroup",o.form),m(),s("source",o.testGroups)("emptyOption",!0),m(2),s("actions",o.actions));},dependencies:[R,v,I,b,L,D,j,$,x,K,W,Q,X,H],encapsulation:2});let r=i;return r;})();var Xe=(()=>{let i=class i{set analysis(e){this._analysis=e,this.get();}get analysis(){return this._analysis;}constructor(){this.route=d(G),this.router=d(F),this.dialog=d(V),this.locale=d(N),this.mlabService=d(u),this.dataSource=new oe(["test.testType.name","-testId"]),this.dataSource.columnDefs.push(a.uuid("id"),a.icon("test.state").setValueGetter(e=>ne(e.test.state)).setValueTooltip(e=>w(e.test.state)),a.string("test.testType.name").setValueClassFontBold().setClickFn(e=>this.router.navigate([`/mlab/analyses/${e.analysisId}/tests/${e.id}`])).setStacked([a.string("test.laboratory.name").setValueClassFontSmall()]),a.string("test.referenceGroup.name").setName(y.referenceGroup).setVisibility(!1),a.string("note").setVisibility(!1),a.date("createdAt",!1),a.date("updatedAt",!1),te.menu([C.edit(e=>this.openSaveComponent(e)),q.divider(),C.delete(e=>this.openDeleteComponent(e))])),this.dataSource.groupDefs={key:"testGroupId",name:y.testGroup,nameGetterFn:e=>e.testGroup?.name??y.single};}openAnalysisTestTypeAddComponent(){return g(this,null,function*(){let e=yield E(this.dialog.open(re,{data:this.analysis.laboratoryId}).afterClosed());e&&this.mlabService.analyses.tests.create(this.analysis.id,{laboratoryTestTypeId:e.laboratoryTestType.id,transferOutLaboratoryId:e.transferOutLaboratoryId}).pipe(M(this.dataSource.indicator)).subscribe(t=>{t&&this.get();});});}openSaveComponent(e){this.dialog.open(le,{data:e}).afterClosed().subscribe(t=>{t&&this.get();});}openDeleteComponent(e){this.dialog.open(Z,{data:ee.delete(this.mlabService.analyses.tests.delete(e.analysisId,e.id),e)}).afterClosed().subscribe(t=>{this.dataSource.delete(t);});}get(){this.mlabService.analyses.tests.get(this.analysis.id,this.dataSource.getQuery()).pipe(M(this.dataSource.indicator)).subscribe(e=>{this.dataSource.set(e.items,e.count);});}};i.ɵfac=function(t){return new(t||i)();},i.ɵcmp=c({type:i,selectors:[["sz-medisy-laboratory-analysis-tests"]],inputs:{analysis:"analysis"},standalone:!0,features:[O([u]),T],decls:5,vars:3,consts:()=>{let e;return e="Add",[[3,"dataSource","changed"],["mat-flat-button","","color","primary","start","",3,"click"],e,[3,"stateEnabled","dataSource","update"]];},template:function(t,o){t&1&&(n(0,"sz-ui-table-search-filter",0),f("changed",function(){return o.get();}),n(1,"button",1),f("click",function(){return o.openAnalysisTestTypeAddComponent();}),n(2,"span"),A(3,2),S()()(),n(4,"sz-ui-table",3),f("update",function(){return o.get();}),S()),t&2&&(s("dataSource",o.dataSource),m(4),s("stateEnabled",!0)("dataSource",o.dataSource));},dependencies:[B,se,ae,ie,U,k],encapsulation:2});let r=i;return r;})();export{Xe as a};/**i18n:1c5a057012127d5b8d089498ac661b5227d0455136ea3b9f25a2d8940ec324d8*/