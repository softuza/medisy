import{a as I}from"./chunk-7UXJZKLD.js";import{a as x,b as D,c as j,e as X,f as k,g as U,h as H}from"./chunk-QNM6XM36.js";import{c as Y}from"./chunk-LSGNN774.js";import{b as W,f as Z}from"./chunk-UAYSR4LM.js";import{a as Q}from"./chunk-624ACHJE.js";import{a as J,b as K}from"./chunk-D5DPYT77.js";import{a as V,b as q}from"./chunk-QA36KWKY.js";import{i as P}from"./chunk-IRV2WS2J.js";import{d as s,f as E,g as b,k as T,m as G,p as A,r as z,t as R}from"./chunk-ZBCFQZ6O.js";import"./chunk-R4BMO6PH.js";import{c as C}from"./chunk-IWB7BCZA.js";import{a as B,c as w}from"./chunk-FBMLFETS.js";import{ga as $,ha as F}from"./chunk-VGXLPPL2.js";import"./chunk-K7SXQZKF.js";import{Bb as _,Fc as h,Gb as y,Lb as a,Mb as c,Nb as d,Xb as O,Yb as N,f as u,g as L,gb as g,hb as n,na as p,nc as f,oc as M,rb as S,xb as v}from"./chunk-75X3YXCS.js";function oe(r,o){r&1&&d(0,"mat-progress-bar",11);}var be=(()=>{let o=class o{constructor(e,t,i,m){this.locale=e,this.fb=t,this.router=i,this.identityService=m,this.alert=S(void 0),this.indicator=S(!1),this.subscriptions=new L();let l=this.identityService.storage.get();this.form=this.fb.group({email:[l?.username,[s.required,s.minLength(1),s.email]],organization:[l?.realm,[s.required,s.minLength(3),s.maxLength(255)]]}),this.subscribeChanges();}ngOnDestroy(){this.subscriptions.unsubscribe();}subscribeChanges(){this.subscriptions.add(this.form.controls.email.valueChanges.subscribe(e=>{this.emailChanged(e);}));}emailChanged(e){let t=e.indexOf("@");if(t>0){let i=e.indexOf(".",t);this.form.controls.organization.setValue(e.substring(t+1,i>0?i:e.length));}}login(){return u(this,null,function*(){if(!Z(this.form))return!1;this.indicator.set(!0);let e=this.identityService.storage.set({realm:this.form.value.organization,username:this.form.value.email});return yield this.authInitialize(e),this.indicator.set(!1),!0;});}authInitialize(e){return u(this,null,function*(){try{if(yield this.identityService.initialize(e)){this.router.navigate(["/"]);return;}yield this.identityService.login({loginHint:e.username,locale:this.locale,redirectUri:this.identityService.getAuthRedirectUri()});}catch{this.alert.set({message:"Faield to login",type:Q.Error,timeout:5e3});}});}};o.ɵfac=function(t){return new(t||o)(n(h),n(z),n(C),n(I));},o.ɵcmp=p({type:o,selectors:[["sz-iam-auth-login"]],standalone:!0,features:[f([]),M],decls:18,vars:4,consts:()=>{let e;e="Login";let t;t="Email";let i;i="Organization";let m;return m="Login",[[1,"content-center"],["svgIcon","logo",1,"logo"],[1,"tw-m-2"],e,[2,"padding","16px"],[3,"alert"],[3,"formGroup","keyup.enter"],["formControlName","email","label",t],["formControlName","organization","label",i],["mat-button","",1,"button-submit",3,"disabled","click"],m,["mode","indeterminate"]];},template:function(t,i){t&1&&(a(0,"div",0),d(1,"mat-icon",1),a(2,"mat-card",2)(3,"mat-card-header")(4,"mat-card-title"),O(5,3),c()(),a(6,"mat-card-content",4),d(7,"sz-ui-alert",5),a(8,"form",6),N("keyup.enter",function(){return i.login();}),d(9,"sz-ui-form-field-input",7)(10,"sz-ui-form-field-input",8),c(),d(11,"mat-divider"),c(),a(12,"mat-card-actions")(13,"button",9),N("click",function(){return i.login();}),a(14,"span"),O(15,10),c()()(),a(16,"mat-card-footer"),v(17,oe,1,0,"mat-progress-bar",11),c()()()),t&2&&(g(7),_("alert",i.alert()),g(),_("formGroup",i.form),g(5),_("disabled",i.indicator()),g(4),y(17,i.indicator()?17:-1));},dependencies:[R,T,E,b,G,A,H,x,X,j,U,k,D,K,J,P,F,$,q,V,w,B,W,Y],styles:[".content-center[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}.logo[_ngcontent-%COMP%]{width:128px;height:128px;transform:scale(2);margin:16px}.button-submit[_ngcontent-%COMP%]{width:100%}.actions[_ngcontent-%COMP%]{text-align:center;margin:16px 0;font-size:12px;cursor:pointer}"]});let r=o;return r;})();var Pe=(()=>{let o=class o{constructor(e,t,i){this.locale=e,this.router=t,this.identityService=i;}ngOnInit(){return u(this,null,function*(){let e=this.identityService.storage.get();if(!e){this.router.navigate(["/auth/login"]);return;}if(yield this.identityService.initialize(e)){this.router.navigate(["/"]);return;}yield this.identityService.login({loginHint:e.username,locale:this.locale,redirectUri:this.identityService.getAuthRedirectUri()});});}};o.ɵfac=function(t){return new(t||o)(n(h),n(C),n(I));},o.ɵcmp=p({type:o,selectors:[["sz-iam-auth-redirect"]],standalone:!0,features:[f([]),M],decls:0,vars:0,template:function(t,i){},encapsulation:2});let r=o;return r;})();export{be as SzAuthLoginComponent,Pe as SzAuthRedirectComponent};/**i18n:1c5a057012127d5b8d089498ac661b5227d0455136ea3b9f25a2d8940ec324d8*/