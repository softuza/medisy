import{a as M}from"./chunk-JQINIKT6.js";import{a as Re}from"./chunk-6BGND3PV.js";import{a as m,d as he,e as Le,f as Ie,i as ve,j as b}from"./chunk-UMQZRE5E.js";import"./chunk-RCVS45O2.js";import"./chunk-PXWWDYTP.js";import{a as Ce}from"./chunk-6Q3GIAKO.js";import{a as f}from"./chunk-75LL5PNS.js";import"./chunk-R3ZFNPLW.js";import{b as Ne,f as Te,g as ge,h as Ve,j as Ae,k as v}from"./chunk-UXK6PSGI.js";import{a as I}from"./chunk-LLZ7TKB3.js";import{d as Me,j as u,k as Oe}from"./chunk-EVGSYUOK.js";import{a as ie,b as ne,d as A,e as ae,g as h}from"./chunk-M5V3PZRJ.js";import{a as _e,b as ce,q as L,r as fe,s as Se,t as Ee}from"./chunk-VUCYJ2HO.js";import"./chunk-CVH4P2E2.js";import"./chunk-443GWC6S.js";import"./chunk-SYXG226D.js";import"./chunk-J5ICTFNH.js";import{h as le,i as se,k as me}from"./chunk-D5DHQUZL.js";import{b as X,d as g,f as j,g as k,k as q,l as H,n as W,q as Q,r as J,t as K,u as Z}from"./chunk-EOQNX5GG.js";import{Y as pe,Z as de,r as te,t as oe}from"./chunk-I2SD3VIP.js";import{a as V,d as ee}from"./chunk-TM5JFVB7.js";import"./chunk-NUQX3XTB.js";import{ia as re,la as ue}from"./chunk-Y7HMALTZ.js";import"./chunk-HTTNJI4B.js";import{Eb as N,Jb as p,Kb as d,Lb as l,Wb as D,Yb as z,ab as s,bb as O,ea as Y,f as G,ja as c,mc as C,na as E,nc as T,oa as w,pb as x,ub as y,yb as a}from"./chunk-PGHKBHIM.js";import{c as $}from"./chunk-7NJ6IGLQ.js";function De(r,e){if(r&1&&l(0,"sz-ui-form-field-select",4),r&2){let R=z();a("source",R.testTypeResultOptions);}}function ze(r,e){r&1&&(p(0,"div",7)(1,"mat-form-field",8)(2,"label"),l(3,"input",9),d()(),p(4,"mat-form-field",8)(5,"label"),l(6,"input",10),d()()());}function Be(r,e){r&1&&(p(0,"mat-form-field",8)(1,"label"),l(2,"input",11),d()());}function Pe(r,e){if(r&1&&y(0,ze,7,0,"div",7)(1,Be,3,0,"mat-form-field",8),r&2){let R=z();N(R.isRange()?0:-1),s(),N(R.isRange()?-1:1);}}var be=(()=>{let e=class e extends Te{constructor(t,o,i,n){super(i),this.mlabService=t,this.fb=o,this.dialog=i,this.data=n,this.referenceGroups=this.mlabService.referenceGroups.getAll({orderBy:["nameEn"],filterBehavior:te.Or,filters:oe.create().equalIf("id",this.data.referenceValueRule?.referenceGroupId).notAny("referenceValueRules.referenceValueId",[this.data.referenceValue.id]).filters()}),this.testTypeResultOptions=this.mlabService.testTypes.resultOptions.getAll(this.data.referenceValue.testTypeId,{orderBy:["nameEn"]}),this.comparisonOperators=Object.keys(M).map(_=>M[_]),this.form=o.group({description:[n.referenceValueRule?.description,[g.maxLength(4096)]],comparisonOperator:new q(n.referenceValueRule?.comparisonOperator??M.Equal,[g.required]),referenceGroupId:[n.referenceValueRule?.referenceGroupId,[g.required]],value:[n.referenceValueRule?.value,[]],start:[n.referenceValueRule?.start,[]],end:[n.referenceValueRule?.end,[]],testTypeResultOptionId:[n.referenceValueRule?.testTypeResultOptionId,[]]});}isRange(){return this.form.value.comparisonOperator===M.RangeWithBoundaries||this.form.value.comparisonOperator===M.RangeWithoutBoundaries;}submit(){this.IsValid()&&(this.data.referenceValueRuleId?this.save(this.mlabService.referenceValues.rules.update(this.data.referenceValue.id,this.data.referenceValueRuleId,this.form.value)):this.save(this.mlabService.referenceValues.rules.create(this.data.referenceValue.id,this.form.value)));}};e.ɵfac=function(o){return new(o||e)(O(f),O(J),O(ie),O(ne));},e.ɵcmp=E({type:e,selectors:[["sz-medisy-laboratory-reference-value-rules-save"]],standalone:!0,features:[C([]),x,T],decls:9,vars:9,consts:()=>{let t;t="Reference Group";let o;o="Comparison Operator";let i;i="Value";let n;n="Description";let _;_="Start";let F;F="End";let U;return U="Value",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","referenceGroupId","label",t,3,"source"],["formControlName","comparisonOperator","label",o,3,"source","localizedValue"],["formControlName","testTypeResultOptionId","label",i,3,"source"],["formControlName","description","label",n],[3,"actions"],[1,"tw-flex","md:tw-flex-row","tw-flex-col","md:tw-gap-4"],[1,"tw-flex-1"],["autocomplete","off","formControlName","start","matInput","","placeholder",_],["autocomplete","off","formControlName","end","matInput","","placeholder",F],["autocomplete","off","formControlName","value","matInput","","placeholder",U]];},template:function(o,i){o&1&&(l(0,"sz-ui-dialog-header",0),p(1,"mat-dialog-content")(2,"form",1),l(3,"sz-ui-form-field-select",2)(4,"sz-ui-form-field-select",3),y(5,De,1,1,"sz-ui-form-field-select",4)(6,Pe,2,2),l(7,"sz-ui-form-field-textarea",5),d()(),l(8,"sz-ui-dialog-actions",6)),o&2&&(a("title",i.title)("subtitle",i.subtitle)("alert",i.alert()),s(2),a("formGroup",i.form),s(),a("source",i.referenceGroups),s(),a("source",i.comparisonOperators)("localizedValue",!0),s(),N(i.data.referenceValue.testType.hasResultOptions?5:6),s(3),a("actions",i.actions));},dependencies:[Z,H,X,j,k,W,Q,ce,_e,le,h,ae,se,L,v,ge,Ve,Ee,Se,fe],encapsulation:2});let r=e;return r;})();var P=(()=>{let e=class e{constructor(){this.dialog=c(A),this.mlabService=c(f),this.route=c(V),this.dataSource=new he(),this.referenceValue=this.route.snapshot.data.referenceValue,this.appBarConfig={title:pe.rules,subtitle:this.referenceValue.testType.nameEn,backEnabled:!0,backUrl:`/${Ce.ReferenceValues}`,menu:Oe.default().setItems([u.add(this.openSaveComponent.bind(this)),u.menu([u.search(),u.filter()])])},this.dataSource.columnDefs.push(m.uuid("id"),m.string("referenceGroup.nameEn").setValueClassFontBold().setStacked(m.string("referenceGroup.description").setStyleSmall()),m.enum("comparisonOperator").setValueGetter(t=>de(t.comparisonOperator)),m.number("_value").setValueGetter(t=>t.testTypeResultOption?t.testTypeResultOption.nameEn:t.value!==null?t.value:`${t.start} - ${t.end}`).setHeaderSortable(!1),m.date("createdAt").setVisible(!1),m.date("updatedAt").setVisible(!1),m.menu([u.edit(this.openSaveComponent.bind(this)),u.clone(t=>{let _=t,{id:o,referenceGroupId:i}=_,n=$(_,["id","referenceGroupId"]);this.openSaveComponent(n);}),u.divider(),u.delete(this.openReferenceValueRuleDeleteComponent.bind(this))]));}ngOnInit(){this.get();}openSaveComponent(t){this.dialog.open(be,{data:{referenceValue:this.referenceValue,referenceValueRule:t,referenceValueRuleId:t?.id}}).afterClosed().subscribe(o=>{this.dataSource.addOrUpdateItem(o);});}openReferenceValueRuleDeleteComponent(t){this.dialog.open(Ae,{data:Ne.delete(this.mlabService.referenceValues.rules.delete(t.referenceValueId,t.id),t)}).afterClosed().subscribe(o=>{this.dataSource.delete(o);});}get(){this.mlabService.referenceValues.rules.get(this.referenceValue.id,this.dataSource.getQuery()).pipe(Le(this.dataSource.state)).subscribe(t=>{this.dataSource.set(t.items,t.count);});}};e.ɵfac=function(o){return new(o||e)();},e.ɵcmp=E({type:e,selectors:[["sz-medisy-laboratory-reference-value-rules"]],standalone:!0,features:[C([f]),T],decls:2,vars:3,consts:[[3,"changed","config","dataSource"],["content","",3,"update","dataSource"]],template:function(o,i){o&1&&(p(0,"sz-ui-table-bar",0),D("changed",function(){return i.get();}),d(),p(1,"sz-ui-table",1),D("update",function(){return i.get();}),d()),o&2&&(a("config",i.appBarConfig)("dataSource",i.dataSource),s(),a("dataSource",i.dataSource));},dependencies:[b,ve,Ie],encapsulation:2});let r=e;return r;})();var ye=(()=>{let e=class e{constructor(){this.dialog=c(A),this.route=c(V),this.alert$=new G(),this.referenceValue=this.route.snapshot.data.referenceValue,this.appBarConfig={title:this.referenceValue.testType.nameEn,subtitle:this.referenceValue.description,backEnabled:!0};}};e.ɵfac=function(o){return new(o||e)();},e.ɵcmp=E({type:e,selectors:[["sz-medisy-laboratory-reference-value"]],features:[C([])],decls:1,vars:1,consts:[[3,"config"]],template:function(o,i){o&1&&l(0,"sz-ui-app-bar",0),o&2&&a("config",i.appBarConfig);},dependencies:[I],encapsulation:2});let r=e;return r;})();var Ht=(()=>{let e=class e{};e.ɵfac=function(o){return new(o||e)();},e.ɵmod=w({type:e}),e.ɵinj=Y({providers:[f],imports:[K,ee.forChild([{path:"",component:ye},{path:"rules",component:P}]),h,L,Me,re,ue,me,b,Re,v,I,P]});let r=e;return r;})();export{Ht as ReferenceValueModule};/**i18n:5a2c0bc94bbf1ef498664455a9d60582c29bc498832d9f320f89c95b436c0516*/