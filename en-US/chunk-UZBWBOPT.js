import{c as Se}from"./chunk-JITIZZPB.js";import{a as me}from"./chunk-37YBARO5.js";import{a as d,b as re,d as ae,f as se,i as ne,j as le}from"./chunk-7U2WIWHF.js";import{a as S}from"./chunk-5KKUQUDS.js";import{e as F,f as G,g as Y,i as oe,j as V,k as ie}from"./chunk-WN2NFEA2.js";import{e as z,g as te,h as P}from"./chunk-Q5LDCOCY.js";import{a as L,b,d as Q,e as R,g as v}from"./chunk-IAMBMKDI.js";import{c as D,q as Z,s as x,t as ee}from"./chunk-3ZKUNSZU.js";import{c as $}from"./chunk-KVZ22XWW.js";import{c as T,d as W}from"./chunk-LMCANXRL.js";import{d as B,f as M,g as y,k as C,m as N,p as I,q as O,t as h}from"./chunk-KAOE4CKM.js";import{a as H,c as w,e as q}from"./chunk-4YTU7KIA.js";import{ia as J,ka as K}from"./chunk-WG6MZMNK.js";import{Db as r,Hc as k,Ma as j,Nb as m,Ob as p,Pb as u,Zb as X,_b as E,hb as s,ib as n,pa as _,pc as g,qc as f,ta as U,ua as c,ub as A}from"./chunk-WLX3OMWV.js";var ue=(()=>{let i=class i extends F{constructor(e,t,o,l){super(t),this.fb=e,this.dialog=t,this.mlabService=o,this.data=l,this.referenceValueRules=null,this.testTypeResultOptions=null,this.form=e.group({value:[null,[B.required]],note:[null,[B.maxLength(4096)]]}),console.log("data",l);}submit(){this.IsValid()&&this.dialog.close({laboratoryTestType:this.form.value.testType,transferOutLaboratoryId:this.form.getRawValue().transferOutLaboratoryId});}};i.ɵfac=function(t){return new(t||i)(n(O),n(L),n(S),n(b));},i.ɵcmp=c({type:i,selectors:[["sz-medisy-laboratory-analysis-test-result-save"]],standalone:!0,features:[g([S]),A,f],decls:6,vars:6,consts:()=>{let e;e="Value";let t;return t="Note",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","value","label",e,3,"type"],["formControlName","note","label",t],[3,"actions"]];},template:function(t,o){t&1&&(u(0,"sz-ui-dialog-header",0),m(1,"mat-dialog-content")(2,"form",1),u(3,"sz-ui-form-field-input",2)(4,"sz-ui-form-field-textarea",3),p()(),u(5,"sz-ui-dialog-actions",4)),t&2&&(r("title",o.title)("subtitle",o.subtitle)("alert",o.alert()),s(2),r("formGroup",o.form),s(),r("type","number"),s(2),r("actions",o.actions));},dependencies:[h,C,M,y,N,I,v,R,V,G,Y,D,x],encapsulation:2});let a=i;return a;})();var pe=(()=>{let i=class i extends F{constructor(e,t,o,l){super(o),this.mlabService=e,this.fb=t,this.dialog=o,this.data=l,this.testGroups=this.mlabService.testGroups.getAll({orderBy:["name"]}),this.form=t.group({testGroupId:[l?.testGroupId,[]],note:[l?.note,[]]});}submit(){this.IsValid()&&this.data&&this.save(this.mlabService.analyses.tests.update(this.data.analysisId,this.data.id,this.form.value));}};i.ɵfac=function(t){return new(t||i)(n(S),n(O),n(L),n(b));},i.ɵcmp=c({type:i,selectors:[["sz-medisy-laboratory-analysis-tests-save"]],standalone:!0,features:[A,f],decls:6,vars:7,consts:()=>{let e;e="Test Group";let t;return t="Note",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","testGroupId","label",e,3,"source","emptyOption"],["formControlName","note","label",t],[3,"actions"]];},template:function(t,o){t&1&&(u(0,"sz-ui-dialog-header",0),m(1,"mat-dialog-content")(2,"form",1),u(3,"sz-ui-form-field-select",2)(4,"sz-ui-form-field-input",3),p()(),u(5,"sz-ui-dialog-actions",4)),t&2&&(r("title",o.title)("subtitle",o.subtitle)("alert",o.alert()),s(2),r("formGroup",o.form),s(),r("source",o.testGroups)("emptyOption",!0),s(2),r("actions",o.actions));},dependencies:[h,C,M,y,N,I,v,R,V,G,Y,ee,D,Z],encapsulation:2});let a=i;return a;})();var it=(()=>{let i=class i{constructor(){this.route=_(H),this.router=_(w),this.dialog=_(Q),this.locale=_(k),this.mlabService=_(S),this.analysis=j.required(),this.dataSource=new ae(["test.testType.name","-testId"]),this.dataSource.columnDefs.push(d.uuid("id"),d.icon("test.state").setValueGetter(e=>Se(e.test.state)).setValueTooltip(e=>W(e.test.state)),d.string("test.testType.name").setValueClassFontBold().setClickFn(e=>this.router.navigate([`/mlab/analyses/${e.analysisId}/tests/${e.id}`])).setStacked([d.string("test.laboratory.name").setValueClassFontSmall()]),d.string("test.referenceGroup.name").setName(T.referenceGroup).setVisible(!1),d.string("note").setVisible(!1),d.date("createdAt").setVisible(!1),d.date("updatedAt").setVisible(!1),re.menu([z.item(T.testResult,te.science,e=>this.openAnalysisTestResultSaveComponent(e.test)),z.divider(),P.edit(e=>this.openSaveComponent(e)),z.divider(),P.delete(e=>this.openDeleteComponent(e))])),this.dataSource.groupDefs={key:"testGroupId",name:T.testGroup,nameGetterFn:e=>e.testGroup?.name??T.single};}ngOnInit(){this.get();}openAnalysisTestTypeAddComponent(){this.dialog.open(me,{data:this.analysis().laboratoryId}).afterClosed().subscribe(e=>{e&&this.mlabService.analyses.tests.create(this.analysis().id,{laboratoryTestTypeId:e.laboratoryTestType.id,transferOutLaboratoryId:e.transferOutLaboratoryId}).pipe($(this.dataSource.indicator)).subscribe(t=>{t&&this.get();});});}openAnalysisTestResultSaveComponent(e){this.dialog.open(ue,{data:e}).afterClosed().subscribe(t=>{});}openSaveComponent(e){this.dialog.open(pe,{data:e}).afterClosed().subscribe(t=>{t&&this.get();});}openDeleteComponent(e){this.dialog.open(oe,{data:ie.delete(this.mlabService.analyses.tests.delete(e.analysisId,e.id),e)}).afterClosed().subscribe(t=>{this.dataSource.delete(t);});}get(){this.mlabService.analyses.tests.get(this.analysis().id,this.dataSource.getQuery()).pipe($(this.dataSource.indicator)).subscribe(e=>{this.dataSource.set(e.items,e.count);});}};i.ɵfac=function(t){return new(t||i)();},i.ɵcmp=c({type:i,selectors:[["sz-medisy-laboratory-analysis-tests"]],inputs:{analysis:[U.SignalBased,"analysis"]},standalone:!0,features:[g([S]),f],decls:5,vars:3,consts:()=>{let e;return e="Add",[e,[3,"changed","dataSource"],["mat-flat-button","","color","primary","start","",3,"click"],[3,"update","stateEnabled","dataSource"]];},template:function(t,o){t&1&&(m(0,"sz-ui-table-search-filter",1),E("changed",function(){return o.get();}),m(1,"button",2),E("click",function(){return o.openAnalysisTestTypeAddComponent();}),m(2,"span"),X(3,0),p()()(),m(4,"sz-ui-table",3),E("update",function(){return o.get();}),p()),t&2&&(r("dataSource",o.dataSource),s(4),r("stateEnabled",!0)("dataSource",o.dataSource));},dependencies:[q,le,ne,se,K,J],encapsulation:2});let a=i;return a;})();export{it as a};/**i18n:a84518dfaf5206df012bb98d831270fba229ecfbff1c9dff1ac7013a5ea5bd1b*/