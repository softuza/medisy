import{b as T}from"./chunk-RRFGQVGH.js";import{a as Ne,b as Oe,c as ue,d as pe,e as fe}from"./chunk-4T4R43QE.js";import{a as C}from"./chunk-6NA5VWKS.js";import{a as f}from"./chunk-MR5MUTQT.js";import{f as Se,g as Ce,h as Me,k as de}from"./chunk-D7LANVDJ.js";import{a as K,b as Q,e as U,g as Z}from"./chunk-2ZFTWFYD.js";import{c as ee,d as oe,h as te,i as ie,j as _e,o as le,p as ae,q as Ee,r as re,u as se}from"./chunk-ATPZCT2T.js";import{c as O}from"./chunk-GBADWWUE.js";import{d as E,f as W,g as k,k as V,l as w,o as H,r as j,s as q,u as J}from"./chunk-Y37CXB4J.js";import{a as me}from"./chunk-Y5YQXPZA.js";import{a as ne}from"./chunk-OLLDNXUJ.js";import{Jb as a,Kb as _,Lb as l,Vb as d,a as B,bb as s,gc as N,ja as S,mb as Y,mc as v,na as X,nc as x,s as F,yb as r}from"./chunk-WG6S32LW.js";import{a as M,b as p}from"./chunk-7DSIBXHM.js";var Qe=(()=>{let m=class m extends Se{constructor(){let e=S(K);super(e),this.mpplService=S(f),this.fb=S(q),this.data=S(Q),this.nationalities=this.mpplService.nationalities.getAll({orderBy:["name"]}),this.languages=this.mpplService.languages.getAll({orderBy:["name"]}),this.sexes=Object.keys(T).map(n=>T[n]),this.subscriptions=new B(),this.titles=this.mpplService.titles.get(p(M({},O.unpaged()),{orderBy:"name"})),this.titleAutoCompleteConfig={valueChangedFn:n=>(typeof n=="string"&&(this.titles=this.mpplService.titles.get(p(M({query:n},O.default()),{orderBy:"name"}))),!1),optionSelectedFn:n=>{n&&(this.form.value.sex||this.form.patchValue({sex:n.sex}));},optionDisplayWithFn:n=>n.name,optionValueFn:n=>n,suffixes:[{icon:me.save,tooltip:ne.save,hideOnLoading:!0,hideOnValid:!0,hideOnEmpty:!0,clickFn:n=>this.mpplService.titles.create({name:n})}]};let o=this.fb;this.dialog=e;let t=this.data;this.form=o.group({firstName:o.control(t?.firstName,[E.required,E.maxLength(128)]),lastName:o.control(t?.lastName,[E.required,E.maxLength(128)]),fatherName:o.control(t?.fatherFirstName?`${t.fatherFirstName} ${t?.lastName}`:null,[E.maxLength(128)]),motherName:o.control(t?.motherName,[E.maxLength(128)]),birthDate:o.control(t?.birthDate,[]),nationalityId:o.control(null,[]),ssn:o.control(t?.ssn,[E.maxLength(128)]),languageId:o.control(null,[E.required]),sex:o.control(null,[E.required]),title:o.control(null,[C.object()]),primaryEmail:[null,[E.email]],secondaryEmail:[null,[E.email]],mobilePhone:o.control(null,[C.startsWith("+")]),hasMobilePhoneWhatsapp:[!1,[]],homePhone:o.control(null,[C.startsWith("+")]),hasHomePhoneWhatsapp:[!1,[]],workPhone:o.control(null,[C.startsWith("+")]),hasWorkPhoneWhatsapp:[!1,[]],homeAddress:new V(t?.address)}),this.subscibeChanges();}subscibeChanges(){this.subscriptions.add(this.form.get("firstName")?.valueChanges.subscribe(e=>{if(!e||e===""){this.form.patchValue({sex:null,languageId:null});return;}else this.getGenders(e);}));}getGenders(e){!e||e.length<3||this.mpplService.autosuggestions.getGenders(M({query:e},O.minimal())).pipe(F(o=>o.items)).subscribe(o=>{!o||o.length===0||(this.form.value.sex||this.form.patchValue({sex:o[0].sex}),this.form.value.languageId||this.form.patchValue({languageId:o[0].languageId}));});}submit(){if(!this.IsValid())return;let e=this.form.value;this.mpplService.persons.create({languageId:e.languageId,nationalityId:e.nationalityId,sex:e.sex,titleId:e.title?.id,birthDate:e.birthDate,nationalitiyId:e.nationalitiyId,ssn:e.ssn,names:[{firstName:e.firstName,lastName:e.lastName,fatherName:e.fatherName,motherName:e.motherName,languageId:e.languageId}],primaryEmail:e.primaryEmail,secondaryEmail:e.secondaryEmail,mobilePhone:e.mobilePhone===""?null:e.mobilePhone,hasMobilePhoneWhatsapp:e.hasMobilePhoneWhatsapp,homePhone:e.homePhone===""?null:e.homePhone,hasHomePhoneWhatsapp:e.hasHomePhoneWhatsapp,workPhone:e.workPhone===""?null:e.workPhone,hasWorkPhoneWhatsapp:e.hasWorkPhoneWhatsapp,homeAddress:e.homeAddress}).pipe(te(this.indicator),ie(this.alert)).subscribe(o=>{this.dialog.close(o);});}};m.ɵfac=function(o){return new(o||m)();},m.ɵcmp=X({type:m,selectors:[["sz-medisy-people-person-create"]],standalone:!0,features:[v([f]),Y,x],decls:45,vars:11,consts:()=>{let e;e="Title";let o;o="First name";let t;t="Last name";let n;n="Father name";let g;g="Mother name";let P;P="Nationality";let R;R="SSN";let h;h="Sex";let c;c="Language";let I;I="BirthDate";let A;A="Mobile";let L;L="Home";let $;$="Work";let b;b="Primary Email";let D;D="Secondary Email";let y;y="Home Address";let z;z="Phones";let G;return G="Emails",[y,z,G,[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],[1,"sz-form-row"],["formControlName","title","label",e,3,"source","config"],["formControlName","firstName","label",o],["formControlName","lastName","label",t],["formControlName","fatherName","label",n],["formControlName","motherName","label",g],["formControlName","nationalityId","label",P,3,"source"],["formControlName","ssn","label",R],["formControlName","sex","label",h,3,"source","localizedValue"],["formControlName","languageId","label",c,3,"source"],["formControlName","birthDate","label",I],[1,"tw-mb-4"],["multi",""],["formControlName","homeAddress"],["formControlName","mobilePhone","label",A],["formControlName","hasMobilePhoneWhatsapp"],["formControlName","homePhone","label",L],["formControlName","hasHomePhoneWhatsapp"],["formControlName","workPhone","label",$],["formControlName","hasWorkPhoneWhatsapp"],["formControlName","primaryEmail","label",b],["formControlName","secondaryEmail","label",D],[3,"actions"]];},template:function(o,t){o&1&&(l(0,"sz-ui-dialog-header",3),a(1,"mat-dialog-content")(2,"form",4)(3,"div",5),l(4,"sz-ui-form-field-autocomplete",6),_(),a(5,"div",5),l(6,"sz-ui-form-field-input",7)(7,"sz-ui-form-field-input",8),_(),a(8,"div",5),l(9,"sz-ui-form-field-input",9)(10,"sz-ui-form-field-input",10),_(),a(11,"div",5),l(12,"sz-ui-form-field-select",11)(13,"sz-ui-form-field-input",12),_(),a(14,"div",5),l(15,"sz-ui-form-field-select",13)(16,"sz-ui-form-field-select",14),_(),l(17,"sz-ui-form-field-date",15),a(18,"div",16)(19,"mat-accordion",17)(20,"mat-expansion-panel")(21,"mat-expansion-panel-header")(22,"mat-panel-title"),d(23,0),_()(),l(24,"sz-ui-form-field-address",18),_(),a(25,"mat-expansion-panel")(26,"mat-expansion-panel-header")(27,"mat-panel-title"),d(28,1),_()(),l(29,"sz-ui-form-field-input",19),a(30,"mat-checkbox",20),N(31,"WhatsApp"),_(),l(32,"sz-ui-form-field-input",21),a(33,"mat-checkbox",22),N(34,"WhatsApp"),_(),l(35,"sz-ui-form-field-input",23),a(36,"mat-checkbox",24),N(37,"WhatsApp"),_()(),a(38,"mat-expansion-panel")(39,"mat-expansion-panel-header")(40,"mat-panel-title"),d(41,2),_()(),l(42,"sz-ui-form-field-input",25)(43,"sz-ui-form-field-input",26),_()()()()(),l(44,"sz-ui-dialog-actions",27)),o&2&&(r("title",t.title)("subtitle",t.subtitle)("alert",t.alert()),s(2),r("formGroup",t.form),s(2),r("source",t.titles)("config",t.titleAutoCompleteConfig),s(8),r("source",t.nationalities),s(3),r("source",t.sexes)("localizedValue",!0),s(),r("source",t.languages),s(28),r("actions",t.actions));},dependencies:[J,w,W,k,H,j,Z,U,fe,pe,Ne,Oe,ue,Ee,ae,de,Ce,Me,se,ee,le,re,_e,oe],encapsulation:2});let u=m;return u;})();export{Qe as a};/**i18n:90fd3a02d1f38af464e16e15bd62cf2b8c3351a95846e9a75ddd118742a5a7ba*/