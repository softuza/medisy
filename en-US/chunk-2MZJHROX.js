import{b as R}from"./chunk-MRRWHADO.js";import{a as Te,b as Pe,c as Re,d as fe,e as ge}from"./chunk-IBNNL3QX.js";import{a as S}from"./chunk-GGX4DK4Y.js";import{a as P}from"./chunk-BIKHMDEI.js";import{f as de,g as Ne,h as Oe,k as ue}from"./chunk-HJCF3HNF.js";import{a as ee,b as oe,e as te,g as ne}from"./chunk-HESHWLJQ.js";import{c as ie,h as _e,i as Ee,j as re,o as ae,p as se,q as me,r as Ce,u as Se}from"./chunk-3Y4CYIVY.js";import{c as O}from"./chunk-H6274ZKL.js";import{d as r,f as q,g as j,l as J,o as K,r as Q,s as U,u as Z}from"./chunk-UR5GDBT7.js";import{a as Me}from"./chunk-CRJIWNDX.js";import{a as le}from"./chunk-YJ25L3AZ.js";import{Jb as l,Kb as E,Lb as _,Vb as d,a as x,bb as s,gc as N,ja as C,mb as V,mc as H,na as k,nc as w,s as W,yb as a}from"./chunk-JPONW3XL.js";import{a as M,b as T}from"./chunk-RXNHEMMO.js";var oo=(()=>{let m=class m extends de{constructor(){let e=C(ee);super(e),this.mpplService=C(P),this.fb=C(U),this.data=C(oe),this.nationalities=this.mpplService.nationalities.getAll({orderBy:["name"]}),this.languages=this.mpplService.languages.getAll({orderBy:["name"]}),this.countries=this.mpplService.countries.getAll({orderBy:["name"]}),this.sexes=Object.keys(R).map(i=>R[i]),this.subscriptions=new x(),this.titles=this.mpplService.titles.get(T(M({},O.unpaged()),{orderBy:"name"})),this.titleAutoCompleteConfig={valueChangedFn:i=>(typeof i=="string"&&(this.titles=this.mpplService.titles.get(T(M({query:i},O.default()),{orderBy:"name"}))),!1),optionSelectedFn:i=>{i&&(this.form.value.sex||this.form.patchValue({sex:i.sex}));},optionDisplayWithFn:i=>i.name,optionValueFn:i=>i,suffixes:[{icon:Me.save,tooltip:le.save,hideOnLoading:!0,hideOnValid:!0,hideOnEmpty:!0,clickFn:i=>this.mpplService.titles.create({name:i})}]};let o=this.fb;this.dialog=e;let t=this.data;this.form=o.group({firstName:o.control(t?.firstName,[r.required,r.maxLength(128)]),lastName:o.control(t?.lastName,[r.required,r.maxLength(128)]),fatherName:o.control(t?.fatherFirstName?`${t.fatherFirstName} ${t?.lastName}`:null,[r.maxLength(128)]),motherName:o.control(t?.motherName,[r.maxLength(128)]),birthDate:o.control(t?.birthDate,[]),nationalityId:o.control(null,[]),ssn:o.control(t?.ssn,[r.maxLength(128)]),languageId:o.control(null,[r.required]),sex:o.control(null,[r.required]),title:o.control(null,[S.object()]),primaryEmail:[null,[r.email]],secondaryEmail:[null,[r.email]],mobilePhone:o.control(null,[S.phoneNumber()]),hasMobilePhoneWhatsapp:[!1,[]],homePhone:o.control(null,[S.phoneNumber()]),hasHomePhoneWhatsapp:[!1,[]],workPhone:o.control(null,[S.phoneNumber()]),hasWorkPhoneWhatsapp:[!1,[]],homeAddressCountryId:[null,[r.required]],homeAddressCity:[null,[]],homeAddressStreet:[null,[]],homeAddressPostalCode:[null,[]],homeAddressProvince:[null,[]]}),this.subscibeChanges();}subscibeChanges(){this.subscriptions.add(this.form.get("firstName")?.valueChanges.subscribe(e=>{if(!e||e===""){this.form.patchValue({sex:null,languageId:null});return;}else this.getGenders(e);}));}getGenders(e){!e||e.length<3||this.mpplService.autosuggestions.getGenders(M({query:e},O.minimal())).pipe(W(o=>o.items)).subscribe(o=>{!o||o.length===0||(this.form.value.sex||this.form.patchValue({sex:o[0].sex}),this.form.value.languageId||this.form.patchValue({languageId:o[0].languageId}));});}submit(){if(!this.IsValid())return;let e=this.form.value;this.mpplService.persons.create({languageId:e.languageId,nationalityId:e.nationalityId,sex:e.sex,titleId:e.title?.id,birthDate:e.birthDate,nationalitiyId:e.nationalitiyId,ssn:e.ssn,names:[{firstName:e.firstName,lastName:e.lastName,fatherName:e.fatherName,motherName:e.motherName,languageId:e.languageId}],primaryEmail:e.primaryEmail,secondaryEmail:e.secondaryEmail,mobilePhone:e.mobilePhone===""?null:e.mobilePhone,hasMobilePhoneWhatsapp:e.hasMobilePhoneWhatsapp,homePhone:e.homePhone===""?null:e.homePhone,hasHomePhoneWhatsapp:e.hasHomePhoneWhatsapp,workPhone:e.workPhone===""?null:e.workPhone,hasWorkPhoneWhatsapp:e.hasWorkPhoneWhatsapp,homeAddressCountryId:e.homeAddressCountryId,homeAddressCity:e.homeAddressCity,homeAddressStreet:e.homeAddressStreet,homeAddressPostalCode:e.homeAddressPostalCode,homeAddressProvince:e.homeAddressProvince}).pipe(_e(this.indicator),Ee(this.alert)).subscribe(o=>{this.dialog.close(o);});}};m.ɵfac=function(o){return new(o||m)();},m.ɵcmp=k({type:m,selectors:[["sz-medisy-people-person-create"]],standalone:!0,features:[H([P]),V,w],decls:51,vars:12,consts:()=>{let e;e="Title";let o;o="First name";let t;t="Last name";let i;i="Father name";let f;f="Mother name";let g;g="Nationality";let p;p="SSN";let h;h="Sex";let A;A="Language";let c;c="BirthDate";let I;I="Country";let L;L="City";let $;$="Province";let y;y="Street";let D;D="Postal Code";let b;b="Mobile";let z;z="Home";let B;B="Work";let G;G="Primary Email";let X;X="Secondary Email";let Y;Y="Home Address";let v;v="Phones";let F;return F="Emails",[Y,v,F,[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],[1,"sz-form-row"],["formControlName","title","label",e,3,"source","config"],["formControlName","firstName","label",o],["formControlName","lastName","label",t],["formControlName","fatherName","label",i],["formControlName","motherName","label",f],["formControlName","nationalityId","label",g,3,"source"],["formControlName","ssn","label",p],["formControlName","sex","label",h,3,"source","localizedValue"],["formControlName","languageId","label",A,3,"source"],["formControlName","birthDate","label",c],[1,"tw-mb-4"],["multi",""],["formControlName","homeAddressCountryId","label",I,3,"source"],["formControlName","homeAddressCity","label",L],["formControlName","homeAddressProvince","label",$],["formControlName","homeAddressStreet","label",y],["formControlName","homeAddressPostalCode","label",D],["formControlName","mobilePhone","label",b],["formControlName","hasMobilePhoneWhatsapp"],["formControlName","homePhone","label",z],["formControlName","hasHomePhoneWhatsapp"],["formControlName","workPhone","label",B],["formControlName","hasWorkPhoneWhatsapp"],["formControlName","primaryEmail","label",G],["formControlName","secondaryEmail","label",X],[3,"actions"]];},template:function(o,t){o&1&&(_(0,"sz-ui-dialog-header",3),l(1,"mat-dialog-content")(2,"form",4)(3,"div",5),_(4,"sz-ui-form-field-autocomplete",6),E(),l(5,"div",5),_(6,"sz-ui-form-field-input",7)(7,"sz-ui-form-field-input",8),E(),l(8,"div",5),_(9,"sz-ui-form-field-input",9)(10,"sz-ui-form-field-input",10),E(),l(11,"div",5),_(12,"sz-ui-form-field-select",11)(13,"sz-ui-form-field-input",12),E(),l(14,"div",5),_(15,"sz-ui-form-field-select",13)(16,"sz-ui-form-field-select",14),E(),_(17,"sz-ui-form-field-date",15),l(18,"div",16)(19,"mat-accordion",17)(20,"mat-expansion-panel")(21,"mat-expansion-panel-header")(22,"mat-panel-title"),d(23,0),E()(),_(24,"sz-ui-form-field-select",18),l(25,"div",5),_(26,"sz-ui-form-field-input",19)(27,"sz-ui-form-field-input",20),E(),l(28,"div",5),_(29,"sz-ui-form-field-input",21)(30,"sz-ui-form-field-input",22),E()(),l(31,"mat-expansion-panel")(32,"mat-expansion-panel-header")(33,"mat-panel-title"),d(34,1),E()(),_(35,"sz-ui-form-field-input",23),l(36,"mat-checkbox",24),N(37,"WhatsApp"),E(),_(38,"sz-ui-form-field-input",25),l(39,"mat-checkbox",26),N(40,"WhatsApp"),E(),_(41,"sz-ui-form-field-input",27),l(42,"mat-checkbox",28),N(43,"WhatsApp"),E()(),l(44,"mat-expansion-panel")(45,"mat-expansion-panel-header")(46,"mat-panel-title"),d(47,2),E()(),_(48,"sz-ui-form-field-input",29)(49,"sz-ui-form-field-input",30),E()()()()(),_(50,"sz-ui-dialog-actions",31)),o&2&&(a("title",t.title)("subtitle",t.subtitle)("alert",t.alert()),s(2),a("formGroup",t.form),s(2),a("source",t.titles)("config",t.titleAutoCompleteConfig),s(8),a("source",t.nationalities),s(3),a("source",t.sexes)("localizedValue",!0),s(),a("source",t.languages),s(8),a("source",t.countries),s(26),a("actions",t.actions));},dependencies:[Z,J,q,j,K,Q,ne,te,ge,fe,Te,Pe,Re,me,se,ue,Ne,Oe,Se,ie,ae,Ce,re],encapsulation:2});let u=m;return u;})();export{oo as a};/**i18n:490604af3307a4e77c84ca293db1067566ffe2bc083ef2e1368fbd6dc8c217fd*/