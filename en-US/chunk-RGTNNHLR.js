import{a as De}from"./chunk-RZK5BQ6B.js";import{a as Re,c as ve,e as Le,f as ze,g as Fe}from"./chunk-OASRBHML.js";import{a as c}from"./chunk-JQJBUEG5.js";import{e as Ie,g as ge,h as Me,k as Oe}from"./chunk-TQ67CQZ2.js";import{a as te,b as oe,e as ie,g as re}from"./chunk-YWX36TB2.js";import{a as _e,b as ue,e as fe,f as Se,g as Te,h as Ee,p as Ae,q as be}from"./chunk-HJYMXJEH.js";import{c as ye,d as he}from"./chunk-AIREYCF6.js";import{b as de,g as ce}from"./chunk-TLW5FHGJ.js";import{a as me,b as pe}from"./chunk-T6BCLI2C.js";import{c as Ce}from"./chunk-QMJWEZPO.js";import{a as ne,b as ae,h as se,i as le}from"./chunk-UO2UFEHS.js";import{b as w,d as G,e as q,f as g,g as j,k,l as X,m as W,p as K,q as U,t as M}from"./chunk-YALI5IZX.js";import{aa as J,da as Q,ha as Z,ia as ee}from"./chunk-GAHCHFY3.js";import{Cb as _,Eb as v,Fb as L,Gb as z,Hb as l,Ib as s,Jb as u,Nb as F,O as P,Tb as D,Vb as T,Xb as p,a as N,b as B,ea as x,fc as A,gc as h,hc as H,ib as n,ic as Y,jb as d,jc as b,mb as V,mc as I,pa as $,qa as C,qb as E,tb as S,va as O,wa as R,xb as m}from"./chunk-SOOFBSF3.js";function xe(o,i){if(o&1){let a=F();l(0,"mat-chip-row",7),T("removed",function(){let t=O(a).$implicit,f=p(2);return R(f.removeSelection(t));}),h(1),l(2,"button",8)(3,"mat-icon"),h(4,"cancel"),s()()();}if(o&2){let a=i.$implicit,e=p(2);n(),Y(" ",e.getSelectionFormat(a)," ");}}function $e(o,i){if(o&1){let a=F();l(0,"mat-chip-grid",null,4),L(2,xe,5,1,"mat-chip-row",null,v),s(),l(4,"input",5,6),T("matChipInputTokenEnd",function(){O(a);let r=p();return R(r.addSelection());}),s();}if(o&2){let a=A(1),e=p(),r=A(7);n(2),z(e.selections),n(2),m("matAutocomplete",r)("formControl",e.control)("matChipInputFor",a)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes);}}function Ve(o,i){if(o&1&&u(0,"input",9,6),o&2){let a=p(),e=A(7);m("matAutocomplete",e)("formControl",a.control);}}function He(o,i){if(o&1&&(l(0,"mat-option",10),h(1),s()),o&2){let a=i.$implicit,e=p();m("value",e.getOptionValue(a)),n(),Y(" ",e.getOptionContent(a)," ");}}function we(o,i){o&1&&(l(0,"mat-error"),D(1,11),s());}function Ge(o,i){o&1&&(l(0,"mat-error"),D(1,12),s());}function qe(o,i){o&1&&u(0,"mat-progress-bar",3);}var Ye=(()=>{let i=class i extends Ee{get laboratoryId(){return this._laboratoryId;}set laboratoryId(e){e!==this._laboratoryId&&(this._laboratoryId=e,this.reset());}constructor(e,r){super(e),this.ngControl=e,this.mlatService=r,this.query=null,this.label=Ce.testType,this._laboratoryId="",this.filters=x([]),this.szOptionContentFn=t=>t.testType.name,this.szOptionValueFn=t=>t,this.szOptionFormatFn=t=>t?t.testType.name:"",V(()=>this.refresh(),{allowSignalWrites:!0});}ngOnInit(){this.control=this.ngControl.control,this.listenChanges();}ngOnDestroy(){this.subscriptions.unsubscribe();}listenChanges(){this.subscriptions.add(this.control.valueChanges.pipe(he(400)).subscribe(e=>{e!==null&&this.handleValueChanged(e);}));}handleValueChanged(e){if(this.reset(),typeof e=="string")this.query=e;else if(typeof e=="object"&&e)return;this.fetch();}reset(){this.query=null,this.totalPages=-1,this.options=[];}fetch(){this.mlatService.laboratories.testTypes.get(this._laboratoryId,B(N({query:this.query},ce.minimal()),{orderBy:["-isFavorite","testType.name"],filters:this.filters()})).pipe(ye(this.indicator),P(1)).subscribe(e=>{this.options.push(...e.items),this.totalPages=e.totalPages,this.afterSourceUpdated();});}};i.ɵfac=function(r){return new(r||i)(d(q,10),d(c));},i.ɵcmp=C({type:i,selectors:[["sz-medisy-laboratory-laboratory-test-type-search"]],inputs:{query:"query",laboratoryId:"laboratoryId",filters:[$.SignalBased,"filters"]},standalone:!0,features:[b([c]),E,I],decls:13,vars:7,consts:()=>{let e;e="This field is required";let r;return r="This field is not valid",[[1,"container"],[3,"displayWith","szScrollIgnored","optionSelected","szScrolled"],["auto","matAutocomplete"],["mode","indeterminate"],["chipGrid",""],["matInput","",3,"matAutocomplete","formControl","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["input",""],[3,"removed"],["matChipRemove",""],["matInput","",3,"matAutocomplete","formControl"],[3,"value"],e,r];},template:function(r,t){r&1&&(l(0,"div",0)(1,"mat-form-field")(2,"mat-label"),h(3),s(),S(4,$e,6,4)(5,Ve,2,2),l(6,"mat-autocomplete",1,2),T("optionSelected",function(y){return t.optionSelected(y);})("szScrolled",function(){return t.scroll();}),L(8,He,2,2,"mat-option",10,v),s(),S(10,we,2,0,"mat-error")(11,Ge,2,0,"mat-error"),s(),S(12,qe,1,0,"mat-progress-bar",3),s()),r&2&&(n(3),H(t.label),n(),_(4,t.multiple?4:5),n(2),m("displayWith",t.szOptionFormatFn)("szScrollIgnored",t.indicator()),n(2),z(t.options),n(2),_(10,t.control.hasError("required")?10:-1),n(),_(11,t.control.hasError("invalid")?11:-1),n(),_(12,t.indicator()?12:-1));},dependencies:[M,w,g,X,le,se,ne,ae,Te,fe,J,Se,pe,me,ue,_e,Q,Fe,Le,ze,Re,ve,ee,Z,Ae],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]{position:relative}mat-progress-bar[_ngcontent-%COMP%]{position:absolute;bottom:20px}"]});let o=i;return o;})();function je(o,i){if(o&1&&u(0,"sz-ui-form-field-select",3),o&2){let a=p();m("source",a.laboratories);}}var Bt=(()=>{let i=class i extends Ie{constructor(e,r,t,f){super(r),this.fb=e,this.dialog=r,this.mlabService=t,this.data=f,this.laboratories=this.mlabService.laboratories.getAll({orderBy:["name"],filters:[{field:"id",op:de.NotEqual,value:this.data}]}),this.laboratoryOptionValueFn=y=>y,this.testTypesFilters=[],this.laboratoryId=this.data,this.form=e.group({laboratoryId:[null,[]],testType:e.control(null,[G.required,De()])});}isTranferOutEnabled(){return this.form.value?.testType?.transferOutEnabled;}testTypeSelected(e){this.form.patchValue({laboratoryId:e.transferOutLaboratoryId}),e.transferOutLaboratoryId?this.form.controls.laboratoryId.disable():this.form.controls.laboratoryId.enable();}submit(){this.IsValid()&&this.dialog.close({laboratoryTestType:this.form.value.testType,laboratoryId:this.form.value.laboratoryId});}};i.ɵfac=function(r){return new(r||i)(d(U),d(te),d(c),d(oe));},i.ɵcmp=C({type:i,selectors:[["sz-medisy-laboratory-analysis-test-type-add"]],standalone:!0,features:[b([c]),E,I],decls:6,vars:6,consts:()=>{let e;return e="Transfer Out Laboratory",[[3,"header"],[1,"sz-form",3,"formGroup"],["formControlName","testType",3,"laboratoryId","filters","szOptionSelected"],["formControlName","laboratoryId","label",e,3,"source"],[3,"actions"]];},template:function(r,t){r&1&&(u(0,"sz-ui-dialog-header",0),l(1,"mat-dialog-content")(2,"form",1)(3,"sz-medisy-laboratory-laboratory-test-type-search",2),T("szOptionSelected",function(y){return t.testTypeSelected(y);}),s(),S(4,je,1,1,"sz-ui-form-field-select",3),s()(),u(5,"sz-ui-dialog-actions",4)),r&2&&(m("header",t.header),n(2),m("formGroup",t.form),n(),m("laboratoryId",t.laboratoryId)("filters",t.testTypesFilters),n(),_(4,t.isTranferOutEnabled()?4:-1),n(),m("actions",t.actions));},dependencies:[M,k,g,j,W,K,re,ie,Oe,ge,Me,Ye,be],encapsulation:2});let o=i;return o;})();export{Bt as a};/**i18n:3c79f61dd4ae219236c62485f036b897dde9f999c4ae619f8589958cf23779e7*/