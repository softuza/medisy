import{a as C}from"./chunk-YT6CASAK.js";import{a as Oe}from"./chunk-YNUTG2SB.js";import"./chunk-QW6HGORB.js";import{a as ce,b as fe,c as _,f as Se,g as Ee,h as Re}from"./chunk-QSKC3G63.js";import"./chunk-2KPNCTCB.js";import"./chunk-S7INMPNY.js";import"./chunk-25IBV356.js";import{b as le,f as se,g as ue,h as _e,j as de,k as pe}from"./chunk-SQCF3S47.js";import{a as R}from"./chunk-XY5F7KAL.js";import"./chunk-RSYANUDV.js";import{a as k,b as j,d as g,e as q,g as Q}from"./chunk-FRBT2WCB.js";import{a as K,b as W,q as te,r as oe,s as re,u as ie}from"./chunk-ZTT2CFXD.js";import"./chunk-HLTWUKSH.js";import"./chunk-276RQCOC.js";import{h as H,i as J}from"./chunk-2IPEL4E4.js";import{b as z,d as T,f as P,g as F,k as U,l as B,n as $,q as G,r as Y,t as X}from"./chunk-FY76SKRQ.js";import{a as ne}from"./chunk-ZBDJ3JDC.js";import{b as s,c as ae}from"./chunk-IDQKS733.js";import{a as me}from"./chunk-RCHOHS2G.js";import"./chunk-W75G3ZKH.js";import"./chunk-5MQKWJS4.js";import{a as Z,b as ee}from"./chunk-N4MQQJHL.js";import"./chunk-FJ4IFQWV.js";import{p as V,v as w,x}from"./chunk-4I74CWZL.js";import"./chunk-LLSKOB3G.js";import"./chunk-OWRQBV6B.js";import"./chunk-3AQJ5CSK.js";import{Eb as N,Jb as p,Kb as m,Lb as l,Wb as h,Yb as L,bb as u,f as y,ja as n,mb as D,mc as S,na as f,nc as E,rb as A,yb as a}from"./chunk-YAUSGWXJ.js";import{c as b}from"./chunk-QXHRBTK3.js";function Ve(i,o){if(i&1&&l(0,"sz-ui-form-field-select",4),i&2){let M=L();a("source",M.testTypeResultOptions);}}function ge(i,o){i&1&&(p(0,"div",7)(1,"mat-form-field",8)(2,"label"),l(3,"input",9),m()(),p(4,"mat-form-field",8)(5,"label"),l(6,"input",10),m()()());}function Ae(i,o){i&1&&(p(0,"mat-form-field",8)(1,"label"),l(2,"input",11),m()());}function he(i,o){if(i&1&&A(0,ge,7,0,"div",7)(1,Ae,3,0,"mat-form-field",8),i&2){let M=L();N(M.isRange()?0:-1),u(),N(M.isRange()?-1:1);}}var Me=(()=>{let o=class o extends se{constructor(){let e=n(k);super(e),this.mlabService=n(R),this.fb=n(Y),this.data=n(j),this.referenceGroups=this.mlabService.referenceGroups.getAll({orderBy:["nameEn"],filterBehavior:w.Or,filters:x.create().equalIf("id",this.data.referenceValueRule?.referenceGroupId).notAny("referenceValueRules.referenceValueId",[this.data.referenceValue.id]).filters()}),this.testTypeResultOptions=this.mlabService.testTypes.resultOptions.getAll(this.data.referenceValue.testTypeId,{orderBy:["nameEn"]}),this.comparisonOperators=Object.keys(C).map(d=>C[d]);let r=this.fb;this.dialog=e;let t=this.data;this.form=r.group({description:[t.referenceValueRule?.description,[T.maxLength(4096)]],comparisonOperator:new U(t.referenceValueRule?.comparisonOperator??C.Equal,[T.required]),referenceGroupId:[t.referenceValueRule?.referenceGroupId,[T.required]],value:[t.referenceValueRule?.value,[]],start:[t.referenceValueRule?.start,[]],end:[t.referenceValueRule?.end,[]],testTypeResultOptionId:[t.referenceValueRule?.testTypeResultOptionId,[]]});}isRange(){return this.form.value.comparisonOperator===C.Range;}IsQuantative(){return this.data.referenceValue.testTypeResultType===Oe.Quantitative;}submit(){this.IsValid()&&(this.data.referenceValueRuleId?this.save(this.mlabService.referenceValues.rules.update(this.data.referenceValue.id,this.data.referenceValueRuleId,this.form.value)):this.save(this.mlabService.referenceValues.rules.create(this.data.referenceValue.id,this.form.value)));}};o.ɵfac=function(r){return new(r||o)();},o.ɵcmp=f({type:o,selectors:[["sz-medisy-laboratory-reference-value-rules-save"]],standalone:!0,features:[S([R]),D,E],decls:9,vars:9,consts:()=>{let e;e="Reference Group";let r;r="Comparison Operator";let t;t="Value";let d;d="Description";let O;O="Start";let I;I="End";let v;return v="Value",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","referenceGroupId","label",e,3,"source"],["formControlName","comparisonOperator","label",r,3,"source","localizedValue"],["formControlName","testTypeResultOptionId","label",t,3,"source"],["formControlName","description","label",d],[3,"actions"],[1,"tw-flex","md:tw-flex-row","tw-flex-col","md:tw-gap-4"],[1,"tw-flex-1"],["autocomplete","off","formControlName","start","matInput","","placeholder",O],["autocomplete","off","formControlName","end","matInput","","placeholder",I],["autocomplete","off","formControlName","value","matInput","","placeholder",v]];},template:function(r,t){r&1&&(l(0,"sz-ui-dialog-header",0),p(1,"mat-dialog-content")(2,"form",1),l(3,"sz-ui-form-field-select",2)(4,"sz-ui-form-field-select",3),A(5,Ve,1,1,"sz-ui-form-field-select",4)(6,he,2,2),l(7,"sz-ui-form-field-textarea",5),m()(),l(8,"sz-ui-dialog-actions",6)),r&2&&(a("title",t.title)("subtitle",t.subtitle)("alert",t.alert()),u(2),a("formGroup",t.form),u(),a("source",t.referenceGroups),u(),a("source",t.comparisonOperators)("localizedValue",!0),u(),N(t.IsQuantative()?6:5),u(3),a("actions",t.actions));},dependencies:[X,B,z,P,F,$,G,W,K,H,Q,q,J,te,pe,ue,_e,ie,re,oe],encapsulation:2});let i=o;return i;})();var Ne=(()=>{let o=class o{constructor(){this.dialog=n(g),this.mlabService=n(R),this.route=n(V),this.dataSource=new Se(),this.referenceValue=this.route.snapshot.data.referenceValue,this.appBarConfig={title:Z.rules,subtitle:this.referenceValue.testType.nameEn,backEnabled:!0,backUrl:`/${ne.ReferenceValues}`,menu:ae.default().setItems([s.add(this.openSaveComponent.bind(this)),s.menu([s.search(),s.filter()])])},this.dataSource.columnDefs.push(_.uuid("id"),_.string("referenceGroup.nameEn").setValueClassFontBold().setStacked(_.string("referenceGroup.description").setStyleSmall()),_.enum("comparisonOperator").setValueGetter(e=>ee(e.comparisonOperator)),_.number("_value").setValueGetter(e=>e.testTypeResultOption?e.testTypeResultOption.nameEn:e.value!==null?e.value:`${e.start} - ${e.end}`).setHeaderSortable(!1),_.date("createdAt").setVisible(!1),_.date("updatedAt").setVisible(!1),_.menu([s.edit(this.openSaveComponent.bind(this)),s.divider(),s.clone(e=>{let O=e,{id:r,referenceGroupId:t}=O,d=b(O,["id","referenceGroupId"]);this.openSaveComponent(d);}),s.divider(),s.delete(this.openReferenceValueRuleDeleteComponent.bind(this))]));}ngOnInit(){this.get();}openSaveComponent(e){this.dialog.open(Me,{data:{referenceValue:this.referenceValue,referenceValueRule:e,referenceValueRuleId:e?.id}}).afterClosed().subscribe(r=>{this.dataSource.addOrUpdateItem(r);});}openReferenceValueRuleDeleteComponent(e){this.dialog.open(de,{data:le.delete(this.mlabService.referenceValues.rules.delete(e.referenceValueId,e.id),e)}).afterClosed().subscribe(r=>{this.dataSource.delete(r);});}get(){this.mlabService.referenceValues.rules.get(this.referenceValue.id,this.dataSource.getQuery()).pipe(Ee(this.dataSource.state)).subscribe(e=>{this.dataSource.set(e.items,e.count);});}};o.ɵfac=function(r){return new(r||o)();},o.ɵcmp=f({type:o,selectors:[["sz-medisy-laboratory-reference-value-rules"]],standalone:!0,features:[S([R]),E],decls:2,vars:3,consts:[[3,"changed","config","dataSource"],["content","",3,"update","dataSource"]],template:function(r,t){r&1&&(p(0,"sz-ui-table-bar",0),h("changed",function(){return t.get();}),m(),p(1,"sz-ui-table",1),h("update",function(){return t.get();}),m()),r&2&&(a("config",t.appBarConfig)("dataSource",t.dataSource),u(),a("dataSource",t.dataSource));},dependencies:[Re,fe,ce],encapsulation:2});let i=o;return i;})();var Te=(()=>{let o=class o{constructor(){this.dialog=n(g),this.route=n(V),this.alert$=new y(),this.referenceValue=this.route.snapshot.data.referenceValue,this.appBarConfig={title:this.referenceValue.testType.nameEn,subtitle:this.referenceValue.description,backEnabled:!0};}};o.ɵfac=function(r){return new(r||o)();},o.ɵcmp=f({type:o,selectors:[["sz-medisy-laboratory-reference-value"]],standalone:!0,features:[S([]),E],decls:1,vars:1,consts:[[3,"config"]],template:function(r,t){r&1&&l(0,"sz-ui-app-bar",0),r&2&&a("config",t.appBarConfig);},dependencies:[me],encapsulation:2});let i=o;return i;})();var Tt=[{path:"",component:Te},{path:"rules",component:Ne}];export{Tt as default};/**i18n:359c45a37699f2cf41ff2ce7681094fb8642750bd9400ade44324692d4b7d733*/