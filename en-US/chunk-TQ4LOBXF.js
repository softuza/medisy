import{a as Dt}from"./chunk-YPB5TJMZ.js";import{a as Rt,c as Lt,d as vt,e as zt,f as Ft}from"./chunk-PGGIRJCC.js";import{a as c}from"./chunk-IY2QXOH2.js";import{d as gt,f as It,g as Ot,j as Mt}from"./chunk-EF2KU3MF.js";import{a as et,b as ot,e as it,g as rt}from"./chunk-O4MIBT3U.js";import{a as _t,b as ut,e as ft,f as St,g as Tt,h as Et,r as At,s as bt}from"./chunk-QETJAZV7.js";import{c as yt,d as ht}from"./chunk-XGOPNFX6.js";import{b as dt,g as ct}from"./chunk-4PE74OIY.js";import{a as mt,b as pt}from"./chunk-S734PXWV.js";import{c as Ct}from"./chunk-VKLUJQ6V.js";import{a as nt,b as at,h as st,i as lt}from"./chunk-ZUQ55FEV.js";import{b as H,d as G,e as q,f as I,g as j,k,l as X,m as W,p as K,q as U,t as O}from"./chunk-AZ35PAEP.js";import{$ as J,ca as Q,ga as Z,ha as tt}from"./chunk-BE3RRH45.js";import{Bb as m,Gb as _,Ib as L,Jb as v,Kb as z,Lb as l,Mb as s,Nb as u,Q as P,Qc as w,Rb as F,Xb as D,Yb as T,_b as p,a as N,b as B,gb as n,gc as A,hb as d,hc as h,ia as x,ic as $,jc as Y,ma as V,na as C,nc as b,oc as g,ra as M,sa as R,sb as E,xb as S}from"./chunk-3ZQQMLH6.js";function xt(o,i){if(o&1){let a=F();l(0,"mat-chip-row",7),T("removed",function(){let e=M(a).$implicit,f=p(2);return R(f.removeSelection(e));}),h(1),l(2,"button",8)(3,"mat-icon"),h(4,"cancel"),s()()();}if(o&2){let a=i.$implicit,t=p(2);n(),Y(" ",t.getSelectionFormat(a)," ");}}function Vt(o,i){if(o&1){let a=F();l(0,"mat-chip-grid",null,4),v(2,xt,5,1,"mat-chip-row",null,L),s(),l(4,"input",5,6),T("matChipInputTokenEnd",function(){M(a);let r=p();return R(r.addSelection());}),s();}if(o&2){let a=A(1),t=p(),r=A(7);n(2),z(t.selections),n(2),m("matAutocomplete",r)("formControl",t.control)("matChipInputFor",a)("matChipInputSeparatorKeyCodes",t.separatorKeysCodes);}}function $t(o,i){if(o&1&&u(0,"input",9,6),o&2){let a=p(),t=A(7);m("matAutocomplete",t)("formControl",a.control);}}function wt(o,i){if(o&1&&(l(0,"mat-option",10),h(1),s()),o&2){let a=i.$implicit,t=p();m("value",t.getOptionValue(a)),n(),Y(" ",t.getOptionContent(a)," ");}}function Ht(o,i){o&1&&(l(0,"mat-error"),D(1,11),s());}function Gt(o,i){o&1&&(l(0,"mat-error"),D(1,12),s());}function qt(o,i){o&1&&u(0,"mat-progress-bar",3);}var Yt=(()=>{let i=class i extends Et{get laboratoryId(){return this._laboratoryId;}set laboratoryId(t){t!==this._laboratoryId&&(this._laboratoryId=t,this.reset());}constructor(t,r){super(t),this.ngControl=t,this.mlatService=r,this.query=null,this.label=Ct.testType,this._laboratoryId="",this.filters=x([]),this.szOptionContentFn=e=>e.testType.name,this.szOptionValueFn=e=>e,this.szOptionFormatFn=e=>e?e.testType.name:"",w(()=>this.refresh(),{allowSignalWrites:!0});}ngOnInit(){this.control=this.ngControl.control,this.listenChanges();}ngOnDestroy(){this.subscriptions.unsubscribe();}listenChanges(){this.subscriptions.add(this.control.valueChanges.pipe(ht(400)).subscribe(t=>{t!==null&&this.handleValueChanged(t);}));}handleValueChanged(t){if(this.reset(),typeof t=="string")this.query=t;else if(typeof t=="object"&&t)return;this.fetch();}reset(){this.query=null,this.totalPages=-1,this.options=[];}fetch(){this.mlatService.laboratories.testTypes.get(this._laboratoryId,B(N({query:this.query},ct.minimal()),{orderBy:["-isFavorite","testType.name"],filters:this.filters()})).pipe(yt(this.indicator),P(1)).subscribe(t=>{this.options.push(...t.items),this.totalPages=t.totalPages,this.afterSourceUpdated();});}};i.ɵfac=function(r){return new(r||i)(d(q,10),d(c));},i.ɵcmp=C({type:i,selectors:[["sz-medisy-laboratory-laboratory-test-type-search"]],inputs:{query:"query",laboratoryId:"laboratoryId",filters:[V.SignalBased,"filters"]},standalone:!0,features:[b([c]),E,g],decls:13,vars:7,consts:()=>{let t;t="This field is required";let r;return r="This field is not valid",[[1,"container"],[3,"displayWith","szScrollIgnored","optionSelected","szScrolled"],["auto","matAutocomplete"],["mode","indeterminate"],["chipGrid",""],["matInput","",3,"matAutocomplete","formControl","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["input",""],[3,"removed"],["matChipRemove",""],["matInput","",3,"matAutocomplete","formControl"],[3,"value"],t,r];},template:function(r,e){r&1&&(l(0,"div",0)(1,"mat-form-field")(2,"mat-label"),h(3),s(),S(4,Vt,6,4)(5,$t,2,2),l(6,"mat-autocomplete",1,2),T("optionSelected",function(y){return e.optionSelected(y);})("szScrolled",function(){return e.scroll();}),v(8,wt,2,2,"mat-option",10,L),s(),S(10,Ht,2,0,"mat-error")(11,Gt,2,0,"mat-error"),s(),S(12,qt,1,0,"mat-progress-bar",3),s()),r&2&&(n(3),$(e.label),n(),_(4,e.multiple?4:5),n(2),m("displayWith",e.szOptionFormatFn)("szScrollIgnored",e.indicator()),n(2),z(e.options),n(2),_(10,e.control.hasError("required")?10:-1),n(),_(11,e.control.hasError("invalid")?11:-1),n(),_(12,e.indicator()?12:-1));},dependencies:[O,H,I,X,lt,st,nt,at,Tt,ft,J,St,pt,mt,ut,_t,Q,Ft,vt,zt,Rt,Lt,tt,Z,At],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]{position:relative}mat-progress-bar[_ngcontent-%COMP%]{position:absolute;bottom:20px}"]});let o=i;return o;})();function jt(o,i){if(o&1&&u(0,"sz-ui-form-field-select",3),o&2){let a=p();m("source",a.laboratories);}}var Be=(()=>{let i=class i extends gt{constructor(t,r,e,f){super(r),this.fb=t,this.dialog=r,this.mlabService=e,this.data=f,this.laboratories=this.mlabService.laboratories.getAll({orderBy:["name"],filters:[{field:"id",op:dt.NotEqual,value:this.data}]}),this.laboratoryOptionValueFn=y=>y,this.testTypesFilters=[],this.laboratoryId=this.data,this.form=t.group({transferOutLaboratoryId:[null,[]],testType:t.control(null,[G.required,Dt()])});}isTranferOutEnabled(){return this.form.value?.testType?.transferOutEnabled;}testTypeSelected(t){this.form.patchValue({transferOutLaboratoryId:t.transferOutLaboratoryId}),t.transferOutLaboratoryId?this.form.controls.transferOutLaboratoryId.disable():this.form.controls.transferOutLaboratoryId.enable();}submit(){this.IsValid()&&this.dialog.close({laboratoryTestType:this.form.value.testType,transferOutLaboratoryId:this.form.getRawValue().transferOutLaboratoryId});}};i.ɵfac=function(r){return new(r||i)(d(U),d(et),d(c),d(ot));},i.ɵcmp=C({type:i,selectors:[["sz-medisy-laboratory-analysis-test-type-add"]],standalone:!0,features:[b([c]),E,g],decls:6,vars:6,consts:()=>{let t;return t="Transfer Out Laboratory",[[3,"header"],[1,"sz-form",3,"formGroup"],["formControlName","testType",3,"laboratoryId","filters","szOptionSelected"],["formControlName","transferOutLaboratoryId","label",t,3,"source"],[3,"actions"]];},template:function(r,e){r&1&&(u(0,"sz-ui-dialog-header",0),l(1,"mat-dialog-content")(2,"form",1)(3,"sz-medisy-laboratory-laboratory-test-type-search",2),T("szOptionSelected",function(y){return e.testTypeSelected(y);}),s(),S(4,jt,1,1,"sz-ui-form-field-select",3),s()(),u(5,"sz-ui-dialog-actions",4)),r&2&&(m("header",e.header),n(2),m("formGroup",e.form),n(),m("laboratoryId",e.laboratoryId)("filters",e.testTypesFilters),n(),_(4,e.isTranferOutEnabled()?4:-1),n(),m("actions",e.actions));},dependencies:[O,k,I,j,W,K,rt,it,Mt,It,Ot,Yt,bt],encapsulation:2});let o=i;return o;})();export{Be as a};/**i18n:34a0aca9a8a7a5b54ef908b3a50021d42a3fb6a7b58cfe4980f9bcbab369501e*/