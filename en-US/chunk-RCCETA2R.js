import{a as R}from"./chunk-MPVLAJ46.js";import"./chunk-F7YMPHDP.js";import{a as ce,b as fe,c as _,f as Se,g as Ee,h as Oe}from"./chunk-KSLMZPY5.js";import"./chunk-JX57I4IE.js";import"./chunk-SEQWES4Y.js";import"./chunk-ZCO6OMXC.js";import{b as le,f as se,g as ue,h as _e,j as de,k as pe}from"./chunk-QNBNR7BN.js";import{a as O}from"./chunk-TK7UMVJ5.js";import"./chunk-KBQ34SC3.js";import{a as k,b as j,d as g,e as q,g as H}from"./chunk-HQFAQEC3.js";import{a as J,b as K,q as te,r as oe,s as re,u as ie}from"./chunk-DE6KIQK7.js";import"./chunk-TMPOBBLV.js";import"./chunk-Y4FDJ36P.js";import{h as W,i as Q}from"./chunk-N4OOJIAX.js";import{b as z,d as T,f as P,g as F,k as U,l as B,n as $,q as G,r as Y,t as X}from"./chunk-GLZMJYJP.js";import{a as ne}from"./chunk-AVBRNBN7.js";import{b as s,c as ae}from"./chunk-QOXR5OPH.js";import{a as me}from"./chunk-NC2TMKBF.js";import"./chunk-OYBNPCR5.js";import"./chunk-ZYAQ56NI.js";import{a as Z,b as ee}from"./chunk-GM2OQK6E.js";import"./chunk-K5FLVMR2.js";import{p as V,v as w,x}from"./chunk-T4KI57OL.js";import"./chunk-MOGYN3JD.js";import"./chunk-ATJMWBRY.js";import"./chunk-UEBH5A2M.js";import{Eb as N,Jb as p,Kb as m,Lb as l,Wb as h,Yb as L,bb as u,f as y,ja as n,mb as D,mc as S,na as f,nc as E,rb as A,yb as a}from"./chunk-6J2YPVJB.js";import{c as b}from"./chunk-TH7MQ6T4.js";function Te(i,o){if(i&1&&l(0,"sz-ui-form-field-select",4),i&2){let M=L();a("source",M.testTypeResultOptions);}}function Ve(i,o){i&1&&(p(0,"div",7)(1,"mat-form-field",8)(2,"label"),l(3,"input",9),m()(),p(4,"mat-form-field",8)(5,"label"),l(6,"input",10),m()()());}function ge(i,o){i&1&&(p(0,"mat-form-field",8)(1,"label"),l(2,"input",11),m()());}function Ae(i,o){if(i&1&&A(0,Ve,7,0,"div",7)(1,ge,3,0,"mat-form-field",8),i&2){let M=L();N(M.isRange()?0:-1),u(),N(M.isRange()?-1:1);}}var Ce=(()=>{let o=class o extends se{constructor(){let e=n(k);super(e),this.mlabService=n(O),this.fb=n(Y),this.data=n(j),this.referenceGroups=this.mlabService.referenceGroups.getAll({orderBy:["nameEn"],filterBehavior:w.Or,filters:x.create().equalIf("id",this.data.referenceValueRule?.referenceGroupId).notAny("referenceValueRules.referenceValueId",[this.data.referenceValue.id]).filters()}),this.testTypeResultOptions=this.mlabService.testTypes.resultOptions.getAll(this.data.referenceValue.testTypeId,{orderBy:["nameEn"]}),this.comparisonOperators=Object.keys(R).map(d=>R[d]);let r=this.fb;this.dialog=e;let t=this.data;this.form=r.group({description:[t.referenceValueRule?.description,[T.maxLength(4096)]],comparisonOperator:new U(t.referenceValueRule?.comparisonOperator??R.Equal,[T.required]),referenceGroupId:[t.referenceValueRule?.referenceGroupId,[T.required]],value:[t.referenceValueRule?.value,[]],start:[t.referenceValueRule?.start,[]],end:[t.referenceValueRule?.end,[]],testTypeResultOptionId:[t.referenceValueRule?.testTypeResultOptionId,[]]});}isRange(){return this.form.value.comparisonOperator===R.RangeWithBoundaries||this.form.value.comparisonOperator===R.RangeWithoutBoundaries;}submit(){this.IsValid()&&(this.data.referenceValueRuleId?this.save(this.mlabService.referenceValues.rules.update(this.data.referenceValue.id,this.data.referenceValueRuleId,this.form.value)):this.save(this.mlabService.referenceValues.rules.create(this.data.referenceValue.id,this.form.value)));}};o.ɵfac=function(r){return new(r||o)();},o.ɵcmp=f({type:o,selectors:[["sz-medisy-laboratory-reference-value-rules-save"]],standalone:!0,features:[S([O]),D,E],decls:9,vars:9,consts:()=>{let e;e="Reference Group";let r;r="Comparison Operator";let t;t="Value";let d;d="Description";let C;C="Start";let I;I="End";let v;return v="Value",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","referenceGroupId","label",e,3,"source"],["formControlName","comparisonOperator","label",r,3,"source","localizedValue"],["formControlName","testTypeResultOptionId","label",t,3,"source"],["formControlName","description","label",d],[3,"actions"],[1,"tw-flex","md:tw-flex-row","tw-flex-col","md:tw-gap-4"],[1,"tw-flex-1"],["autocomplete","off","formControlName","start","matInput","","placeholder",C],["autocomplete","off","formControlName","end","matInput","","placeholder",I],["autocomplete","off","formControlName","value","matInput","","placeholder",v]];},template:function(r,t){r&1&&(l(0,"sz-ui-dialog-header",0),p(1,"mat-dialog-content")(2,"form",1),l(3,"sz-ui-form-field-select",2)(4,"sz-ui-form-field-select",3),A(5,Te,1,1,"sz-ui-form-field-select",4)(6,Ae,2,2),l(7,"sz-ui-form-field-textarea",5),m()(),l(8,"sz-ui-dialog-actions",6)),r&2&&(a("title",t.title)("subtitle",t.subtitle)("alert",t.alert()),u(2),a("formGroup",t.form),u(),a("source",t.referenceGroups),u(),a("source",t.comparisonOperators)("localizedValue",!0),u(),N(t.data.referenceValue.testType.hasResultOptions?5:6),u(3),a("actions",t.actions));},dependencies:[X,B,z,P,F,$,G,K,J,W,H,q,Q,te,pe,ue,_e,ie,re,oe],encapsulation:2});let i=o;return i;})();var Me=(()=>{let o=class o{constructor(){this.dialog=n(g),this.mlabService=n(O),this.route=n(V),this.dataSource=new Se(),this.referenceValue=this.route.snapshot.data.referenceValue,this.appBarConfig={title:Z.rules,subtitle:this.referenceValue.testType.nameEn,backEnabled:!0,backUrl:`/${ne.ReferenceValues}`,menu:ae.default().setItems([s.add(this.openSaveComponent.bind(this)),s.menu([s.search(),s.filter()])])},this.dataSource.columnDefs.push(_.uuid("id"),_.string("referenceGroup.nameEn").setValueClassFontBold().setStacked(_.string("referenceGroup.description").setStyleSmall()),_.enum("comparisonOperator").setValueGetter(e=>ee(e.comparisonOperator)),_.number("_value").setValueGetter(e=>e.testTypeResultOption?e.testTypeResultOption.nameEn:e.value!==null?e.value:`${e.start} - ${e.end}`).setHeaderSortable(!1),_.date("createdAt").setVisible(!1),_.date("updatedAt").setVisible(!1),_.menu([s.edit(this.openSaveComponent.bind(this)),s.divider(),s.clone(e=>{let C=e,{id:r,referenceGroupId:t}=C,d=b(C,["id","referenceGroupId"]);this.openSaveComponent(d);}),s.divider(),s.delete(this.openReferenceValueRuleDeleteComponent.bind(this))]));}ngOnInit(){this.get();}openSaveComponent(e){this.dialog.open(Ce,{data:{referenceValue:this.referenceValue,referenceValueRule:e,referenceValueRuleId:e?.id}}).afterClosed().subscribe(r=>{this.dataSource.addOrUpdateItem(r);});}openReferenceValueRuleDeleteComponent(e){this.dialog.open(de,{data:le.delete(this.mlabService.referenceValues.rules.delete(e.referenceValueId,e.id),e)}).afterClosed().subscribe(r=>{this.dataSource.delete(r);});}get(){this.mlabService.referenceValues.rules.get(this.referenceValue.id,this.dataSource.getQuery()).pipe(Ee(this.dataSource.state)).subscribe(e=>{this.dataSource.set(e.items,e.count);});}};o.ɵfac=function(r){return new(r||o)();},o.ɵcmp=f({type:o,selectors:[["sz-medisy-laboratory-reference-value-rules"]],standalone:!0,features:[S([O]),E],decls:2,vars:3,consts:[[3,"changed","config","dataSource"],["content","",3,"update","dataSource"]],template:function(r,t){r&1&&(p(0,"sz-ui-table-bar",0),h("changed",function(){return t.get();}),m(),p(1,"sz-ui-table",1),h("update",function(){return t.get();}),m()),r&2&&(a("config",t.appBarConfig)("dataSource",t.dataSource),u(),a("dataSource",t.dataSource));},dependencies:[Oe,fe,ce],encapsulation:2});let i=o;return i;})();var Ne=(()=>{let o=class o{constructor(){this.dialog=n(g),this.route=n(V),this.alert$=new y(),this.referenceValue=this.route.snapshot.data.referenceValue,this.appBarConfig={title:this.referenceValue.testType.nameEn,subtitle:this.referenceValue.description,backEnabled:!0};}};o.ɵfac=function(r){return new(r||o)();},o.ɵcmp=f({type:o,selectors:[["sz-medisy-laboratory-reference-value"]],standalone:!0,features:[S([]),E],decls:1,vars:1,consts:[[3,"config"]],template:function(r,t){r&1&&l(0,"sz-ui-app-bar",0),r&2&&a("config",t.appBarConfig);},dependencies:[me],encapsulation:2});let i=o;return i;})();var Mt=[{path:"",component:Ne},{path:"rules",component:Me}];export{Mt as default};/**i18n:418516e83c39d18f4d4383e7e7094a47a2de32f450262c69abd400e2ff999647*/