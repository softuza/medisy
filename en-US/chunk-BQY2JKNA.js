import{o as M}from"./chunk-BKKXZCD4.js";import{$ as j,Ac as D,C as S,Ca as K,D as f,E as w,Fa as Z,K as p,Lc as J,M as L,Nc as Y,Oa as A,S as V,Y as E,da as h,ea as W,f as k,ga as x,ia as C,ja as $,kb as G,l as P,m as y,n as U,oa as _,ra as B,s as l,w as F,x as T,yc as H,z as N}from"./chunk-5UGT7ICT.js";import{a as d,b as R}from"./chunk-KKIINILB.js";var I=class{constructor(){this.stateLocation="@state",this.state=G({})}select(e){return J(()=>this.state()[e])}pmutate(e,s){this.state.update(t=>R(d({},t),{[e]:s}))}mutate(e){this.state.update(s=>d(d({},s),e))}set(e){this.state.set(e)}get(){return this.state}load(){let e=localStorage.getItem(this.stateLocation);if(!e)return null;try{let s=JSON.parse(e);return this.set(s),s}catch{return null}}save(e){localStorage.setItem(this.stateLocation,JSON.stringify(e))}listen(){Y(()=>{this.save(this.state())})}};var ce=(()=>{let e=class e extends I{constructor(){super(),this.stateLocation="@appState",this.init(),this.listen()}init(){this.load()||this.set({header:{title:"Dashboard"},sidebar:{visible:!0},theme:{selector:void 0}})}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=h({token:e,factory:e.\u0275fac});let r=e;return r})();var m="Service workers are disabled or not supported by this browser";function ee(r){return T(()=>U(new Error(r)))}var g=class{constructor(e){if(this.serviceWorker=e,!e)this.worker=this.events=this.registration=ee(m);else{let t=N(e,"controllerchange").pipe(l(()=>e.controller)),n=T(()=>y(e.controller)),i=F(n,t);this.worker=i.pipe(w(u=>!!u)),this.registration=this.worker.pipe(E(()=>e.getRegistration()));let b=N(e,"message").pipe(l(u=>u.data)).pipe(w(u=>u&&u.type)).pipe(V());b.connect(),this.events=b}}postMessage(e,s){return this.worker.pipe(p(1),j(t=>{t.postMessage(d({action:e},s))})).toPromise().then(()=>{})}postMessageWithOperation(e,s,t){let n=this.waitForOperationCompleted(t),i=this.postMessage(e,s);return Promise.all([i,n]).then(([,a])=>a)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(e){let s;return typeof e=="string"?s=t=>t.type===e:s=t=>e.includes(t.type),this.events.pipe(w(s))}nextEventOfType(e){return this.eventsOfType(e).pipe(p(1))}waitForOperationCompleted(e){return this.eventsOfType("OPERATION_COMPLETED").pipe(w(s=>s.nonce===e),p(1),l(s=>{if(s.result!==void 0)return s.result;throw new Error(s.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}},X=(()=>{let e=class e{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,this.pushManager=null,this.subscriptionChanges=new k,!t.isEnabled){this.messages=f,this.notificationClicks=f,this.subscription=f;return}this.messages=this.sw.eventsOfType("PUSH").pipe(l(i=>i.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(l(i=>i.data)),this.pushManager=this.sw.registration.pipe(l(i=>i.pushManager));let n=this.pushManager.pipe(E(i=>i.getSubscription()));this.subscription=S(n,this.subscriptionChanges)}requestSubscription(t){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(m));let n={userVisibleOnly:!0},i=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),a=new Uint8Array(new ArrayBuffer(i.length));for(let o=0;o<i.length;o++)a[o]=i.charCodeAt(o);return n.applicationServerKey=a,this.pushManager.pipe(E(o=>o.subscribe(n)),p(1)).toPromise().then(o=>(this.subscriptionChanges.next(o),o))}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(m));let t=n=>{if(n===null)throw new Error("Not subscribed to push notifications.");return n.unsubscribe().then(i=>{if(!i)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})};return this.subscription.pipe(p(1),E(t)).toPromise()}decodeBase64(t){return atob(t)}};e.\u0275fac=function(n){return new(n||e)(C(g))},e.\u0275prov=h({token:e,factory:e.\u0275fac});let r=e;return r})(),O=(()=>{let e=class e{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,!t.isEnabled){this.versionUpdates=f,this.unrecoverable=f;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(m));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(m));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}};e.\u0275fac=function(n){return new(n||e)(C(g))},e.\u0275prov=h({token:e,factory:e.\u0275fac});let r=e;return r})();var z=new x("");function te(r,e,s,t){return()=>{if(!(M(t)&&"serviceWorker"in navigator&&s.enabled!==!1))return;let n=r.get(Z),i=r.get(D);n.runOutsideAngular(()=>{let o=navigator.serviceWorker,c=()=>o.controller?.postMessage({action:"INITIALIZE"});o.addEventListener("controllerchange",c),i.onDestroy(()=>{o.removeEventListener("controllerchange",c)})});let a;if(typeof s.registrationStrategy=="function")a=s.registrationStrategy();else{let[o,...c]=(s.registrationStrategy||"registerWhenStable:30000").split(":");switch(o){case"registerImmediately":a=y(null);break;case"registerWithDelay":a=Q(+c[0]||0);break;case"registerWhenStable":let b=P(r.get(D).whenStable());a=c[0]?S(b,Q(+c[0])):b;break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${s.registrationStrategy}`)}}n.runOutsideAngular(()=>a.pipe(p(1)).subscribe(()=>navigator.serviceWorker.register(e,{scope:s.scope}).catch(o=>console.error("Service worker registration failed with:",o))))}}function Q(r){return y(null).pipe(L(r))}function re(r,e){return new g(M(e)&&r.enabled!==!1?navigator.serviceWorker:void 0)}var v=class{};function se(r,e={}){return B([X,O,{provide:z,useValue:r},{provide:v,useValue:e},{provide:g,useFactory:re,deps:[v,A]},{provide:H,useFactory:te,deps:[K,z,v,A],multi:!0}])}var ve=(()=>{let e=class e{static register(t,n={}){return{ngModule:e,providers:[se(t,n)]}}};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=_({type:e}),e.\u0275inj=W({providers:[X,O]});let r=e;return r})();var Ne=(()=>{let e=class e{constructor(){this._isNewVersionAvailable=!1,this.swUpdate=$(O),this.swUpdate.isEnabled&&this.swUpdate.versionUpdates.subscribe(t=>{switch(t.type){case"VERSION_DETECTED":console.log(`Downloading new app version: ${t.version.hash}`);break;case"VERSION_READY":console.log(`Current app version: ${t.currentVersion.hash}`),console.log(`New app version ready for use: ${t.latestVersion.hash}`),this._isNewVersionAvailable=!0;break;case"VERSION_INSTALLATION_FAILED":console.log(`Failed to install app version '${t.version.hash}': ${t.error}`);break}})}isNewVersionAvailable(){return this._isNewVersionAvailable}applyUpdate(){this.swUpdate.activateUpdate().then(()=>document.location.reload()).catch(t=>console.error("Failed to apply updates:",t))}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=h({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();export{ce as a,X as b,ve as c,Ne as d};
/**i18n:52dae1015fb4dcd24d02f3b60578855a39e5cc5be32446a479305eae917c802c*/
