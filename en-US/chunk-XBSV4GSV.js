import{b as D}from"./chunk-YGT2VPRJ.js";import{a as ze,b as h}from"./chunk-E3NJQNXU.js";import{a as ve,b as be,c as Be,d as Ge,e as Fe}from"./chunk-OY7MIDLA.js";import{a as xe}from"./chunk-MMVDS2X4.js";import{a as M}from"./chunk-5DPQRN3C.js";import{a as Ae}from"./chunk-KC5MIFNV.js";import{e as Le,f as $e,g as ye,j as De}from"./chunk-UULDKEEF.js";import{g as he}from"./chunk-GSQQU6NP.js";import{a as _e,b as ae,e as Ee,g as se}from"./chunk-T2IQKITO.js";import{c as pe,d as ue,f as Ne,h as I,i as Oe,j as fe,o as Te,s as Pe,t as Re,v as Ie}from"./chunk-HR7DGYGJ.js";import{b as R}from"./chunk-VTM5G3BH.js";import{d as de,h as Se,j as Me}from"./chunk-3CG52MMS.js";import{b as Ce,c as ge,d as ce}from"./chunk-DXGMIMNP.js";import{d,f as U,g as Z,k as u,l as ee,n as oe,q as te,r as ie,u as ne}from"./chunk-SVCJK6WQ.js";import{c as re,e as le}from"./chunk-U4LXFUUA.js";import{la as me}from"./chunk-UJOOHETU.js";import{Eb as $,Jb as l,Kb as n,Lb as m,Mb as K,Nb as Q,Vb as g,Yb as y,a as H,bb as s,cb as C,hc as c,ic as f,na as O,nc as T,ob as W,oc as P,qb as J,s as q,vb as L,zb as S}from"./chunk-RCLXGW2A.js";import{a as N,b as A}from"./chunk-7I3LHTBF.js";var Mo=(()=>{let r=class r extends Le{constructor(e,o,t,a){super(t),this.mpplService=e,this.fb=o,this.dialog=t,this.data=a,this.nationalities=this.mpplService.nationalities.getAll({orderBy:["name"]}),this.languages=this.mpplService.languages.getAll({orderBy:["name"]}),this.sexes=Object.keys(D).map(E=>D[E]),this.subscriptions=new H(),this.titles=this.mpplService.titles.get(A(N({},R.unpaged()),{orderBy:"name"})),this.titleAutoCompleteConfig={valueChangedFn:E=>(typeof E=="string"&&(this.titles=this.mpplService.titles.get(A(N({query:E},R.default()),{orderBy:"name"}))),!1),optionDisplayWithFn:E=>E.name,optionValueFn:E=>E,suffixes:[{icon:he.save,tooltip:ge.save,hideOnLoading:!0,hideOnValid:!0,hideOnEmpty:!0,clickFn:E=>this.mpplService.titles.create({name:E})}]},this.form=o.group({firstName:o.control(a?.firstName,[d.required,d.maxLength(128)]),lastName:o.control(a?.lastName,[d.required,d.maxLength(128)]),fatherName:o.control(a?.fatherFirstName?`${a.fatherFirstName} ${a?.lastName}`:null,[d.maxLength(128)]),motherName:o.control(a?.motherName,[d.maxLength(128)]),birthDate:o.control(a?.birthDate,[]),nationalityId:o.control(null,[]),ssn:o.control(a?.ssn,[d.maxLength(128)]),languageId:o.control(null,[d.required]),sex:o.control(null,[d.required]),title:o.control(null,[xe()]),primaryEmail:[null,[d.email]],secondaryEmail:[null,[d.email]],mobilePhone:new u(null),homePhone:new u(null),workPhone:new u(null),homeAddress:new u(a?.address)}),this.subscibeChanges();}subscibeChanges(){this.subscriptions.add(this.form.get("firstName")?.valueChanges.subscribe(e=>{if(!e||e===""){this.updateSex(null),this.updateLanguageId(null);return;}else this.getGenders(e);}));}getGenders(e){this.mpplService.autosuggestions.getGenders(N({query:e},R.minimal())).pipe(q(o=>o.items)).subscribe(o=>{!o||o.length===0||(this.updateSex(o[0].sex),this.updateLanguageId(o[0].languageId));});}updateSex(e){this.form.controls.sex.setValue(e);}updateLanguageId(e){this.form.controls.languageId.setValue(e);}submit(){if(!this.IsValid())return;let e=this.form.value;this.mpplService.persons.create({languageId:e.languageId,nationalityId:e.nationalityId,sex:e.sex,titleId:e.title?.id,birthDate:e.birthDate,nationalitiyId:e.nationalitiyId,ssn:e.ssn,names:[{firstName:e.firstName,lastName:e.lastName,fatherName:e.fatherName,motherName:e.motherName,languageId:e.languageId}],primaryEmail:e.primaryEmail,secondaryEmail:e.secondaryEmail,mobilePhone:e.mobilePhone,homePhone:e.homePhone,workPhone:e.workPhone,homeAddress:e.homeAddress}).pipe(I(this.indicator),Oe(this.alert)).subscribe(o=>{this.dialog.close(o);});}};r.ɵfac=function(o){return new(o||r)(C(M),C(ie),C(_e),C(ae));},r.ɵcmp=O({type:r,selectors:[["sz-medisy-people-person-create"]],standalone:!0,features:[T([M]),J,P],decls:39,vars:11,consts:()=>{let e;e="Title";let o;o="First name";let t;t="Last name";let a;a="Father name";let E;E="Mother name";let z;z="Nationality";let v;v="SSN";let b;b="Sex";let B;B="Language";let G;G="BirthDate";let F;F="Mobile";let x;x="Home";let X;X="Work";let Y;Y="Primary Email";let w;w="Secondary Email";let j;j="Home Address";let V;V="Phones";let k;return k="Emails",[j,V,k,[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],[1,"sz-form-row"],["formControlName","title","label",e,3,"source","config"],["formControlName","firstName","label",o],["formControlName","lastName","label",t],["formControlName","fatherName","label",a],["formControlName","motherName","label",E],["formControlName","nationalityId","label",z,3,"source"],["formControlName","ssn","label",v],["formControlName","sex","label",b,3,"source","localizedValue"],["formControlName","languageId","label",B,3,"source"],["formControlName","birthDate","label",G],[1,"tw-mb-4"],["multi",""],["formControlName","homeAddress"],["formControlName","mobilePhone","label",F],["formControlName","homePhone","label",x],["formControlName","workPhone","label",X],["formControlName","primaryEmail","label",Y],["formControlName","secondaryEmail","label",w],[3,"actions"]];},template:function(o,t){o&1&&(m(0,"sz-ui-dialog-header",3),l(1,"mat-dialog-content")(2,"form",4)(3,"div",5),m(4,"sz-ui-form-field-autocomplete",6),n(),l(5,"div",5),m(6,"sz-ui-form-field-input",7)(7,"sz-ui-form-field-input",8),n(),l(8,"div",5),m(9,"sz-ui-form-field-input",9)(10,"sz-ui-form-field-input",10),n(),l(11,"div",5),m(12,"sz-ui-form-field-select",11)(13,"sz-ui-form-field-input",12),n(),l(14,"div",5),m(15,"sz-ui-form-field-select",13)(16,"sz-ui-form-field-select",14),n(),m(17,"sz-ui-form-field-date-time",15),l(18,"div",16)(19,"mat-accordion",17)(20,"mat-expansion-panel")(21,"mat-expansion-panel-header")(22,"mat-panel-title"),g(23,0),n()(),m(24,"sz-ui-form-field-address",18),n(),l(25,"mat-expansion-panel")(26,"mat-expansion-panel-header")(27,"mat-panel-title"),g(28,1),n()(),m(29,"sz-ui-form-field-phone-number",19)(30,"sz-ui-form-field-phone-number",20)(31,"sz-ui-form-field-phone-number",21),n(),l(32,"mat-expansion-panel")(33,"mat-expansion-panel-header")(34,"mat-panel-title"),g(35,2),n()(),m(36,"sz-ui-form-field-input",22)(37,"sz-ui-form-field-input",23),n()()()()(),m(38,"sz-ui-dialog-actions",24)),o&2&&(S("title",t.title)("subtitle",t.subtitle)("alert",t.alert()),s(2),S("formGroup",t.form),s(2),S("source",t.titles)("config",t.titleAutoCompleteConfig),s(8),S("source",t.nationalities),s(3),S("source",t.sexes)("localizedValue",!0),s(),S("source",t.languages),s(22),S("actions",t.actions));},dependencies:[ne,ee,U,Z,oe,te,se,Ee,Fe,Ge,ve,be,Be,De,$e,ye,Ie,pe,Pe,Te,ue,Re,fe],encapsulation:2});let _=r;return _;})();function we(_,r){if(_&1&&(l(0,"mat-card-subtitle"),c(1),n()),_&2){let p=y(2);s(),f(p.person.primaryEmail);}}function je(_,r){if(_&1&&(K(0,1),l(1,"mat-card-subtitle"),c(2),n(),l(3,"mat-card-subtitle"),c(4),n(),L(5,we,2,1,"mat-card-subtitle"),Q()),_&2){let p=y();s(2),f(p.getSex()),s(2),f(p.getMobilePhone()),s(),$(p.person.primaryEmail?5:-1);}}var Fo=(()=>{let r=class r{set personId(e){this._personId=e,this.getPerson(e);}get personId(){return this._personId;}constructor(e,o,t){this.mpplService=e,this.personNamePipe=o,this.router=t,this.indicator=W(!1),this.card={icon:"person",clickFn:()=>this.router.navigate([`/mppl/persons/${this._personId}`]),actions:[]};}getPerson(e){this.mpplService.persons.getById(e).pipe(I(this.indicator)).subscribe(o=>{this.person=o,this.card.title=this.personNamePipe.transform(o);});}getSex(){return ce(this.person?.sex);}getMobilePhone(){return this.person.mobilePhone.number?`${this.person.mobilePhone.number}`:null;}};r.ɵfac=function(o){return new(o||r)(C(M),C(h),C(re));},r.ɵcmp=O({type:r,selectors:[["sz-medisy-people-person-card"]],inputs:{personId:"personId"},standalone:!0,features:[T([h,ze,M]),P],decls:2,vars:3,consts:[[3,"card","indicator"],["subtitle",""]],template:function(o,t){o&1&&(l(0,"sz-ui-card",0),L(1,je,6,3,"ng-container",1),n()),o&2&&(S("card",t.card)("indicator",t.indicator),s(),$(t.person?1:-1));},dependencies:[le,Se,de,Ae,Me,Ce,me,Ne],encapsulation:2});let _=r;return _;})();export{Fo as a,Mo as b};/**i18n:ee05a22f3822c113da725777965dd561774d6cc6a2deb7b3b35335df23b29b27*/