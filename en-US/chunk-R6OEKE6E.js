import{c as k}from"./chunk-DEF6I2JA.js";import{a as Ee}from"./chunk-ZC5EKTSA.js";import{a as L}from"./chunk-BMJ3S5XZ.js";import"./chunk-JSCEI2V4.js";import{h as de}from"./chunk-2SZNFHCN.js";import"./chunk-GPAES7OP.js";import"./chunk-DSJR6L5G.js";import"./chunk-XDEHVO3T.js";import{d as _e,e as H}from"./chunk-2BMNYJ3Z.js";import{f as U,g as w,h as q,k as Q}from"./chunk-AKE4IGL4.js";import"./chunk-ODYGSBAJ.js";import{b as ie}from"./chunk-QERRRZIA.js";import{a as G,b as z,d as te,e as $,g as T}from"./chunk-MHLQ5ASK.js";import{c as V,r as ne,u as X}from"./chunk-UPM3BUO4.js";import"./chunk-ZDS23LK5.js";import"./chunk-WX4XW32G.js";import{i as B}from"./chunk-Q4QLTUTU.js";import{d as s,f as R,g as A,l as I,n as D,q as y,r as F,t as P}from"./chunk-R425IBES.js";import{b as x,c as ae}from"./chunk-6YJUGZYY.js";import{a as se}from"./chunk-KPHZXQ4R.js";import{c as re,d as le}from"./chunk-53QS6UIR.js";import"./chunk-TM26YT7E.js";import{a as oe}from"./chunk-KDY7YLUU.js";import"./chunk-FZND2MZR.js";import{p as ee}from"./chunk-CVZW7JYW.js";import"./chunk-GBJNACNX.js";import"./chunk-IJWI4VMJ.js";import{Ia as v,La as b}from"./chunk-OKKKBEFN.js";import{Fb as j,Hb as J,Ib as K,Jb as S,Kb as c,Lb as E,Yb as Z,ac as C,bb as a,bc as O,cc as N,ja as d,mb as h,mc as f,na as p,nc as u,yb as r,zb as W}from"./chunk-K7VHIDZW.js";import"./chunk-VARUJZUG.js";var Me=["root"],me=(()=>{let n=class n{constructor(){this.element=null;}ngAfterViewInit(){this.render();}render(){console.log("render",this.field),this.field.type==="text"?this.addFieldText(this.field):this.field.type==="barcode"?this.addFieldBarcode(this.field):this.field.type==="table"?this.addFieldTable(this.field):this.field.type==="line"?this.addFieldLine(this.field):this.field.type==="image"&&this.addFieldImage(this.field);}getContainerElement(){return this.container.nativeElement;}addFieldText(i){let e=i;if(!e)return;let t=this.getContainerElement(),o=document.createElement("p");o.innerText=e.text,o.style.position="absolute",o.style.left=`${this.getRelativeSize(e.x)}px`,o.style.top=`${this.getRelativeSize(e.y)}px`,t.appendChild(o),this.addMouseEvents(o);}addFieldBarcode(i){let e=i;if(!e)return;let t=this.getContainerElement(),o=null;if(e.barcodeType==="qr"&&(o=H.qr(e.value)),e.barcodeType==="datamatrix"&&(o=H.datamatrix(e.value,!1)),!o)return;let _=_e.toSVG(o,e.options);_&&t.appendChild(_);}addFieldTable(i){if(!i)return;let t=this.getContainerElement();}addFieldLine(i){let e=i;if(!e)return;let t=this.getContainerElement(),o=document.createElement("div");o.style.position="absolute",o.style.left=`${this.getRelativeSize(e.x)}px`,o.style.top=`${this.getRelativeSize(e.y)}px`,o.style.width=`${this.getRelativeSize(e.x2-e.x)}px`,o.style.height=`${this.getRelativeSize(e.y2-e.y)}px`,o.style.borderBottom=`${e.lineWidth??1}px solid ${e.lineColor??"black"}`,t.appendChild(o),this.addMouseEvents(o);}addFieldImage(i){let e=i;if(!e)return;let t=this.getContainerElement(),o=document.createElement("img");o.src=e.url,o.alt="",o.style.position="absolute",o.style.left=`${this.getRelativeSize(e.x)}px`,o.style.top=`${this.getRelativeSize(e.y)}px`,o.style.width=`${this.getRelativeSize(e.width)}px`,o.style.height=`${this.getRelativeSize(e.height)}px`,t.appendChild(o),this.addMouseEvents(o);}addMouseEvents(i){i.addEventListener("mousedown",_=>{_.button===0&&(i.style.cursor="move",document.addEventListener("mousemove",t),document.addEventListener("mouseup",o));}),i.addEventListener("mouseup",_=>{_.preventDefault();});let e=this.getContainerElement(),t=_=>{let m=_.clientX-e.getBoundingClientRect().left-i.offsetWidth/2,g=_.clientY-e.getBoundingClientRect().top-i.offsetHeight/2;i.style.left=`${m}px`,i.style.top=`${g}px`,this.field.x=m/this.scale,this.field.y=g/this.scale;},o=()=>{i.style.cursor="auto",document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",o);};}onRightClick(i){i.preventDefault(),this.matMenuTrigger.openMenu();}getRelativeSize(i){return i*this.scale;}};n.ɵfac=function(e){return new(e||n)();},n.ɵcmp=p({type:n,selectors:[["sz-mgmt-reporting-template-field"]],viewQuery:function(e,t){if(e&1&&(C(Me,5),C(re,7)),e&2){let o;O(o=N())&&(t.container=o.first),O(o=N())&&(t.matMenuTrigger=o.first);}},inputs:{field:"field",scale:"scale"},standalone:!0,features:[f([L]),u],decls:2,vars:0,consts:[["root",""]],template:function(e,t){e&1&&E(0,"div",null,0);},dependencies:[T,b,le,v],encapsulation:2});let l=n;return l;})();var pe=(()=>{let n=class n extends U{constructor(){let i=d(G);super(i),this.fb=d(F),this.data=d(z),this.barcodeTypes=["qr","datamatrix"];let e=this.fb;this.dialog=i;let t=this.data;this.form=e.group({name:[t?.name??"_barcode1",[s.required]],type:["barcode",[s.required]],x:[t?.x??0,[s.required]],y:[t?.y??0,[s.required]],value:[t?.value??"",[s.required]],barcodeType:[t?.barcodeType??"qr",[s.required]],width:[t?.width??16,[s.required]],height:[t?.height??16,[s.required]]});}submit(){this.IsValid()&&this.dialog.close(this.form.value);}};n.ɵfac=function(e){return new(e||n)();},n.ɵcmp=p({type:n,selectors:[["sz-mgmt-reporting-template-barcode-field"]],standalone:!0,features:[f([]),h,u],decls:11,vars:10,consts:()=>{let i;i="Name";let e;e="X";let t;t="Y";let o;o="value";let _;_="Type";let m;m="Width";let g;return g="Height",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","name","label",i],["formControlName","x","label",e,3,"type"],["formControlName","y","label",t,3,"type"],["formControlName","value","label",o],["formControlName","barcodeType","label",_,3,"source"],["formControlName","width","label",m,3,"type"],["formControlName","height","label",g,3,"type"],[3,"actions"]];},template:function(e,t){e&1&&(E(0,"sz-ui-dialog-header",0),S(1,"mat-dialog-content")(2,"form",1),E(3,"sz-ui-form-field-input",2)(4,"sz-ui-form-field-input",3)(5,"sz-ui-form-field-input",4)(6,"sz-ui-form-field-input",5)(7,"sz-ui-form-field-select",6)(8,"sz-ui-form-field-input",7)(9,"sz-ui-form-field-input",8),c()(),E(10,"sz-ui-dialog-actions",9)),e&2&&(r("title",t.title)("subtitle",t.subtitle)("alert",t.alert()),a(2),r("formGroup",t.form),a(2),r("type","number"),a(),r("type","number"),a(2),r("source",t.barcodeTypes),a(),r("type","number"),a(),r("type","number"),a(),r("actions",t.actions));},dependencies:[P,I,R,A,D,y,T,$,B,k,Q,w,q,X,V,ne],encapsulation:2});let l=n;return l;})();var fe=(()=>{let n=class n extends U{constructor(){let i=d(G);super(i),this.fb=d(F),this.data=d(z);let e=this.fb;this.dialog=i;let t=this.data;this.form=e.group({name:[t?.name??"_text1",[s.required]],type:["text",[s.required]],x:[t?.x??0,[s.required]],y:[t?.y??0,[s.required]],text:[t?.text??"",[s.required]],fontSize:[t?.fontSize??12,[s.required]]});}submit(){this.IsValid()&&this.dialog.close(this.form.value);}};n.ɵfac=function(e){return new(e||n)();},n.ɵcmp=p({type:n,selectors:[["sz-mgmt-reporting-template-text-field"]],standalone:!0,features:[f([]),h,u],decls:9,vars:8,consts:()=>{let i;i="Name";let e;e="X";let t;t="Y";let o;o="Text";let _;return _="Font Size",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","name","label",i],["formControlName","x","label",e,3,"type"],["formControlName","y","label",t,3,"type"],["formControlName","text","label",o],["formControlName","fontSize","label",_,3,"type"],[3,"actions"]];},template:function(e,t){e&1&&(E(0,"sz-ui-dialog-header",0),S(1,"mat-dialog-content")(2,"form",1),E(3,"sz-ui-form-field-input",2)(4,"sz-ui-form-field-input",3)(5,"sz-ui-form-field-input",4)(6,"sz-ui-form-field-input",5)(7,"sz-ui-form-field-input",6),c()(),E(8,"sz-ui-dialog-actions",7)),e&2&&(r("title",t.title)("subtitle",t.subtitle)("alert",t.alert()),a(2),r("formGroup",t.form),a(2),r("type","number"),a(),r("type","number"),a(2),r("type","number"),a(),r("actions",t.actions));},dependencies:[P,I,R,A,D,y,T,$,B,k,Q,w,q,X,V],encapsulation:2});let l=n;return l;})();var Ne=["designer"];function Le(l,n){if(l&1&&E(0,"sz-mgmt-reporting-template-field",4),l&2){let Te=n.$implicit,i=Z();r("field",Te)("scale",i.scale);}}var ue=(()=>{let n=class n{constructor(){this.route=d(ee),this.dialog=d(te),this.srptService=d(L),this.snackBar=d(ie),this.template=this.route.snapshot.data.template,this.fields=[],this.size={width:210,height:297},this.scale=3,this.appBarConfig={title:this.template.name,subtitle:this.template.description,menu:ae.default().setItems([x.menu([x.text(this.openSaveTextFieldComponent.bind(this)),x.barcode(this.openSaveBarcodeFieldComponent.bind(this))])])};}ngAfterViewInit(){this.refresh(this.template.content);}refresh(i){try{let e=Ee.fromString(i);this.fields=e.fields??[];}catch(e){this.snackBar.open(e,oe.close,{duration:5e3});}}getRelativeSize(i){return i*this.scale;}openSaveTextFieldComponent(){this.dialog.open(fe).afterClosed().subscribe(i=>{i&&this.fields.push(i);});}openSaveBarcodeFieldComponent(){this.dialog.open(pe).afterClosed().subscribe(i=>{i&&this.fields.push(i);});}};n.ɵfac=function(e){return new(e||n)();},n.ɵcmp=p({type:n,selectors:[["sz-mgmt-reporting-template"]],viewQuery:function(e,t){if(e&1&&C(Ne,5),e&2){let o;O(o=N())&&(t.designerEl=o.first);}},standalone:!0,features:[f([L]),u],decls:6,vars:5,consts:[["designer",""],[3,"config"],[1,"container"],[1,"designer"],[3,"field","scale"]],template:function(e,t){e&1&&(E(0,"sz-ui-app-bar",1),S(1,"div",2)(2,"div",3,0),J(4,Le,1,2,"sz-mgmt-reporting-template-field",4,j),c()()),e&2&&(r("config",t.appBarConfig),a(2),W("width",t.getRelativeSize(t.size.width),"px")("height",t.getRelativeSize(t.size.height),"px"),a(2),K(t.fields));},dependencies:[T,b,de,se,v,me],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}.designer[_ngcontent-%COMP%]{border:1px solid #c3c3c3;padding:10px;margin:10px;background-color:#f5f5f5;position:relative}"]});let l=n;return l;})();var Mt=[{path:"",component:ue}];export{Mt as default};/**i18n:7274145596894140ce8dc809ecf6b222e8bea6098fe1553d5bf6245265c46bf4*/