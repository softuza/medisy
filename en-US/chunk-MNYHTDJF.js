import{a as k}from"./chunk-FFXGPFSH.js";import{a as m,e as q,g as H,h as X,k as j}from"./chunk-CDMYP44J.js";import{a as _}from"./chunk-B4DDDG73.js";import{a as Y,b as z,e as v,g as P}from"./chunk-LOTTIY7N.js";import{j as V,r as $,u as G}from"./chunk-NNOLVS2I.js";import{c as p}from"./chunk-KWAXWWG5.js";import{d,f as D,g as L,l as O,o as C,r as M,s as F,u as N}from"./chunk-4EXFFJRQ.js";import{a as B}from"./chunk-SUVHFOJF.js";import{x as R}from"./chunk-JF4TEE2V.js";import{Eb as b,Jb as A,Kb as g,Lb as l,Yb as E,bb as n,ja as s,mb as c,mc as h,na as y,nc as I,rb as S,yb as a}from"./chunk-5F2BPM7Q.js";import{a as f,b as u}from"./chunk-R7GD43FN.js";function w(i,o){if(i&1&&l(0,"sz-ui-form-field-select",3),i&2){let T=E();a("source",T.laboratories)("config",T.transferOutLaboratorySelectConfig);}}var mt=(()=>{let o=class o extends q{constructor(){let r=s(Y);super(r),this.fb=s(F),this.mlabService=s(_),this.data=s(z),this.title=B.add_test_type,this.actions=[m.close(()=>this.dialogRef.close()),m.reset(()=>this.form.reset()),m.add(this.submit.bind(this),this.indicator)],this.laboratories=null,this.laboratoryOptionValueFn=t=>t,this.testTypesFilters=[],this.laboratoryId=this.data.laboratoryId,this.transferOutLaboratorySelectConfig={emptyOption:!0},this.testTypes=this.mlabService.laboratories.testTypes.get(this.laboratoryId,u(f({query:""},p.minimal()),{orderBy:["-isFavorite","testType.nameEn"]})),this.testTypeAutocompleteConfig={valueChangedFn:t=>{if(typeof t=="string")this.testTypes=this.mlabService.laboratories.testTypes.get(this.laboratoryId,u(f({query:t},p.minimal()),{orderBy:["-isFavorite","testType.nameEn"]}));else if(typeof t=="object"&&t)return!1;return!0;},optionSelectedFn:t=>{this.form.patchValue({transferOutLaboratoryId:null}),t.transferOutLaboratoryId?this.form.controls.transferOutLaboratoryId.addValidators(d.required):this.form.controls.transferOutLaboratoryId.removeValidators(d.required),t.transferOutEnabled&&(this.laboratories=this.mlabService.laboratories.getAll({orderBy:["name"],filters:R.create().notEqual("id",this.data).equalIf("id",t.transferOutLaboratoryId).any("testTypes.testTypeId",t.testTypeId).any("testTypes.enabled",!0).any("testTypes.transferInEnabled",!0).filters()}));},optionValueFn:t=>t,optionContentFn:t=>t.testType.nameEn,optionDisplayWithFn:t=>t.testType.nameEn};let e=this.fb;this.dialog=r,this.form=e.group({transferOutLaboratoryId:[null,[]],testType:e.control(null,[d.required,k.object()])});}isTranferOutEnabled(){return this.form.value?.testType?.transferOutEnabled;}submit(){this.IsValid()&&(this.data.callback&&this.data.callback({laboratoryTestType:this.form.value.testType,transferOutLaboratoryId:this.form.getRawValue().transferOutLaboratoryId}),this.form.reset());}};o.ɵfac=function(e){return new(e||o)();},o.ɵcmp=y({type:o,selectors:[["sz-medisy-laboratory-analysis-test-type-add"]],standalone:!0,features:[h([_]),c,I],decls:6,vars:8,consts:()=>{let r;r="Test Type";let e;return e="Transfer Out Laboratory",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],["formControlName","testType","label",r,3,"source","config"],["formControlName","transferOutLaboratoryId","label",e,3,"source","config"],[3,"actions"]];},template:function(e,t){e&1&&(l(0,"sz-ui-dialog-header",0),A(1,"mat-dialog-content")(2,"form",1),l(3,"sz-ui-form-field-autocomplete",2),S(4,w,1,2,"sz-ui-form-field-select",3),g()(),l(5,"sz-ui-dialog-actions",4)),e&2&&(a("title",t.title)("subtitle",t.subtitle)("alert",t.alert()),n(2),a("formGroup",t.form),n(),a("source",t.testTypes)("config",t.testTypeAutocompleteConfig),n(),b(t.isTranferOutEnabled()?4:-1),n(),a("actions",t.actions));},dependencies:[N,O,D,L,C,M,P,v,j,H,X,G,$,V],encapsulation:2});let i=o;return i;})();export{mt as a};/**i18n:ff9fdde7a6df01557f81548cdf90a4fe127bad3db9779e7a3c30af7012e3a744*/