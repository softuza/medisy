import{a as C}from"./chunk-YT6CASAK.js";import{a as I}from"./chunk-YNUTG2SB.js";import{a as pe,b as ce,c as _,f as fe,g as Ce}from"./chunk-CT2TOIKT.js";import"./chunk-2KPNCTCB.js";import"./chunk-CBEFIIFK.js";import"./chunk-TSP7XVKM.js";import{b as _e,f as Se,g as ue,h as Ee,j as de,k as me}from"./chunk-MBCX2IM6.js";import{a as p}from"./chunk-74BP7MNC.js";import"./chunk-RSYANUDV.js";import{a as q,b as k,d as j,e as H,g as J}from"./chunk-FRBT2WCB.js";import{a as Z,b as ee,h as te,q as ne,r as re,s as ae,u as se}from"./chunk-ZV5KP5GW.js";import"./chunk-HLTWUKSH.js";import"./chunk-276RQCOC.js";import{h as K,i as W}from"./chunk-KPL52NX4.js";import{b as z,d as f,f as F,g as $,k as B,l as U,m as P,o as G,r as Y,s as X,u as w}from"./chunk-RHVVSSMP.js";import{b as m,c as le}from"./chunk-AY7TP3Q7.js";import"./chunk-RCHOHS2G.js";import"./chunk-W75G3ZKH.js";import"./chunk-5MQKWJS4.js";import{a as oe,b as ie}from"./chunk-K75XG5BR.js";import"./chunk-FJ4IFQWV.js";import{r as x,v as Q,x as h}from"./chunk-4I74CWZL.js";import"./chunk-LLSKOB3G.js";import"./chunk-OWRQBV6B.js";import"./chunk-3AQJ5CSK.js";import{Eb as N,Jb as u,Kb as s,Lb as l,Wb as g,Yb as L,bb as a,ja as S,mb as D,mc as M,na as O,nc as R,rb as A,yb as r}from"./chunk-YAUSGWXJ.js";import"./chunk-QXHRBTK3.js";function Te(i,n){if(i&1&&l(0,"sz-ui-form-field-select",7),i&2){let T=L();r("source",T.testTypeResultOptions);}}function Ae(i,n){i&1&&(u(0,"div",10)(1,"mat-form-field",11)(2,"label"),l(3,"input",12),s()(),u(4,"mat-form-field",11)(5,"label"),l(6,"input",13),s()()());}function Ne(i,n){i&1&&(u(0,"mat-form-field",11)(1,"label"),l(2,"input",14),s()());}function ge(i,n){if(i&1&&A(0,Ae,7,0,"div",10)(1,Ne,3,0,"mat-form-field",11),i&2){let T=L();N(T.isRange()?0:1);}}var Oe=(()=>{let n=class n extends Se{constructor(){let e=S(q);super(e),this.mlabService=S(p),this.fb=S(X),this.data=S(k),this.units=[],this.testTypes=this.mlabService.testTypes.getAll({orderBy:["nameEn"]}),this.unitSelectConfig={autoSelect:!0},this.referenceGroups=[],this.testTypeResultOptions=[],this.comparisonOperators=Object.keys(C).map(d=>C[d]),this.testTypeSelectConfig={optionSelectedFn:(d,c)=>{c&&this.testTypeSelected(c);}},this.isQuantitative=!1;let o=this.fb;this.dialog=e;let t=this.data;this.form=o.group({description:[t?.description,[f.maxLength(4096)]],testTypeId:[t?.testTypeId,[f.required]],unitId:[t?.unitId,[]],comparisonOperator:new B(t?.comparisonOperator??C.Range,[f.required]),referenceGroupId:[t?.referenceGroupId,[f.required]],value:[t?.value,[]],start:o.control(t?.start,[]),end:o.control(t?.end,[]),testTypeResultOptionId:[t?.testTypeResultOptionId,[]]});}testTypeSelected(e){e.unitId&&e.unit?this.getUnits(e.unit):this.units=[],this.mlabService.referenceGroups.getAllItems({orderBy:["nameEn"],filterBehavior:Q.Or,filters:h.create().equalIf("id",this.data?.referenceGroupId).notAnyIf("referenceValues.referenceValueId",this.data?[this.data.id]:null).filters()}).subscribe(o=>{this.referenceGroups=o;}),this.testTypeResultOptions=[],e.testResultType===I.Qualitative&&this.mlabService.testTypes.resultOptions.getAllItems(e.id,{orderBy:["nameEn"]}).pipe(te(this.indicator)).subscribe(o=>{o&&(this.testTypeResultOptions=o);}),this.isQuantitative=e.testResultType===I.Quantitative;}getUnits(e){this.units=[e],this.form.patchValue({unitId:e?.id}),this.mlabService.unitConverters.getAllItems({filters:h.create().equal("toUnitId",e.id).filters()}).subscribe(o=>{this.units.push(...o.map(t=>t.fromUnit));});}isRange(){return this.form.value.comparisonOperator===C.Range;}submit(){this.IsValid()&&(this.data?this.save(this.mlabService.referenceValues.update(this.data.id,this.form.value)):this.save(this.mlabService.referenceValues.create(this.form.value)));}};n.ɵfac=function(o){return new(o||n)();},n.ɵcmp=O({type:n,selectors:[["sz-medisy-laboratory-reference-values-save"]],standalone:!0,features:[M([p]),D,R],decls:13,vars:13,consts:()=>{let e;e="Test Type";let o;o="Unit";let t;t="Reference Group";let d;d="Comparison Operator";let c;c="Value";let V;V="Description";let v;v="Start";let y;y="End";let b;return b="Value",[[3,"title","subtitle","alert"],[1,"sz-form",3,"formGroup"],[1,"sz-form-row"],["formControlName","testTypeId","label",e,3,"source","config"],["formControlName","unitId","label",o,3,"source","config"],["formControlName","referenceGroupId","label",t,3,"source"],["formControlName","comparisonOperator","label",d,3,"source","localizedValue"],["formControlName","testTypeResultOptionId","label",c,3,"source"],["formControlName","description","label",V],[3,"actions"],[1,"tw-flex","md:tw-flex-row","tw-flex-col","md:tw-gap-4"],[1,"tw-flex-1"],["autocomplete","off","formControlName","start","matInput","","placeholder",v,"type","number"],["autocomplete","off","formControlName","end","matInput","","placeholder",y,"type","number"],["autocomplete","off","formControlName","value","matInput","","placeholder",b]];},template:function(o,t){o&1&&(l(0,"sz-ui-dialog-header",0),u(1,"mat-dialog-content")(2,"form",1)(3,"div",2),l(4,"sz-ui-form-field-select",3)(5,"sz-ui-form-field-select",4),s(),u(6,"div",2),l(7,"sz-ui-form-field-select",5)(8,"sz-ui-form-field-select",6),s(),A(9,Te,1,1,"sz-ui-form-field-select",7)(10,ge,2,1),l(11,"sz-ui-form-field-textarea",8),s()(),l(12,"sz-ui-dialog-actions",9)),o&2&&(r("title",t.title)("subtitle",t.subtitle)("alert",t.alert()),a(2),r("formGroup",t.form),a(2),r("source",t.testTypes)("config",t.testTypeSelectConfig),a(),r("source",t.units)("config",t.unitSelectConfig),a(2),r("source",t.referenceGroups),a(),r("source",t.comparisonOperators)("localizedValue",!0),a(),N(t.isQuantitative?10:9),a(3),r("actions",t.actions));},dependencies:[w,U,z,P,F,$,G,Y,J,H,W,K,ne,me,ue,Ee,ee,Z,se,ae,re],encapsulation:2});let i=n;return i;})();var Me=(()=>{let n=class n{constructor(){this.dialog=S(j),this.mlabService=S(p),this.router=S(x),this.dataSource=new fe(),this.appBarConfig={title:oe.reference_values,menu:le.default().setItems([m.add(this.openSaveComponent.bind(this)),m.menu([m.search()])])},this.dataSource.columnDefs.push(_.uuid("id"),_.hyperlink("testType.nameEn").setStacked(_.string("description").setValueClassFontSmall()),_.string("unit").setValueGetter(e=>e.unit?.symbol),_.enum("comparisonOperator").setValueGetter(e=>ie(e.comparisonOperator)),_.number("_value").setValueGetter(e=>e.testTypeResultOption?e.testTypeResultOption.nameEn:e.value!==null?e.value:`${e.start} - ${e.end}`).setHeaderSortable(!1),_.date("createdAt").setVisible(!1),_.date("updatedAt").setVisible(!1),_.menu([m.edit(this.openSaveComponent.bind(this)),m.divider(),m.delete(this.openReferenceValueDeleteComponent.bind(this))])),this.get();}openSaveComponent(e){this.dialog.open(Oe,{data:e}).afterClosed().subscribe(o=>{this.dataSource.addOrUpdateItem(o);});}openReferenceValueDeleteComponent(e){this.dialog.open(de,{data:_e.delete(this.mlabService.referenceValues.delete(e.id),e)}).afterClosed().subscribe(o=>{this.dataSource.delete(o);});}get(){this.mlabService.referenceValues.get(this.dataSource.getQuery()).pipe(Ce(this.dataSource.state)).subscribe(e=>{this.dataSource.set(e.items,e.count);});}};n.ɵfac=function(o){return new(o||n)();},n.ɵcmp=O({type:n,selectors:[["sz-medisy-laboratory-reference-values"]],standalone:!0,features:[M([p]),R],decls:2,vars:3,consts:[[3,"changed","config","dataSource"],[3,"update","dataSource"]],template:function(o,t){o&1&&(u(0,"sz-ui-table-bar",0),g("changed",function(){return t.get();}),s(),u(1,"sz-ui-table",1),g("update",function(){return t.get();}),s()),o&2&&(r("config",t.appBarConfig)("dataSource",t.dataSource),a(),r("dataSource",t.dataSource));},dependencies:[pe,ce],encapsulation:2});let i=n;return i;})();var at=[{path:"",component:Me}];export{at as default};/**i18n:359c45a37699f2cf41ff2ce7681094fb8642750bd9400ade44324692d4b7d733*/